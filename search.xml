<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>暑期的归家惊喜</title>
      <link href="/2024/08/26/surprise-go-home/"/>
      <url>/2024/08/26/surprise-go-home/</url>
      
        <content type="html"><![CDATA[<p>　　一时的心血来潮，萌生了回家一趟的想法。四个月没回家了，还挺想回家看看的。<br>　　火车硬卧十几个小时，虽然包括了一个可以闭着眼睛度过的夜晚，但却比我想象中难熬，因为我在喧闹的环境下根本睡不踏实。车厢连接处不间断的叮叮当当，到站下车的旅客拖着行李从昏暗的走廊穿行，窗外时不时传来狂风暴雨般的巨响，但神奇的是火车停站时周遭又会突然变得很安静。走廊熄灯后还好些，否则还要忍受不知从何处传来的二手烟🚬，烟味混杂在空气里，强行混入我的呼吸。耳边偶尔传来列车员播报的“列车内禁止吸烟”，属实有些讽刺。<br>　　半夜一点多醒来以后我便不困了，躺在床上有点热也有点渴，索性坐起来。意识清醒一些以后，我才发现外面根本没有狂风暴雨，聒噪的呼呼声来自头顶的中央空调。我无事可干，打开电脑填了会社会实践的表，又找插座给手机充了会电。凌晨三点困意袭来，再去睡会儿。<br>　　说起来这车厢的温度，也是起伏不定，入睡前冷，半夜又热，清晨又开始冷，冷得我恨不得没有一寸皮肤露在外面。早上六点多车厢内陆陆续续有人开始活动了，察觉到旁边有人想拉开窗帘，我就起床了。说是起床，也只是坐起身来，从昨天上车到现在还没有洗漱，有些难受。回家以后一定要马上洗个澡！<br>　　这是我第一次瞒着家人悄悄回家，直到坐上绿皮火车后，我都无法想象他们发现我突然回家时会是什么样的场景。之前总是顾及这顾及那，不是路途遥远，就是工作繁忙，这次终于勇敢了一次，我想向那个总是畏畏缩缩的自己证明，杭州到聊城的距离并没有那么远。<br>　　随着火车逐渐靠近聊城，我脑海中与家人在一起的回忆愈发鲜活，想象中相见时的画面愈发清晰。我望向窗外的大片玉米地，不禁弯了嘴角。师弟说的对，人只会为自己没能去做的事情后悔。回家，我永远不会后悔。<br>　　我原本计划下火车后坐公交回家，但把一个秘密瞒了那么久，我愈发渴望和别人倾诉，我思来想去，觉得我弟弟是个不错的人选。<br>　　我问他，你认不认识聊城火车站。<br>　　他发我一张百度地图的导航截图，说认识。<br>　　我说，我十点二十到火车站，你给电车充上电，到时候来接我，不要告诉其他人。<br>　　他说好，出发前还问我穿的厚不，聊城的天气有点冷。<br>　　我出站后在路边等他时，看着路边来往的出租车和公交车，我一点也不心动，因为我在等我的家人。我弟弟果然如我妈所说，大夏天练体育晒得全身黝黑，不过依旧很帅气。<br>　　从火车站骑电动车到我家需要四十多分钟的车程，我们边走边聊，十一点半电车电量告急时我们正好到家门口。我试了几次指纹解锁都失败了，索性用人脸识别。“用户08欢迎回家”，虽然这个编号不常出现，但我猜爷爷奶奶肯定还意识不到是我回来了。<br>　　我打开门，奶奶正拿着手机准备给我爸爸打电话，询问我弟弟去哪里了，怎么还不回家吃饭。看到是我回来了，奶奶的表情又是震惊又是开心，说做梦也想不到是我回家了。奶奶说她上午打了几个喷嚏，心想是谁想她了，没想到中午我就回家了。我说，当然是我想你啦。<br>　　爷爷从厨房闻声出来，刚把炒好的丝瓜端出来，就招呼奶奶再去给我煮一碗面条。我连忙说不用那么麻烦，可爷爷奶奶坚持“起脚扁食落脚面”。<br>　　奶奶煮面条时还问我，怎么昨天下午不在电话里说。<br>　　我说，这不是给你个惊喜嘛。<br>　　奶奶回想了一下我们昨天的通话，说怪不得你问家里有什么菜，还跟我说想吃我包的韭菜包子。<br>　　我本来想等爸爸妈妈下班回家以后给他们一个惊喜，没想到我家监控检测到有人经过就会“滴”一声，然后给手机发通知，而我妈白天又习惯性看家里的监控，自然发现了一些猫腻。<br>　　我妈给我弟弟打电话，你带回家的那个女孩是谁？<br>　　我弟，你自己看监控没看到是谁吗？<br>　　我妈，我在监控里看不清。<br>　　我弟，你妮儿。<br>　　就这样，我妈受到了我回家的消息的第一次冲击，我弟弟说是我，她从监控里看着沙发上的书包也像是我的，但她还是不敢相信。在午饭后我奶奶带着我和我弟弟去菜园里割韭菜时，我妈又向我爷爷打电话确认了一遍，我妈才相信我回家了。她给我打了几个视频，我没接到，我随手拍了一张我们在菜地的照片发了过去。晚上我才知道，我爸也受到了我妈妈的电话轰炸，一看手机，四个未接电话。<br>　　下午洗完澡一觉睡到五点，家里的床真舒服。<br>　　虽然没有当面看见爸爸妈妈的表情，但我想应该是很开心的吧。爸爸妈妈还小小担心了一下是不是我像大学那样在学校受欺负了，但晚上回家看到我好好的就打消了这个疑虑。爸爸妈妈提前知道我回家的好处就是，晚上下班后会给我买很多好吃的！妈妈买了猪蹄和焖子，爸爸买了烤鸭，爷爷奶奶烙了韭菜盒子，又是“简简单单”的一餐。<br>　　晚上和妈妈一起去姥娘家玩，在路上的时候妈妈提前打了个电话，问我姥娘睡觉了没有，她快走到楼下了。<br>　　我问妈妈，你怎么不跟我姥娘说我也来。<br>　　妈妈说，给你姥娘一个惊喜。<br>　　我心想，我妈学的还挺快。<br>　　第二天妈妈请了一天假在家陪我，上午带我去换断掉的手链，添了些钱买了个新的（此处感谢爸爸的红包助力！）。<br>　　中午回到家发现大娘、嫂子还有小朋友们都在爷爷奶奶家，在一起包韭菜包子，嘿嘿˙ᗜ˙，我小侄子知道我是他姑姑了！<br>　　下午我和弟弟去看了电影，沈腾不演喜剧确实有点看不习惯。<br>　　晚上一大家人去饭店聚餐，之前爷爷奶奶过生日总是去饭店吃好吃的，我总是在学校都赶不上，这次我爸也带我奢侈了一次，开心开心！吃饭的时候不禁感叹，山东人的酒桌文化是耳濡目染的，倒酒、敬酒碰杯，要从娃娃抓起。<br>　　没想到流水账式的记录竟然写了两千多字，在家一天半时间虽短却非常充实。不同于在学校，两眼一睁就是赶校车，在实验室每天就是训鼠、收集数据和分析数据，有时觉得自己跟人机一样，快进化为没有感情的工作机器了。<br>　　偶尔回家放松放松，和家人在一起，总是幸福的🥰。　　　　　　　　</p>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Matlab调用Pytorch模型</title>
      <link href="/2024/07/24/matlab-run-pytorch-model/"/>
      <url>/2024/07/24/matlab-run-pytorch-model/</url>
      
        <content type="html"><![CDATA[<h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><ol><li>查看matlab与python的版本对应关系 <a href="https://ww2.mathworks.cn/support/requirements/python-compatibility.html">Versions of Python Compatible with MATLAB Products by Release</a><br>我用的是matlab_r2021a，支持python3.8。</li><li>找到python解释器的位置<br>我之前把pytorch装在了虚拟环境dl中，所以要找到这个虚拟环境下python解释器的位置。<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda activate dl</span><br><span class="line">where python</span><br><span class="line">/Users/wenxin/opt/anaconda3/envs/dl/bin/python</span><br></pre></td></tr></table></figure></li><li>将matlab中的python版本设置为指定路径的python解释器<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; pyenv(<span class="string">&#x27;Version&#x27;</span>, <span class="string">&#x27;/Users/wenxin/opt/anaconda3/envs/dl/bin/python&#x27;</span>)</span><br><span class="line">&gt;&gt; pyversion</span><br><span class="line"></span><br><span class="line">       version: <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line">    executable: <span class="string">&#x27;/Users/wenxin/opt/anaconda3/envs/dl/bin/python&#x27;</span></span><br><span class="line">       library: <span class="string">&#x27;/Users/wenxin/opt/anaconda3/envs/dl/lib/libpython3.8.dylib&#x27;</span></span><br><span class="line">          home: <span class="string">&#x27;/Users/wenxin/opt/anaconda3/envs/dl&#x27;</span></span><br><span class="line">      isloaded: <span class="number">0</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="Python端"><a href="#Python端" class="headerlink" title="Python端"></a>Python端</h1><h2 id="simple-model-py"><a href="#simple-model-py" class="headerlink" title="simple_model.py"></a>simple_model.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 神经网络模型</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleModel</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(SimpleModel, self).__init__()</span><br><span class="line">        self.linear = nn.Linear(<span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> self.linear(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将状态字典保存为.pth文件（只保存模型的权重和偏置，而不保存模型结构）</span></span><br><span class="line"><span class="comment"># model = SimpleModel()</span></span><br><span class="line"><span class="comment"># torch.save(model.state_dict(), &#x27;Code/simple_model.pth&#x27;)</span></span><br></pre></td></tr></table></figure><h2 id="inference-py"><a href="#inference-py" class="headerlink" title="inference.py"></a>inference.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 网络预测部分</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> simple_model <span class="keyword">import</span> SimpleModel</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prediction</span>(<span class="params">params_path, data</span>):</span><br><span class="line">    model = SimpleModel()</span><br><span class="line">    model.load_state_dict(torch.load(params_path, map_location=torch.device(<span class="string">&#x27;cpu&#x27;</span>)))</span><br><span class="line">    model.<span class="built_in">eval</span>() <span class="comment"># 将模型设置为评估模式</span></span><br><span class="line">    data = torch.tensor(data, dtype=torch.float32)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        pred = model(data)</span><br><span class="line">    <span class="keyword">return</span> pred.numpy()</span><br></pre></td></tr></table></figure><h1 id="Matlab端"><a href="#Matlab端" class="headerlink" title="Matlab端"></a>Matlab端</h1><h2 id="test-simple-model-m"><a href="#test-simple-model-m" class="headerlink" title="test_simple_model.m"></a>test_simple_model.m</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">in_data = <span class="built_in">ones</span>(<span class="number">1</span>, <span class="number">10</span>) * <span class="number">0.6</span>;</span><br><span class="line">pred = matpy(<span class="string">&#x27;simple_model.pth&#x27;</span>, in_data);</span><br><span class="line"><span class="built_in">disp</span>(pred);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pred</span> = <span class="title">matpy</span><span class="params">(params_path, data)</span></span></span><br><span class="line">    model = py.importlib.import_module(<span class="string">&#x27;inference&#x27;</span>);</span><br><span class="line">    pred = model.prediction(pyargs(<span class="string">&#x27;params_path&#x27;</span>, params_path, <span class="string">&#x27;data&#x27;</span>, data));</span><br><span class="line">    pred = double(pred);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://zhuanlan.zhihu.com/p/536858806">MATLAB调用Pytorch神经网络模型进行预测</a></li><li><a href="https://ww2.mathworks.cn/help/matlab/matlab_external/create-object-from-python-class.html">从MATLAB访问Python模块-快速入门</a></li><li><a href="https://blog.csdn.net/chlet/article/details/130422820">深入理解Pytorch中模型保存文件pth</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Matlab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决键盘Win+L无法锁屏</title>
      <link href="/2024/01/25/win-l-invalid/"/>
      <url>/2024/01/25/win-l-invalid/</url>
      
        <content type="html"><![CDATA[<p>这两天按键盘上的Win+L键突然不能锁屏了，隐约记得之前也遇到过类似的问题，但之前没有记录下来。这次又遇到了，找到解决方案后马上记录！</p><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>第一步：按下Ctrl+Esc键（Win键的组合键），看看是否好用，如果是好的情况，那么大概率是Win键被锁住了。</p><p>第二步：按下Fn+Win键，解开Win键，此时Win+L已经可以使用了。</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul><li><a href="https://blog.csdn.net/weixin_43947456/article/details/107952943">解决Windows键+L不能锁屏的问题</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>小鼠脑图谱——脑区定位</title>
      <link href="/2024/01/17/mice-brain-atlas/"/>
      <url>/2024/01/17/mice-brain-atlas/</url>
      
        <content type="html"><![CDATA[<h1 id="小鼠脑立体定位图谱"><a href="#小鼠脑立体定位图谱" class="headerlink" title="小鼠脑立体定位图谱"></a>小鼠脑立体定位图谱</h1><div class="row">    <embed src="https://img.cwxhmk.top/pdf/mice_brain_atlas_v4.pdf" width="100%" height="550" type="application/pdf"></div><h1 id="小鼠脑立体定位图谱网页版"><a href="#小鼠脑立体定位图谱网页版" class="headerlink" title="小鼠脑立体定位图谱网页版"></a>小鼠脑立体定位图谱网页版</h1><p>之前就听说有一个网站，输入脑立体定位坐标（ML、AP、DV）后就可以看位点在图谱中的位置，今天偶然在丁香园社区中看到了一个帖子，分享的正是我想找的网站。不过需要注意实验小鼠的体重尽量与图谱保持一致（26~30g）。</p><ul><li><a href="http://labs.gaidi.ca/mouse-brain-atlas/">小鼠脑图谱</a></li><li><a href="http://labs.gaidi.ca/rat-brain-atlas/">大鼠脑图谱</a></li></ul><p>网页中会用红点🔴标识位点在冠状面和矢状面的位置。以lOFC为例，输入(2.6, 1.3, -2.2)，即可得到位点所在冠状面和矢状面（此处我没有保存带位点的图片）。注意日常习惯的坐标顺序是(AP, ML, DV)，但是网站中坐标顺序是ML在前，输入时务必注意。<br><img src="http://labs.gaidi.ca/mouse-brain-atlas/images/Mouse_Brain_Atlas_8.jpg"><br><img src="http://labs.gaidi.ca/mouse-brain-atlas/images/Mouse_Brain_Atlas_111.jpg"></p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://www.dxy.cn/bbs/newweb/pc/post/43382059">小鼠和大鼠的大脑立体定位图谱</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 脑图谱 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用matlab向串口收发数据</title>
      <link href="/2024/01/12/matlab-serialport/"/>
      <url>/2024/01/12/matlab-serialport/</url>
      
        <content type="html"><![CDATA[<p>我想获取到行为端的数据，以及控制TFT屏幕显示不同的内容。之前只是简单地使用过arduino ide的串口调试器，将刺激呈现的时间戳发送给串口。昨天看到一篇<a href="https://zhuanlan.zhihu.com/p/379766979">教程</a>，提及matlab可以接收串口数据，经查阅，也可以向串口发送数据，这样一来就可以在matlab中直接获取串口内的时间戳，也可以通过串口给arduino发送控制信息。</p><h1 id="matlab端"><a href="#matlab端" class="headerlink" title="matlab端"></a>matlab端</h1><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">s = serialport(<span class="string">&#x27;COM7&#x27;</span>, <span class="number">9600</span>);</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span></span><br><span class="line">    write(s, trial_types(randi(<span class="built_in">size</span>(trial_types,<span class="number">2</span>))), <span class="string">&quot;string&quot;</span>); <span class="comment">% 向串口写数据</span></span><br><span class="line">    str = readline(s); <span class="comment">% 从串口读数据</span></span><br><span class="line">    <span class="built_in">disp</span>(strtrim(str));</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h1 id="arduino端"><a href="#arduino端" class="headerlink" title="arduino端"></a>arduino端</h1><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">String</span> <span class="title">readLine</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">String</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">Serial</span>.<span class="built_in">available</span>())&#123;</span><br><span class="line">    str += <span class="built_in">char</span>(<span class="built_in">Serial</span>.<span class="built_in">read</span>());</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">String</span> str = <span class="built_in">readLine</span>();</span><br><span class="line">  <span class="keyword">if</span> (str.<span class="built_in">length</span>() != <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot;Arduino: &quot;</span> + str);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><ol><li>端口号可以在设备管理器的端口中查看</li><li>使用matlab向串口发送数据有一定的延时，最好的解决方案是放在while循环中</li></ol><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="http://www.zlmcu.com/document/com_debug_tools.html">串口调试助手</a></li><li><a href="https://zhuanlan.zhihu.com/p/379766979">9天学会Arduino系列- 3 串口的数据传送</a></li><li><a href="https://www.bilibili.com/video/BV1at4y187yf">python与arduino通信教程</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arduino </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【arduino探索】点亮ST7789 1.3寸TFT屏幕</title>
      <link href="/2024/01/09/arduino-tft/"/>
      <url>/2024/01/09/arduino-tft/</url>
      
        <content type="html"><![CDATA[<h1 id="Adafruit-GFX-Library"><a href="#Adafruit-GFX-Library" class="headerlink" title="Adafruit-GFX-Library"></a>Adafruit-GFX-Library</h1><p>该类库为所有彩色屏幕的基础类库，安装方式：在Arduino的项目-加载库-库管理器中搜索Adafruit GFX Library，选择最新版本进行安装。<a href="https://github.com/adafruit/Adafruit-GFX-Library">Github下载地址</a><br>Arduino中的第三方库的存放地址可以在首选项-项目文件夹位置处查看，该路径下的libraries文件夹下即为第三方库的存放地址。</p><h1 id="Arduino-ST7789-Library"><a href="#Arduino-ST7789-Library" class="headerlink" title="Arduino-ST7789-Library"></a>Arduino-ST7789-Library</h1><p>该类库为ST7789的专用驱动库。<a href="https://github.com/lspoplove/Arduino-ST7789-Library">Github下载地址</a><br>运行画直线的程序，用时约32.6s，太慢了，每次黑屏都要等半天！</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Adafruit_GFX.h&gt;</span>    <span class="comment">// Core graphics library by Adafruit</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino_ST7789.h&gt;</span> <span class="comment">// Hardware-specific library for ST7789 (with or without CS pin)</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SPI.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_DC    8</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_RST   7  <span class="comment">//9 </span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_CS    9  <span class="comment">//10 // only for displays with CS pin</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_MOSI  11   <span class="comment">// for hardware SPI data pin (all of available pins)</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_SCLK  13   <span class="comment">// for hardware SPI sclk pin (all of available pins)</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> w 240</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> h 240</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Arduino_ST7789 tft = <span class="built_in">Arduino_ST7789</span>(TFT_DC, TFT_RST, TFT_MOSI, TFT_SCLK, TFT_CS); <span class="comment">//for display with CS pin</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">micros_start</span><span class="params">()</span> __<span class="title">attribute__</span><span class="params">((always_inline))</span></span>;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">micros_start</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">uint8_t</span> oms = <span class="built_in">millis</span>();</span><br><span class="line">  <span class="keyword">while</span> ((<span class="type">uint8_t</span>)<span class="built_in">millis</span>() == oms)</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">micros</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  tft.<span class="built_in">init</span>(w, h);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> start = <span class="built_in">micros_start</span>();</span><br><span class="line"></span><br><span class="line">  tft.<span class="built_in">fillScreen</span>(BLACK);</span><br><span class="line">  <span class="built_in">testLines</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="type">uint32_t</span> usecLines = <span class="built_in">micros</span>() - start;</span><br><span class="line">  tft.<span class="built_in">setCursor</span>(<span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line">  tft.<span class="built_in">setTextSize</span>(<span class="number">3</span>);</span><br><span class="line">  tft.<span class="built_in">setTextColor</span>(RED);</span><br><span class="line">  tft.<span class="built_in">println</span>(<span class="string">&quot;Cost Time:&quot;</span>);</span><br><span class="line"></span><br><span class="line">  tft.<span class="built_in">setCursor</span>(<span class="number">0</span>, <span class="number">50</span>);</span><br><span class="line">  tft.<span class="built_in">setTextSize</span>(<span class="number">4</span>);</span><br><span class="line">  tft.<span class="built_in">setTextColor</span>(RED);</span><br><span class="line">  tft.<span class="built_in">println</span>(usecLines);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">60</span> * <span class="number">1000L</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int32_t</span> <span class="title">testLines</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> start;</span><br><span class="line">  <span class="type">int32_t</span> x1, y1, x2, y2;</span><br><span class="line"></span><br><span class="line">  start = <span class="built_in">micros_start</span>();</span><br><span class="line"></span><br><span class="line">  x1 = y1 = <span class="number">0</span>;</span><br><span class="line">  y2 = h - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (x2 = <span class="number">0</span>; x2 &lt; w; x2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    tft.<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x2 = w - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (y2 = <span class="number">0</span>; y2 &lt; h; y2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    tft.<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x1 = w - <span class="number">1</span>;</span><br><span class="line">  y1 = <span class="number">0</span>;</span><br><span class="line">  y2 = h - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (x2 = <span class="number">0</span>; x2 &lt; w; x2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    tft.<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (y2 = <span class="number">0</span>; y2 &lt; h; y2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    tft.<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x1 = <span class="number">0</span>;</span><br><span class="line">  y1 = h - <span class="number">1</span>;</span><br><span class="line">  y2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (x2 = <span class="number">0</span>; x2 &lt; w; x2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    tft.<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x2 = w - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (y2 = <span class="number">0</span>; y2 &lt; h; y2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    tft.<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x1 = w - <span class="number">1</span>;</span><br><span class="line">  y1 = h - <span class="number">1</span>;</span><br><span class="line">  y2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (x2 = <span class="number">0</span>; x2 &lt; w; x2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    tft.<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (y2 = <span class="number">0</span>; y2 &lt; h; y2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    tft.<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">micros</span>() - start;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Arduino-GFX"><a href="#Arduino-GFX" class="headerlink" title="Arduino_GFX"></a>Arduino_GFX</h1><p>安装方式：在Arduino的项目-加载库-库管理器中搜索GFX Library For Arduino，选择最新版本进行安装。<a href="https://github.com/moononournation/Arduino_GFX">Github下载地址</a><br>运行画直线的程序，用时约5.7s，速度超级快！在测试Arduino_GFX的时候还发生了一个小插曲，我连线明明是正确的，但屏幕没有任何反应，排了很久的bug，最后发现是我的arduino开发板有问题，果然太便宜了容易出问题，以后还是用正版的arduino开发板吧！</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino_GFX_Library.h&gt;</span></span></span><br><span class="line"><span class="type">int32_t</span> w, h;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* More dev device declaration: https://github.com/moononournation/Arduino_GFX/wiki/Dev-Device-Declaration */</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(DISPLAY_DEV_KIT)</span></span><br><span class="line">Arduino_GFX *gfx = <span class="built_in">create_default_Arduino_GFX</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">else</span> <span class="comment">/* !defined(DISPLAY_DEV_KIT) */</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* More data bus class: https://github.com/moononournation/Arduino_GFX/wiki/Data-Bus-Class */</span></span><br><span class="line">Arduino_DataBus *bus = <span class="built_in">create_default_Arduino_DataBus</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* More display class: https://github.com/moononournation/Arduino_GFX/wiki/Display-Class */</span></span><br><span class="line">Arduino_GFX *gfx = <span class="keyword">new</span> <span class="built_in">Arduino_ST7789</span>(bus, DF_GFX_RST, <span class="number">0</span> <span class="comment">/* rotation */</span>, <span class="literal">true</span> <span class="comment">/* IPS */</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* !defined(DISPLAY_DEV_KIT) */</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">micros_start</span><span class="params">()</span> __<span class="title">attribute__</span><span class="params">((always_inline))</span></span>;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">micros_start</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">uint8_t</span> oms = <span class="built_in">millis</span>();</span><br><span class="line">  <span class="keyword">while</span> ((<span class="type">uint8_t</span>)<span class="built_in">millis</span>() == oms)</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">micros</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  gfx-&gt;<span class="built_in">begin</span>();</span><br><span class="line">  w = gfx-&gt;<span class="built_in">width</span>();</span><br><span class="line">  h = gfx-&gt;<span class="built_in">height</span>();</span><br><span class="line"></span><br><span class="line">  <span class="meta">#<span class="keyword">ifdef</span> DF_GFX_BL</span></span><br><span class="line">    <span class="built_in">pinMode</span>(DF_GFX_BL, <span class="literal">OUTPUT</span>);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(DF_GFX_BL, <span class="literal">HIGH</span>);</span><br><span class="line">  <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> start = <span class="built_in">micros_start</span>();</span><br><span class="line"></span><br><span class="line">  gfx-&gt;<span class="built_in">fillScreen</span>(BLACK);</span><br><span class="line">  <span class="built_in">testLines</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="type">uint32_t</span> usecLines = <span class="built_in">micros</span>() - start;</span><br><span class="line"></span><br><span class="line">  gfx-&gt;<span class="built_in">setCursor</span>(<span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line">  gfx-&gt;<span class="built_in">setTextSize</span>(<span class="number">3</span>);</span><br><span class="line">  gfx-&gt;<span class="built_in">setTextColor</span>(RED);</span><br><span class="line">  gfx-&gt;<span class="built_in">println</span>(<span class="built_in">F</span>(<span class="string">&quot;Cost Time:&quot;</span>));</span><br><span class="line"></span><br><span class="line">  gfx-&gt;<span class="built_in">setCursor</span>(<span class="number">0</span>, <span class="number">50</span>);</span><br><span class="line">  gfx-&gt;<span class="built_in">setTextSize</span>(<span class="number">4</span>);</span><br><span class="line">  gfx-&gt;<span class="built_in">setTextColor</span>(RED);</span><br><span class="line">  gfx-&gt;<span class="built_in">println</span>(usecLines);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">60</span> * <span class="number">1000L</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int32_t</span> <span class="title">testLines</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> start;</span><br><span class="line">  <span class="type">int32_t</span> x1, y1, x2, y2;</span><br><span class="line"></span><br><span class="line">  start = <span class="built_in">micros_start</span>();</span><br><span class="line"></span><br><span class="line">  x1 = y1 = <span class="number">0</span>;</span><br><span class="line">  y2 = h - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (x2 = <span class="number">0</span>; x2 &lt; w; x2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    gfx-&gt;<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x2 = w - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (y2 = <span class="number">0</span>; y2 &lt; h; y2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    gfx-&gt;<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x1 = w - <span class="number">1</span>;</span><br><span class="line">  y1 = <span class="number">0</span>;</span><br><span class="line">  y2 = h - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (x2 = <span class="number">0</span>; x2 &lt; w; x2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    gfx-&gt;<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (y2 = <span class="number">0</span>; y2 &lt; h; y2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    gfx-&gt;<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x1 = <span class="number">0</span>;</span><br><span class="line">  y1 = h - <span class="number">1</span>;</span><br><span class="line">  y2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (x2 = <span class="number">0</span>; x2 &lt; w; x2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    gfx-&gt;<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x2 = w - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (y2 = <span class="number">0</span>; y2 &lt; h; y2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    gfx-&gt;<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x1 = w - <span class="number">1</span>;</span><br><span class="line">  y1 = h - <span class="number">1</span>;</span><br><span class="line">  y2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (x2 = <span class="number">0</span>; x2 &lt; w; x2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    gfx-&gt;<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  x2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (y2 = <span class="number">0</span>; y2 &lt; h; y2 += <span class="number">6</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    gfx-&gt;<span class="built_in">drawLine</span>(x1, y1, x2, y2, BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ESP8266</span></span><br><span class="line">    <span class="built_in">yield</span>(); <span class="comment">// avoid long run triggered ESP8266 WDT restart</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">micros</span>() - start;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="TFT-eSPI"><a href="#TFT-eSPI" class="headerlink" title="TFT_eSPI"></a>TFT_eSPI</h1><p>在Arduino的库管理器中搜索TFT_eSPI，安装最新版本。<a href="https://github.com/Bodmer/TFT_eSPI">Github下载地址</a>经测试，这个库太大了，arduino uno开发板无法成功上传。</p><h1 id="参考内容"><a href="#参考内容" class="headerlink" title="参考内容"></a>参考内容</h1><ul><li><a href="https://blog.csdn.net/yulusilian1/article/details/118422711">Arduino ST7789 240*240 1.3寸 TFT —— 新屏点亮篇</a></li><li><a href="https://simple-circuit.com/arduino-st7789-ips-tft-display-example/">Interfacing Arduino with ST7789 TFT Display – Graphics Test Example</a></li><li><a href="https://blog.csdn.net/yulusilian1/article/details/118444105">Arduino ST7789 240*240 1.3寸 TFT —— 飞升之高效率显示驱动篇</a></li><li><a href="https://zhuanlan.zhihu.com/p/141616278">ESP32彩屏显示入门：我要五彩斑斓的黑 | ESP32学习之旅-Arduino版</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arduino </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Desktop同步代码</title>
      <link href="/2024/01/05/github-desktop/"/>
      <url>/2024/01/05/github-desktop/</url>
      
        <content type="html"><![CDATA[<p>Github Desktop主要有三个添加仓库的选项：</p><ol><li>Clone a Repository</li><li>Create a new Repository</li><li>Add Existing&#x2F;Local Repository</li></ol><p>如果想把github远程仓库的代码克隆到本地，选择<code>Clone a Repository</code>，即可把远程仓库下载到指定的本地路径。</p><p>如果想创建新的仓库，选择<code>Create a new Repository</code>。</p><p>如果想把本地文件夹作为新的仓库上传到github，选择<code>Add Local Repository</code>。</p><p>如果本地改动了仓库中的代码，点击<code>Commit to main</code>，然后<code>Push origin</code>，即将新的代码推送到github上。<code>Fetching origin</code>是把github上的代码拉到本地。</p><div class="note warning flat"><ul><li>不要轻易同意删除本地仓库！！！警惕带<code>local</code>的选项！如果不小心删除了，尝试去回收站找回。</li><li>大部分情况下，创建仓库时选择<code>Keep this code private</code>。</li><li>不要一次性上传很多文件，也不要反复<code>push</code>代码，撤销<code>push</code>操作可能会误删本地代码！</li><li>同步重要数据时提前把数据复制到别的地方，做好备份，给自己留个后路！</li></ul></div>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github Desktop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>下载教育版origin</title>
      <link href="/2024/01/04/install-origin/"/>
      <url>/2024/01/04/install-origin/</url>
      
        <content type="html"><![CDATA[<p>之前在联想电脑上安装过origin，今天想在mac的虚拟机上也安一个origin，结果发现我不记得怎么下载了，也不记得之前是从哪里找到的正版安装途径，今天在搜索过程中竟然连官网都找错了，索性记录一下安装过程。</p><p>进入<a href="https://www.originlab.com/">origin官网</a>，点击顶部的<code>Try Origin for Free</code>，选择<code>I have NEVER used Origin</code>和<code>Student</code>，点击继续，即可看到如下的界面。<br><img src="https://img.cwxhmk.top/post/origin_install_1.jpg"></p><p>选择<code>Learning Edition</code>，填写姓名、学校、邮箱等信息。填写完提交后去教育邮箱中验证，即可收到软件的下载链接、序列号和密钥。<br><img src="https://img.cwxhmk.top/post/origin_install_2.jpg"></p><div class="note warning flat"><p>用同一个教育邮箱申请账号的话，得到的密钥是同一个，如果已经激活过origin软件，就不能在别的电脑上安装origin时使用了。┭┮﹏┭┮</p></div>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件安装 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在网页中实时显示当前时间</title>
      <link href="/2024/01/01/html-show-current-time/"/>
      <url>/2024/01/01/html-show-current-time/</url>
      
        <content type="html"><![CDATA[<p>早上吃完早饭去浙大图书馆主馆逛了一圈，终于见识到了传说中的自习区域墨水屏幕，确实很高级，如果这个座位被人预约了，屏幕上会显示预约人的姓名和预约时间！之前的基础图书馆里面很少有计算机相关的书籍，没想到新开的主馆里弥补了这个缺憾。</p><p>我上午看了一本arduino编程相关的书籍，对蓝牙和wifi模块很感兴趣，书中对这两个模块的使用只是举了一个很简单的例子，连接的都是arduino开发板的串口收发口，可以实现手机与arduino串口监视器的通信。</p><p>书中最后举了一个智能温室大棚的例子，我一直不太理解怎么实现手机远程控制arduino端的传感器。中午请教了一下康康，梳理了一下大致流程：arduino板连接wifi模块，接入校园网，向服务器发送传感器数据，可以存入txt文件或数据库中，手机或网页端通过服务器获取到传感器的数据，可以每隔1s请求一次数据。</p><div class="note info flat"><p>上位机：指可以<code>直接发送操作指令</code>的计算机或单片机，一般提供用户操作交互界面并向用户展示反馈数据。</p><p>下位机：指直接与机器相连接的计算机或单片机，一般用于<code>接收和反馈上位机的指令</code>，并且<code>根据指令控制机器执行动作</code>以及<code>从机器传感器读取数据</code>。</p><p>上位机给下位机发送控制命令，下位机收到此命令并执行相应的动作。<br>上位机给下位机发送状态获取命令，下位机收到此命令后调用传感器测量，然后转为数字信息反馈给上位机。<br>下位机主动发送状态信息或报警信息给上位机。</p></div><p>我一直困惑间隔1s请求一次数据，是否会在网页上看到数据刷新时的闪烁，为了解决这个困惑，康康建议我写个简单的网页测试一下，每个1s获取一下当前的时间。经实践测试，人眼并不会看到数据刷新时的闪烁。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;script src=&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;time-now&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        setInterval(function ()&#123;</span><br><span class="line">            $(&#x27;#time-now&#x27;).text(new Date())</span><br><span class="line">        &#125;, 1000)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://blog.csdn.net/qq_35394434/article/details/83747008">在html页面实时显示系统时间</a></li><li><a href="https://blog.csdn.net/baidu_38607919/article/details/102506792">一个好用的VScode预览html插件——Live Server Preview</a></li><li><a href="https://blog.csdn.net/BlizzardWu/article/details/124143767">JS定时器的4种写法及介绍</a></li><li><a href="https://zhuanlan.zhihu.com/p/269714623">【基础篇】做了这么久，才知道什么是上位机</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 物联网 </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023年度总结</title>
      <link href="/2023/12/29/experience-2023/"/>
      <url>/2023/12/29/experience-2023/</url>
      
        <content type="html"><![CDATA[<h1 id="小确幸"><a href="#小确幸" class="headerlink" title="小确幸"></a>小确幸</h1><h2 id="科研"><a href="#科研" class="headerlink" title="科研"></a>科研</h2><p>和去年的我相比，我最大的感触就是我开始去做一些事情了，我能渐渐抛开过去的成绩，正视自己存在的不足，耐心去学习、去积累。从一开始辅助课题组同事做数据分析，到后来争取到合作课题，再到现在慢慢有了自己的课题，很多事情在一开始我并不能看清未来的走向，但我还是选择坚定的走下去，我相信只有这样才能把路走远走宽。</p><p>我原本以为这五年我都不会碰生物实验，我相信或许我跨专业就不该碰生物实验，但我常常内心动摇，一方面是对我已有的能力能否支撑我顺利毕业信心不足，另一方面是希望可以自己做实验收集数据，不想一直依附于其他人。</p><p>我经常感觉很多事情困难，其实是因为它们一直停留在我的想象中，从未付诸实践。今年下半年我的做事态度转变很大，我开始敢于提出自己的数据分析思路，开始尝试稍微复杂一些的算法，开始学做生物实验，开始自己焊接线路搭建行为装置。我才发现我有能力做到这么多事情，我可以用数据分析结果影响课题的走向，我可以一个人完成小鼠脑立体定位手术，我可以搭建好硬件电路！</p><p>希望新的一年我可以进一步提升专业技能，努力做一个有价值的、值得信赖的人，也希望科研方面可以有新的突破，加油加油！我的2024一定很哇塞！🥳</p><h2 id="电影🎬"><a href="#电影🎬" class="headerlink" title="电影🎬"></a>电影🎬</h2><ul><li>航海王：红发歌姬</li><li>满江红</li><li>人生路不熟</li><li>变形金刚：超能勇士崛起</li><li>消失的她</li><li>八角笼中</li><li>长安三万里</li><li>流浪地球2</li><li>孤注一掷</li><li>无价之宝</li><li>刀尖</li><li>指环王</li><li>三大队</li></ul><h2 id="旅行"><a href="#旅行" class="headerlink" title="旅行"></a>旅行</h2><ul><li>聊城</li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-1-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-1-2.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-1-3.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-1-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-1-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-1-6.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-6.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-7.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-8.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-9.jpg"></p>          </div><ul><li>杭州</li><li><ul><li>浙大紫金港</li></ul></li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-3-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-3-3.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-3-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-3-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-3-6.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-4-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-4-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-4-6.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-4-7.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-5-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-6-7.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-7-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-9-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-2.jpg"></p>          </div><ul><li><ul><li>动物园和植物园</li></ul></li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-2-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-2-2.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-2-3.jpg"></p>          </div><ul><li><ul><li>湘湖</li></ul></li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-4-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-4-2.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-4-3.jpg"></p>          </div><ul><li><ul><li>西湖</li></ul></li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-9-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-9-2.jpg"></p>          </div><ul><li><ul><li>灵隐寺</li></ul></li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-10-10.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-11.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-12.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-13.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-14.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-15.jpg"></p>          </div><ul><li><ul><li>浙江升非物质文化遗产馆</li></ul></li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-11-6.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-7.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-8.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-9.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-10.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-11.jpg"></p>          </div><ul><li><ul><li>塘栖古镇</li></ul></li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-12-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-12-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-12-6.jpg"></p>          </div><ul><li><ul><li>闲逛</li></ul></li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-9-3.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-9-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-9-6.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-3.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-11-5.jpg"></p>          </div><ul><li>北京</li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-2-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-2-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-2-6.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-2-7.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-2-8.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-2-9.jpg"></p>          </div><ul><li>南京</li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-4-8.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-4-9.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-4-10.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-5-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-5-2.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-5-3.jpg"></p>          </div><ul><li>绍兴</li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-6-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-6-2.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-6-3.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-6-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-6-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-6-6.jpg"></p>          </div><ul><li>邢台</li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-8-8.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-8-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-8-2.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-8-3.jpg"></p>          </div><ul><li>西安</li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-10-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-2.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-3.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-10-16.jpg"></p>          </div><h2 id="鸟🐦"><a href="#鸟🐦" class="headerlink" title="鸟🐦"></a>鸟🐦</h2><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-bird-1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-bird-2.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-bird-3.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-bird-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-bird-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-bird-6.jpg"></p>          </div><h2 id="喜事"><a href="#喜事" class="headerlink" title="喜事"></a>喜事</h2><ul><li>我的小侄子出生啦~</li><li>实验室三位同门都在今年结婚了，喜糖不断！🍬</li><li>康康要来杭州工作啦！</li></ul><h2 id="小技能"><a href="#小技能" class="headerlink" title="小技能"></a>小技能</h2><ul><li>催眠课上学到了一个小魔术🥰</li><li>做饭！</li></ul><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-5-6.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-8-4.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-8-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-8-6.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-12-2.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-12-3.jpg"></p>          </div><h2 id="讲座"><a href="#讲座" class="headerlink" title="讲座"></a>讲座</h2><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/2023-5-5.jpg"><br><img src="https://img.cwxhmk.top/gallary/2023-12-1.jpg"></p>          </div><h1 id="经验"><a href="#经验" class="headerlink" title="经验"></a>经验</h1><ol><li>生活不是一成不变的，路是越走越宽的</li><li>不要一味地获取资源，对已有资源的消化和吸收更重要</li><li>在做重大决定之前要给自己想好后路，不要心血来潮</li><li>想学的东西很多不要怕，每次学多少也不用太过死板，重要的是持续去学习</li><li>从论文中摘录的观点或数据图，要注明文献出处，以免后续找不到哪一篇文献</li><li>代码要规范命名，写好注释及文档说明，及时同步到github</li><li>做事情要有逻辑，数据分析要紧紧围绕科研问题</li><li>我们并不仅仅是被动处于一个环境之中，我们也可以通过努力去影响和改变周围的环境</li><li>做事要善始善终，别人交代的事情要及时反馈</li><li>笔记中注明当天时间，便于复盘</li><li>对自己的能力有合理的评估，既要量力而行，又要适当突破舒适圈</li><li>要相信每次讨论都是有价值的，及时记录</li><li>文件多平台同步会极大提高工作效率</li><li>学到的知识及时整理，尽量可以用自己的话写出来，有机会的话还可以讲给别人，这样对知识的理解更深刻</li><li>要警惕一直做别人安排的事情，要有自己的思想，对自己做的事情有清晰的认知和规划，明确任务的优先级</li><li>事情并不会总按预期进行，要考虑全面，接受有可能发生的不好的结果</li><li>实践是最快速的学习方式</li><li>成绩不等于个人能力，要想证明自己就要拿出成果</li><li>过去偷懒绕开的困难也许在不久的将来又会变成拦路石，总是要面对的</li></ol>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 年度总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【MATLAB App Designer使用教程】可拖拽的线</title>
      <link href="/2023/12/29/matlab-app-designer-1/"/>
      <url>/2023/12/29/matlab-app-designer-1/</url>
      
        <content type="html"><![CDATA[<h2 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drag_line</span><span class="params">(app, fig, sel_line)</span></span></span><br><span class="line">    sel_line.ButtonDownFcn = @bdfcn;</span><br><span class="line">    opx = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bdfcn</span><span class="params">(~, edata)</span></span></span><br><span class="line">        opx = edata.IntersectionPoint(<span class="number">1</span>); <span class="comment">% 鼠标点击位置在坐标轴中的x坐标</span></span><br><span class="line">        sel_line.Selected = <span class="string">&#x27;on&#x27;</span>; <span class="comment">% 将拖动的线条设置为选中状态</span></span><br><span class="line">        app.UIFigure.WindowButtonMotionFcn = @wbmfcn; <span class="comment">% 鼠标在窗口内移动时</span></span><br><span class="line">        app.UIFigure.WindowButtonUpFcn = @wbufcn; <span class="comment">% 鼠标在窗口内弹起时</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">wbmfcn</span><span class="params">(~,~)</span></span></span><br><span class="line">        cp = fig.CurrentPoint; <span class="comment">% 当下鼠标所在的位置</span></span><br><span class="line">        dx = cp(<span class="number">1</span>,<span class="number">1</span>) - opx; <span class="comment">% 鼠标移动的差值</span></span><br><span class="line">        newXData = sel_line.XData + dx;</span><br><span class="line">        xLimits = fig.XLim;</span><br><span class="line">        <span class="comment">% 检查新的 XData 是否在范围内</span></span><br><span class="line">        <span class="keyword">if</span> all(newXData &gt;= xLimits(<span class="number">1</span>)) &amp;&amp; all(newXData &lt;= xLimits(<span class="number">2</span>))</span><br><span class="line">            sel_line.XData = newXData;</span><br><span class="line">            opx = cp(<span class="number">1</span>,<span class="number">1</span>); <span class="comment">% 更新 opx</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        app.LocationEditField.Value = sel_line.XData(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">wbufcn</span><span class="params">(~,~)</span></span></span><br><span class="line">        app.UIFigure.WindowButtonMotionFcn = <span class="string">&#x27;&#x27;</span>; <span class="comment">% 窗口内按键移动回调</span></span><br><span class="line">        app.UIFigure.WindowButtonUpFcn = <span class="string">&#x27;&#x27;</span>; <span class="comment">% 窗口内按键弹起回调</span></span><br><span class="line">        sel_line.Selected = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% startupFcn</span></span><br><span class="line">arrayfun(@(ax) disableDefaultInteractivity(ax),[app.UIAxes]);</span><br><span class="line">xlim(app.UIAxes, [<span class="number">-10</span> <span class="number">10</span>]);</span><br><span class="line">drag_line(app, app.UIAxes, <span class="built_in">plot</span>(app.UIAxes, [<span class="number">0</span> <span class="number">0</span>], [<span class="number">0</span> <span class="number">1</span>], <span class="string">&#x27;LineWidth&#x27;</span>, <span class="number">2</span>));</span><br></pre></td></tr></table></figure><h2 id="运行效果"><a href="#运行效果" class="headerlink" title="运行效果"></a>运行效果</h2><p><img src="https://img.cwxhmk.top/gif/drag_line.gif" alt="文字"> </p>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Matlab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【arduino探索】搭建触摸给水装置</title>
      <link href="/2023/12/29/arduino-touch-pump/"/>
      <url>/2023/12/29/arduino-touch-pump/</url>
      
        <content type="html"><![CDATA[<h1 id="实验材料准备"><a href="#实验材料准备" class="headerlink" title="实验材料准备"></a>实验材料准备</h1><ul><li><p>电容触摸传感器*1</p><img src="https://img.cwxhmk.top/post/touch-sensor.jpg" alt="触摸传感器" width="30%" height="30%" /> </li><li><p>蠕动泵*1</p></li><li><p>可孚一次性无菌加药器 50ml（粗针管）</p></li><li><p>杜邦线公对公</p></li><li><p>Arduino Uno R3*1</p></li><li><p>粗针头*2</p></li><li><p>绝缘胶带</p></li></ul><blockquote><p>电容触摸传感器和蠕动泵需要焊接杜邦线，用剪刀减去杜邦线一端的公头，用剥线钳暴露铜丝，短暂加热焊锡覆盖暴露的铜丝。</p></blockquote><h1 id="配件功能测试"><a href="#配件功能测试" class="headerlink" title="配件功能测试"></a>配件功能测试</h1><p>首先测试给水装置核心配件的功能是否正常。</p><h2 id="电容触摸传感器"><a href="#电容触摸传感器" class="headerlink" title="电容触摸传感器"></a>电容触摸传感器</h2><p>电容触摸传感器上标有VCC、GND和DAT引脚，VCC是电源引脚，用于给传感器供电；GND是接地引脚；DAT是数据引脚，用于传输触摸信号。经过Arduino程序测试，发现电容触摸传感器默认为高电平，触摸时为低电平。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(A0, <span class="literal">INPUT</span>); <span class="comment">// 电容触摸传感器</span></span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">2</span>, <span class="literal">OUTPUT</span>); <span class="comment">// LED</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="built_in">digitalRead</span>(A0));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>用绝缘胶带缠绕触摸传感器引脚的杜邦线（起到保护和固定的作用），将粗针头固定到传感器较平整的一面，该装置即可作为小鼠的舔水口，小鼠通过针头舔水时，针头另一端会按压触摸传感器，因此可以根据触摸传感器电平的变化检测舔水事件。</p><p>为了更好地观察小鼠的舔水事件，我选用LED灯反映触摸传感器的状态，LED的正极连接arduino开发板的2号引脚。实现的效果为，小鼠舔水时（即按压触摸传感器）时，LED灯亮。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">digitalRead</span>(A0) == <span class="literal">LOW</span>)&#123;</span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">HIGH</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">LOW</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="蠕动泵"><a href="#蠕动泵" class="headerlink" title="蠕动泵"></a>蠕动泵</h2><p>上次买的蠕动泵有一个小配件被我弄坏了，这次测试新买的蠕动泵，通过转接头连接硅胶管，进水口放入粗针管内。给蠕动泵提供5V的电压，经测试，可以正常工作，出水口正常出水。<br>由于要控制训练过程中每个试次的给水量，因此对蠕动泵的出水量进行测试。经询问师弟，可以采用给水0.1s，间隔0.1s，并重复40次的方式测量，测量前称纸巾的重量，测量后再对纸巾称重，即可计算出每次给水的体积。连续两天测量蠕动泵的出水量，如果保持不变，即认为可正常工作。<br>$$m&#x3D;\rho V$$</p><p>$$\rho_{水} &#x3D;1g&#x2F;cm^3 $$</p><p>$$1cm^3&#x3D;1000\mu L$$</p><ul><li>12.29 测试结果：40次 给水0.1s 间隔0.1s 称重：0.05g</li></ul><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(A0, <span class="literal">INPUT</span>); <span class="comment">// 电容触摸传感器</span></span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">2</span>, <span class="literal">OUTPUT</span>); <span class="comment">// 蠕动泵</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>); </span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= <span class="number">40</span>; i ++)&#123; <span class="comment">// 测出水量</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">HIGH</span>);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">100</span>); <span class="comment">// ms</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">LOW</span>);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">100</span>); <span class="comment">// ms</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="built_in">digitalRead</span>(A0));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="实验装置"><a href="#实验装置" class="headerlink" title="实验装置"></a>实验装置</h1><p><img src="https://img.cwxhmk.top/post/%E8%A7%A6%E6%91%B8%E7%BB%99%E6%B0%B4%E8%A3%85%E7%BD%AE%E5%AE%9E%E7%89%A9%E8%BF%9E%E7%BA%BF.jpg" alt="触摸给水装置实物连线"></p><h1 id="触摸给水"><a href="#触摸给水" class="headerlink" title="触摸给水"></a>触摸给水</h1><p>接下来测试触摸传感器控制蠕动泵给水的功能，经测试，功能正常。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(A0, <span class="literal">INPUT</span>); <span class="comment">// 电容触摸传感器</span></span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">2</span>, <span class="literal">OUTPUT</span>); <span class="comment">// 蠕动泵</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="built_in">digitalRead</span>(A0));</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">digitalRead</span>(A0) == <span class="literal">LOW</span>)&#123; <span class="comment">// 测试触摸给水</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">HIGH</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>); <span class="comment">// ms</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">LOW</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="经验"><a href="#经验" class="headerlink" title="经验"></a>经验</h1><ol><li>小鼠训练过程中每天摄入水量为1ml~1.2ml</li><li>测试时针管内的气泡一定要排干净，且传感器的放置方式与实际任务期间保持一致</li></ol>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arduino </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【arduino探索】使用ArControl编写“炸弹💣游戏”</title>
      <link href="/2023/12/26/arcontrol-boom-game/"/>
      <url>/2023/12/26/arcontrol-boom-game/</url>
      
        <content type="html"><![CDATA[<div class="note info flat"><p>游戏规则：<br>简易版：游戏有一个5秒倒计时炸弹，时间到了就会爆炸，马里奥玩家就会死亡。如果玩家可以在这5s内按下停止开关，炸弹不会爆炸，玩家马里奥任务成功。</p><p>实验材料：<br>Arduino UNO R3 * 1<br>面包板 * 1<br>发光二极管 * 1（模拟炸弹）<br>按钮 * 1（模拟开关）</p></div><h1 id="Arduino引脚映射"><a href="#Arduino引脚映射" class="headerlink" title="Arduino引脚映射"></a>Arduino引脚映射</h1><p>ArControl对Arduino UNO开发板做了端口映射，定义好了6个输入端口和8个输出端口，示意图如下。IN和OUT都是相对于Arduino开发板来说的。在这个小游戏中，我们使用<code>pinA0</code>即<code>IN1</code>接收按钮的状态，<code>pin2</code>即<code>OUT1</code>控制LED灯的状态。</p><p><img src="https://img.cwxhmk.top/post/Arduino_UNO_Pin.png" alt="Arduino引脚映射"></p><h1 id="Arduino测试程序"><a href="#Arduino测试程序" class="headerlink" title="Arduino测试程序"></a>Arduino测试程序</h1><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试按钮控制led灯是否正常</span></span><br><span class="line"><span class="type">int</span> ledPin = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(A0, <span class="literal">INPUT</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(ledPin, <span class="literal">OUTPUT</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">digitalRead</span>(A0) == <span class="literal">HIGH</span>)&#123;</span><br><span class="line">    <span class="built_in">digitalWrite</span>(ledPin, <span class="literal">HIGH</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">digitalWrite</span>(ledPin, <span class="literal">LOW</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Arduino实物连接图"><a href="#Arduino实物连接图" class="headerlink" title="Arduino实物连接图"></a>Arduino实物连接图</h1><div class="note warning flat"><p>关于接线我还闹了个笑话，我在ArControl上进行测试，发现按下按钮之后，<code>IN1</code>端口会持续很久的高电平，而且不按按钮时也会有通道闪烁的情况。我在arduino IDE中测试按钮控制LED灯的情况，发现了类似的问题，当我不按按钮时，LED灯也是亮的，按下按钮之后，LED灯只是变得更亮了。我检查线路并没发现什么问题，去请教师兄，才发现我接线时按钮旁边的下拉电阻没接上！！！😅按我那样的接法，电阻纯属摆设，跟按钮的电路半毛钱关系都没有。重新接好电阻之后，再测试就正常了。(＾－＾)V</p></div><p><img src="https://img.cwxhmk.top/post/arduino-boom%E5%AE%9E%E7%89%A9%E6%8E%A5%E7%BA%BF%E5%9B%BE.jpg" alt="实物连接图"></p><h1 id="ArControl使用流程"><a href="#ArControl使用流程" class="headerlink" title="ArControl使用流程"></a>ArControl使用流程</h1><p>ArControl的软件部分主要包括两个应用程序，其中ArControl Designer用于编写行为范式的protocol，ArControl Recorder用于监控端口的运行状态并采集实验数据。</p><h2 id="ArControl-Designer"><a href="#ArControl-Designer" class="headerlink" title="ArControl Designer"></a>ArControl Designer</h2><p>ArControl Designer借鉴了状态机的原理，把行为实验流程等效分解为一系列时序上相互衔接的子任务（State），可以根据实验逻辑在状态之间进行跳转。</p><p>每一个State可以对6种功能进行配置，包括改变任务变量（do-var）、控制输出通道（do-pin）、 检测任务变量（when-var）、检测实验计数（when-count）、检测等待时间 （when-time）以及检测输入端口（when-pin）。其中每个功能的详细配置是在子窗体中进行的。</p><p>在这个小游戏中，逻辑比较简单，可以分为倒计时、炸弹爆炸和炸弹不爆炸三个状态，分别记为<code>S1</code>、<code>S2</code>和<code>S3</code>。如果在没有在5s内按下停止开关，则跳转到<code>S2</code>；如果在5s内按下停止开关，则跳转到<code>S3</code>。编写完实验流程之后，保存。</p><p><img src="https://img.cwxhmk.top/post/arcontrol-designer.jpg" alt="ArControl Designer"><br>如果想查看实验流程图，也可以点击File→Export pdf，这个功能真的很方便检查实验逻辑！<br><img src="https://img.cwxhmk.top/post/arduino-boom-procedure.jpg" alt="流程图"></p><h2 id="ArControl-Recorder"><a href="#ArControl-Recorder" class="headerlink" title="ArControl Recorder"></a>ArControl Recorder</h2><p>选择Arduino开发板对应的端口，载入实验流程并烧录进开发板。点击<code>Start</code>按钮即可运行，点击<code>Stop</code>按钮即可手动终止程序，也可以等程序运行完自动结束。中间的板块可以实时观察输入&#x2F;输出端口的电平变化，如果为绿色，则表示当前端口是高电平。下图分别为炸弹💣爆炸💥和成功按下停止开关时的端口状态。</p><p><img src="https://img.cwxhmk.top/post/arcontrol-boom-1.jpg" alt="Boom"><br><img src="https://img.cwxhmk.top/post/arcontrol-boom-2.jpg" alt="No boom"></p><h1 id="参考内容"><a href="#参考内容" class="headerlink" title="参考内容"></a>参考内容</h1><ul><li><a href="https://www.bilibili.com/video/BV13v411v7TN/">[Arduino] 2_状态机可视化编程_ArControl工具_实例”炸弹游戏”</a></li><li><a href="https://github.com/chenxinfeng4/ArControl">Github ArControl</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arduino </tag>
            
            <tag> ArControl </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【arduino探索】控制蠕动泵出水</title>
      <link href="/2023/12/26/arduino-pump/"/>
      <url>/2023/12/26/arduino-pump/</url>
      
        <content type="html"><![CDATA[<p>前几天在淘宝上买的蠕动泵终于到货了，早上拆开快递一脸懵，摆在我面前两个难题：第一，我该怎么给这个蠕动泵供电呢？虽然顶部标有正负极，但我还是不知道该怎么办；第二，蠕动泵自带了管子，比较短，我怎么换成我们实验室自己的硅胶管呢？</p><p>对于第一个问题，我请教了师弟。拿剪刀将杜邦线剪去一头，然后用剥线钳暴露电线，将电线穿过蠕动泵顶部的孔，折叠后焊锡，另一个孔也同样操作即可。接好线后我在arduino板上测试了一下，一端接入5V电压，另一端接地，测试发现可以正常工作！</p><p>对于第二个问题，我的第一反应是把自带的管抽出来，换成我们实验室自己的硅胶管。但我抽出来才发现，泵头的孔太小，硅胶管穿不进去。后来尝试把管口剪尖，终于穿进去了，结果泵头的一个小组件崩飞了，┭┮﹏┭┮。后来师弟和师姐意外发现快递里面的转接头（我早就看到了，但不知道是干啥用的），告诉我说这个可以直接接到自带的管上，然后另一端连自己的硅胶管，我才恍然大悟！</p><img src="https://img.cwxhmk.top/post/%E8%BD%AC%E6%8E%A5%E5%A4%B4.jpg" alt="图片说明" width="50%" height="50%" /> <p>虽然小零件崩飞了，但我还是完整地测试了一下蠕动泵的功能（用led blink的程序测试的），一端接<code>pin12</code>，一端接地，arduino写入程序后蠕动泵可以实现间隔1s给水。静待我买的新蠕动泵！<br><img src="https://img.cwxhmk.top/post/%E8%A0%95%E5%8A%A8%E6%B3%B5%E6%8E%A5%E7%BA%BF%E5%AE%9E%E7%89%A9.jpg" alt="蠕动泵实物连线"></p>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arduino </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【arduino探索】按键控制LED灯</title>
      <link href="/2023/12/25/arduino-button-led-demo/"/>
      <url>/2023/12/25/arduino-button-led-demo/</url>
      
        <content type="html"><![CDATA[<h1 id="Arudino-Uno-R3开发板简介"><a href="#Arudino-Uno-R3开发板简介" class="headerlink" title="Arudino Uno R3开发板简介"></a>Arudino Uno R3开发板简介</h1><p><img src="https://img.cwxhmk.top/post/arduino-uno-description.jpg" alt="Arudino Uno R3开发板引脚说明"> </p><h1 id="电路图"><a href="#电路图" class="headerlink" title="电路图"></a>电路图</h1><div class="note info flat"><p>目标：使用四角按键开关控制LED灯，当按钮按下时灯亮，松开时灯灭。</p><p>实现思路：将引脚2改为<code>input mode</code>，反映按键的状态。引脚12为<code>output mode</code>，控制led灯的亮灭。当按键按下时，引脚2为高电平，此时led灯亮；当按钮松开时，引脚2为低电平，此时led灯灭。（对应仿真图连线）</p><p>如果引脚2的状态为<code>input pullup mode</code>（如果外部组件未启用，上拉电阻将输入端口处的电压拉到高电平），当按键按下时，引脚2为低电平，此时led灯亮；当按钮松开时，引脚2为高电平，此时led灯灭。（对应实物连线）</p><p>注意事项：四角按键同侧不相连，相连不同侧。</p></div><p><img src="https://img.cwxhmk.top/post/button-led%E4%BB%BF%E7%9C%9F%E5%9B%BE.jpg" alt="仿真"><br><img src="https://img.cwxhmk.top/post/button-led%E5%AE%9E%E7%89%A9%E5%9B%BE.jpg" alt="实物"> </p><h1 id="Arduino程序"><a href="#Arduino程序" class="headerlink" title="Arduino程序"></a>Arduino程序</h1><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> buttonPin = <span class="number">2</span>;</span><br><span class="line"><span class="type">int</span> ledPin = <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// put your setup code here, to run once:</span></span><br><span class="line">  <span class="built_in">pinMode</span>(buttonPin, <span class="literal">INPUT_PULLUP</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(ledPin, <span class="literal">OUTPUT</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// put your main code here, to run repeatedly:</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">digitalRead</span>(buttonPin) == <span class="literal">LOW</span>)&#123;</span><br><span class="line">    <span class="built_in">digitalWrite</span>(ledPin, <span class="literal">HIGH</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">digitalWrite</span>(ledPin, <span class="literal">LOW</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://blog.csdn.net/TonyIOT/article/details/81414118">Arduino基础入门篇07—按键控制LED灯</a></li><li><a href="https://www.tinkercad.com/">Arduino在线仿真平台</a></li><li><a href="https://www.bilibili.com/video/BV164411J7GE/">【太极创客】零基础入门学用Arduino 第一部分 合辑</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arduino </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Mac电脑上安装VMware Fusion</title>
      <link href="/2023/12/23/mac-vmware-fusion/"/>
      <url>/2023/12/23/mac-vmware-fusion/</url>
      
        <content type="html"><![CDATA[<p>大学毕业以后买了一台新的联想电脑，当时还因为终于可以用GPU而兴奋了很久，后来去北京出差背着电脑来回走了很久，不插着电源很快就会没电。从北京回来我就斥巨资买了一台苹果电脑，续航能力没得说，平时用的大部分软件也都是有mac版的。因为工位空间有限，我就把苹果电脑放在了工位，联想电脑留在了宿舍，平时偶尔会远程控制一下宿舍的电脑，但有时会很卡，操作也不太方便。</p><p>之前有想过安装mac双系统，但又怕对电脑不好，就一直将就着使用了。最近有一些软件只能在windows系统上运行，狠了狠心，在mac上安了个虚拟机（<a href="https://www.vmware.com/products/fusion/fusion-evaluation.html">VMware Fusion 13</a>），可以比较方便地使用windows系统。（存储空间一下子少了很多，┻┳|･ω･|）</p><p>VMware Fusion有个人免费版，但我实在是注册不上这个网站，曲线救国选择下载Fusion 13 Pro，然后输入网上找到的序列号（<mark class="hl-label green">5N400-4AH82-M88Q3-0LC0P-0TRL0</mark> ），就可以正常使用了。</p><h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><ol><li>可以直接通过Microsoft安装win11</li><li>新建虚拟磁盘</li><li>记住密码并存储在mac钥匙串中</li><li>安装VMware Tools之后全屏可以铺满且有原始mac电脑的分辨率（以管理员身份运行windows powershell→输入Set-ExecutionPolicy RemoteSigned→A→菜单栏选择虚拟机→安装VMware Tools）</li><li>我安装的时候没有遇到网上教程所说的网络问题</li></ol><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://blog.csdn.net/weixin_52799373/article/details/129658881">M1&#x2F;M2 Pro VMware Fusion虚拟机安装Win11教程(超详细)</a></li><li><a href="https://www.bilibili.com/read/cv19980721/">支持M芯片的免费虚拟机软件来了！VMware Fusion 13安装教程</a></li><li><a href="https://zhuanlan.zhihu.com/p/452412091">在Apple芯片的Mac上通过VMware Fusion 13使用Windows 11</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 虚拟机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VSCode无法正常打开.ipynb文件</title>
      <link href="/2023/12/23/vscode-ipynb-error/"/>
      <url>/2023/12/23/vscode-ipynb-error/</url>
      
        <content type="html"><![CDATA[<p>上午原本想写程序，打开VSCode之后发现不能打开.ipynb文件了，报错信息如下：</p><div class="note danger flat"><p>Error loading webview: Error: Could not register service worker: InvalidStateError: Failed to register a ServiceWorker: The document is in an invalid state..</p><p>The editor could not be opened due to an unexpected error: Could not initialize webview: Error: Could not register service worker: InvalidStateError: Failed to register a ServiceWorker: The document is in an invalid state..</p></div><p>在网上查了一些解决方法，尝试过删除vscode缓存（~&#x2F;Library&#x2F;Application Support&#x2F;Code&#x2F;）、重新安装插件和重启VSCode，但都不起作用。经过不懈努力，终于在<a href="https://stackoverflow.com/questions/67698176/error-loading-webview-error-could-not-register-service-workers-typeerror-fai">stack overflow</a>上找到了适合我的解决方案，删除Service Worker文件夹之后重启VSCode，.ipynb文件就可以正常显示了！</p><div class="note success flat"><p>There is another possible reason for OSX, that the files in the following paths are restricted by user permissions.</p><p>MAC: ~&#x2F;Library&#x2F;Application Support&#x2F;Code&#x2F;Service Worker</p><p>You can directly delete folders with restricted permissions.</p><p>After restarting VScode, he will generate it again.</p></div>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Jupyter Notebook </tag>
            
            <tag> VSCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ImageJ插件开发</title>
      <link href="/2023/07/21/imagej-plugin-9/"/>
      <url>/2023/07/21/imagej-plugin-9/</url>
      
        <content type="html"><![CDATA[<h1 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h1><ol><li>安装Java8 JDK (Windows x86 64-bit) ​<a href="https://docs.azul.com/core/zulu-openjdk/install/windows">https://docs.azul.com/core/zulu-openjdk/install/windows</a></li><li>安装Eclipse IDE for Java Developers ​<a href="https://www.eclipse.org/downloads/">https://www.eclipse.org/downloads/</a></li><li>在github下载示例插件并修改 ​GitHub - imagej&#x2F;example-imagej2-command: Simple Maven project for an ImageJ2 command</li></ol><ul><li>修改pom.xml：重点修改groupId、artifactId、version、name、<properties>的内容</li><li>Eclipse-Import-Maven-Existing Maven Projects</li><li>重命名：项目名、包名、java文件中类名和菜单路径</li></ul><ol start="4"><li>Run as Java application 确保程序可以正常运行</li><li>Run as Maven build 控制台输出<mark class="hl-label green">BUILD</mark> <mark class="hl-label green">SUCCESS</mark> 则表示程序成功打包为jar包（保存在target目录下）</li><li>将jar包粘贴至Fiji的plugin目录，运行软件测试插件效果</li></ol><h1 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h1><ol><li>如果pom.xml中<parent>报错，则尝试修改<version>，并等待右下角更新完成</li><li>打包好的插件在ImageJ中无法正常运行，报错<code>java.lang.ClassCastException: com.chen.brain.pluginMain cannot be cast to org.scijava.plugin.SciJavaPlugin</code><br><strong>报错原因：</strong>pluginMain类没有实现org.scijava.command.Command接口，而这是必须的，才能将其识别为有效的SciJava插件。@Plugin注解用于指定该类应注册为一个命令插件，但由于它没有实现所需的接口，因此会导致ClassCastException异常。<br><strong>解决方案：</strong><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.scijava.command.Command;</span><br><span class="line"><span class="keyword">import</span> org.scijava.plugin.Plugin;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Plugin(type = Command.class, menuPath = &quot;Plugins&gt;brainRegistration&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">pluginMain</span> <span class="keyword">implements</span> <span class="title class_">Command</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 省略其他部分</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 在这里实现插件的逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">pluginMain</span>().location();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>在Eclipse中初次导入项目时，要等待build（可能需要等待几分钟）</li><li>最好在官方提供的模板基础上写自己的代码，而不是用自己新建的maven项目</li></ol><h1 id="参考内容"><a href="#参考内容" class="headerlink" title="参考内容"></a>参考内容</h1><ul><li><a href="https://imagej.net/develop/eclipse">参考文档</a></li><li><a href="%E2%80%8Bhttps://www.youtube.com/watch?v=YIWpoBnnLio">参考视频</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ImageJ </tag>
            
            <tag> Java </tag>
            
            <tag> Eclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>neurogym学习笔记【01】</title>
      <link href="/2023/07/17/neurogym/"/>
      <url>/2023/07/17/neurogym/</url>
      
        <content type="html"><![CDATA[<div class="note info flat"><p>NeuroGym是一个经过仔细挑选的神经科学任务集合，具有公共接口。其目标是促进在神经科学任务上神经网络模型的训练。</p><p>NeuroGym是一个工具包，可以让您在许多已建立的神经科学任务技术上训练任何神经网络模型，如标准的监督学习或强化学习。</p><p>该教程用于理解Neurogym的任务结构，程序运行环境为Google Colab。本文翻译自Neurogym官方文档，对应的代码 <a href="https://colab.research.google.com/drive/1ays7_LTBsLAM9O29Z0z0ozCZdvDWy3-R?usp=sharing">[Open in Colab]</a></p><p>neurogym是基于gym开发的，很多参数的设置用起来不是很顺手，不清楚源代码怎么写的，有些代码不太好理解。但本质上就是继承了gym的一些方法，生成行为任务的数据。后面可能不会直接用neurogym，而是仿写并实现课题组内已有的范式。</p></div><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">! pip install gym</span><br><span class="line">! git clone https://github.com/gyyang/neurogym.git</span><br><span class="line">%cd neurogym</span><br><span class="line">! pip install -e .</span><br></pre></td></tr></table></figure><h1 id="OpenAI-gym-任务"><a href="#OpenAI-gym-任务" class="headerlink" title="OpenAI gym 任务"></a>OpenAI gym 任务</h1><p>Neurogym任务遵循基本的OpenAI gym任务形式。每个任务定义为一个Python类，继承自<code>gym.Env</code>类。</p><p>在这一节中，我们描述一个OpenAI gym任务的基本结构。</p><p>在<code>__init__</code>方法中，必须定义两个属性，<code>self.observation_space</code>和<code>self.action_space</code>，它们描述了观测（网络输入）和动作（网络输出）的空间类型。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> gym</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyEnv</span>(gym.Env):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">super</span>().__init__()</span><br><span class="line">    self.observation_space = gym.spaces.Box(low=<span class="number">0.</span>, high=<span class="number">1.</span>, shape=(<span class="number">2</span>,))</span><br><span class="line">    self.action_space = gym.spaces.Discrete(<span class="number">3</span>)</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">step</span>(<span class="params">self, action</span>):</span><br><span class="line">    ob = self.observation_space.sample()</span><br><span class="line">    reward = <span class="number">1.</span></span><br><span class="line">    done = <span class="literal">False</span></span><br><span class="line">    info = &#123;&#125;</span><br><span class="line">    <span class="keyword">return</span> ob, reward, done, info</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">reset</span>(<span class="params">self</span>):</span><br><span class="line">    ob = self.observation_space.sample()</span><br><span class="line">    <span class="keyword">return</span> ob </span><br><span class="line">env = MyEnv()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;sample random observation value&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(env.observation_space.sample())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;sample random action value&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(env.action_space.sample())</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line"><span class="comment"># sample random observation value</span></span><br><span class="line"><span class="comment"># [0.23197113 0.8055692 ]</span></span><br><span class="line"><span class="comment"># sample random action value</span></span><br><span class="line"><span class="comment"># 0</span></span><br></pre></td></tr></table></figure><p>另一个需要定义的关键方法是<code>step</code>方法，用于接收智能体的动作后更新环境、输出观测和奖励。</p><p><code>step</code>方法将<code>action</code>作为输入，并输出智能体的下一个观测<code>observation</code>，智能体获得的标量奖励<code>reward</code>，用于描述环境是否需要重置的布尔值<code>done</code>，以及包含任何额外信息的字典<code>info</code>。</p><p>如果环境通过内部状态描述，<code>reset</code>方法需要重置这些内部状态。该方法返回一个初始观测<code>observation</code>。</p><p>下面我们定义一个简单的任务，智能体沿着一维直线采取动作。奖励由智能体在直线上的位置决定。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_reward</span>(<span class="params">x</span>):</span><br><span class="line">  <span class="keyword">return</span> np.sin(x) * np.exp(-np.<span class="built_in">abs</span>(x)/<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">xs = np.linspace(-<span class="number">10</span>, <span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line">plt.plot(xs, get_reward(xs))</span><br><span class="line">plt.xlabel(<span class="string">&#x27;State value(observation)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Reward&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.cwxhmk.top/post/20230719-1.png" alt="运行结果"><br>智能体可以与环节迭代地互动，红色星星表示智能体的初始状态。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyEnv</span>(gym.Env):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">super</span>().__init__()</span><br><span class="line">    self.observation_space = gym.spaces.Box(-<span class="number">10</span>,<span class="number">10</span>,(<span class="number">1</span>,))</span><br><span class="line">    self.action_space = gym.spaces.Discrete(<span class="number">3</span>) <span class="comment"># 0,1,2</span></span><br><span class="line">    self.state = <span class="number">0.</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">step</span>(<span class="params">self,action</span>):</span><br><span class="line">    self.state += (action - <span class="number">1.</span>) * <span class="number">0.1</span> <span class="comment"># action 0 1 2 对应状态 -0.1 0 0.1</span></span><br><span class="line">    self.state = np.clip(self.state, -<span class="number">10</span>, <span class="number">10</span>) <span class="comment"># 限制取值范围</span></span><br><span class="line">    ob = self.state</span><br><span class="line">    reward = get_reward(self.state)</span><br><span class="line">    done = <span class="literal">False</span></span><br><span class="line">    info = &#123;&#125;</span><br><span class="line">    <span class="keyword">return</span> ob, reward, done, info</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">reset</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="comment"># 重新初始化状态</span></span><br><span class="line">    self.state = self.observation_space.sample()</span><br><span class="line">    <span class="keyword">return</span> self.state</span><br><span class="line">env = MyEnv()</span><br><span class="line">ob = env.reset()  </span><br><span class="line">ob_log = <span class="built_in">list</span>() </span><br><span class="line">reward_log = <span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">  action = env.action_space.sample()</span><br><span class="line">  ob, reward, done, info = env.step(action)</span><br><span class="line">  ob_log.append(ob)</span><br><span class="line">  reward_log.append(reward)</span><br><span class="line">plt.plot(ob_log, reward_log)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;State value(observation)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Reward&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.cwxhmk.top/post/20230719-2.png" alt="运行结果"></p><h1 id="基于试次（trial）的Neurogym任务"><a href="#基于试次（trial）的Neurogym任务" class="headerlink" title="基于试次（trial）的Neurogym任务"></a>基于试次（trial）的Neurogym任务</h1><p>许多神经科学和认知科学的任务有试次结构。<code>neurogym.TrialEnv</code>为常见的基于试次任务提供了类。它与<code>gym.Env</code>的主要不同在于<code>_new_trial()</code>方法，该方法可以生成新试次的摘要信息，并且可选择地，生成观测和真实值输出。除此之外，用户提供了<code>_step()</code>方法而不是<code>step()</code>方法。</p><p><code>_new_trial()</code>方法接收任意键-值参数<code>**kwargs</code>，输出一个包含该试次相关信息的字典<code>trial</code>。这个字典在<code>_step</code>中可以作为<code>self.trial</code>访问。</p><p>这里我们定义一个简单的任务，智能体在每个试次需要基于它的观测做出一个二元决策。每个试次只有一个时间步。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> neurogym <span class="keyword">as</span> ngym</span><br><span class="line"><span class="keyword">from</span> neurogym <span class="keyword">import</span> TrialEnv</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyTrialEnv</span>(<span class="title class_ inherited__">TrialEnv</span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">super</span>().__init__()</span><br><span class="line">    self.observation_space = gym.spaces.Box(-<span class="number">1.</span>, <span class="number">1.</span>, (<span class="number">1</span>,))</span><br><span class="line">    self.action_space = gym.spaces.Discrete(<span class="number">2</span>) <span class="comment"># 0 1</span></span><br><span class="line">    self.next_ob = np.random.uniform(-<span class="number">1</span>, <span class="number">1</span>, size=(<span class="number">1</span>,)) <span class="comment"># 用于生成[-1，1）范围内均分分布的随机数</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">_new_trial</span>(<span class="params">self</span>): <span class="comment"># 实现父类TrialEnv中的_new_trial和_step方法</span></span><br><span class="line">    ob = self.next_ob</span><br><span class="line">    self.next_ob = np.random.uniform(-<span class="number">1</span>, <span class="number">1</span>, size=(<span class="number">1</span>,))</span><br><span class="line">    trial = <span class="built_in">dict</span>()</span><br><span class="line">    trial[<span class="string">&#x27;ground_truth&#x27;</span>] = (ob &gt; <span class="number">0</span>) * <span class="number">1.0</span></span><br><span class="line">    <span class="keyword">return</span> trial</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">_step</span>(<span class="params">self, action</span>):</span><br><span class="line">    ob = self.next_ob</span><br><span class="line">    reward = (action == self.trial[<span class="string">&#x27;ground_truth&#x27;</span>]) * <span class="number">1.0</span></span><br><span class="line">    </span><br><span class="line">    done = <span class="literal">False</span></span><br><span class="line">    info = &#123;<span class="string">&#x27;new_trial&#x27;</span>: <span class="literal">True</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> ob, reward, done, info</span><br><span class="line"></span><br><span class="line">env = MyTrialEnv()</span><br><span class="line">ob = env.reset()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Trial&#x27;</span>, <span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Observation&#x27;</span>, ob)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">  action = env.action_space.sample()</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Action&#x27;</span>, action)</span><br><span class="line">  ob, reward, done, info = env.step(action)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Reward&#x27;</span>, reward)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Trial&#x27;</span>, i+<span class="number">1</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Observation&#x27;</span>, ob)</span><br><span class="line">  Trial <span class="number">0</span></span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line"><span class="comment"># Observation [0.37521716]</span></span><br><span class="line"><span class="comment"># Action 1</span></span><br><span class="line"><span class="comment"># Reward [1.]</span></span><br><span class="line"><span class="comment"># Trial 1</span></span><br><span class="line"><span class="comment"># Observation [0.88569181]</span></span><br><span class="line"><span class="comment"># Action 1</span></span><br><span class="line"><span class="comment"># Reward [1.] ···</span></span><br></pre></td></tr></table></figure><p><code>TrialEnv</code>类定义了两个抽象方法：<code>_new_trial()</code>和<code>_step()</code>。这两个方法没有具体的实现，只有方法的声明和文档字符串。这样做的目的是强制任何继承<code>TrialEnv</code>的子类必须实现这两个方法，以便成为一个完整的环境。</p><p>环境<code>reset</code>时会调用<code>new_trial()</code>方法，<code>step</code>之后也会调用<code>new_trial()</code>方法，只不过这些是在父类中实现的，我们创建环境时只需要把<code>_new_trial()</code>方法实现即可。</p><p>具体可见neurogym目录下的<code>core.py</code>文件。</p><h1 id="在基于试次的任务中包含时间，阶段和观测"><a href="#在基于试次的任务中包含时间，阶段和观测" class="headerlink" title="在基于试次的任务中包含时间，阶段和观测"></a>在基于试次的任务中包含时间，阶段和观测</h1><p>许多神经科学和认知科学任务遵循额外的时间结构，这些结构被包含进<code>neurogym.TrialEnv</code>。这些任务通常</p><ol><li>描述为实际时间而不是离散时间步。例如，任务可以持续3s</li><li>每个试次包含许多时间阶段，比如刺激阶段和响应阶段。</li></ol><p>为了包含这些特征，neurogym任务通常支持设置每一步的时间长度<code>dt</code>（单位为ms），以及每个时间阶段的时间长度<code>timing</code>。</p><p>例如，考虑下面的二元决策任务，有500ms的刺激阶段，跟着500ms的决策阶段。可以通过<code>self._new_trial()</code>中的<code>self.add_period()</code>在每个试次中添加阶段。在<code>_step()</code>中，你可以通过<code>self.in_period(period_name)</code>检查任务当前所处的阶段。</p><div class="note warning flat"><p>关于这段代码，我真的向多说几句：官方文档给的这段示例代码有点问题，按它原本的写法，stimulus阶段不应该获得奖励，但是奖励却为1。我调试了很久，总觉得observation、action和reward之间错位了，但看代码又找不出具体问题。今天上午终于发现了，在<code>env.reset()</code>时stimulus阶段就开始了，等进入循环时时间步已经走了一步了，但是此时仍用初始的观测执行<code>env.step(action)</code>，就会造成reward不匹配。所以采取的修改方式是删掉循环外存储的<code>ob</code>，直接从第二个时间步开始，这样就不会错位了。</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> neurogym <span class="keyword">as</span> ngym</span><br><span class="line"><span class="keyword">import</span> gym</span><br><span class="line"><span class="keyword">from</span> neurogym <span class="keyword">import</span> TrialEnv</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>] = <span class="string">&#x27;DejaVu Sans&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyDecisionEnv</span>(<span class="title class_ inherited__">TrialEnv</span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, dt=<span class="number">100</span>, timing=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="built_in">super</span>().__init__(dt=dt)</span><br><span class="line">    self.timing = &#123;<span class="string">&#x27;stimulus&#x27;</span>:<span class="number">500</span>, <span class="string">&#x27;decision&#x27;</span>:<span class="number">500</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> timing:</span><br><span class="line">      self.timing.update(timing)</span><br><span class="line">    self.observation_space = gym.spaces.Box(-<span class="number">1.</span>, <span class="number">1.</span>, (<span class="number">1</span>,))</span><br><span class="line">    self.action_space = gym.spaces.Discrete(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">_new_trial</span>(<span class="params">self</span>):</span><br><span class="line">    periods = [<span class="string">&#x27;stimulus&#x27;</span>, <span class="string">&#x27;decision&#x27;</span>]</span><br><span class="line">    self.add_period(periods)</span><br><span class="line"></span><br><span class="line">    stimulus = np.random.uniform(-<span class="number">1</span>, <span class="number">1</span>, (<span class="number">1</span>,))</span><br><span class="line">    trial = <span class="built_in">dict</span>()</span><br><span class="line">    trial[<span class="string">&#x27;stimulus&#x27;</span>] = stimulus</span><br><span class="line">    trial[<span class="string">&#x27;ground_truth&#x27;</span>] = (stimulus &gt; <span class="number">0</span>) * <span class="number">1.0</span></span><br><span class="line">    trial[<span class="string">&#x27;new_trial&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> trial</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">_step</span>(<span class="params">self, action</span>):</span><br><span class="line">    <span class="keyword">if</span> self.in_period(<span class="string">&#x27;stimulus&#x27;</span>):</span><br><span class="line">      ob = np.array([self.trial[<span class="string">&#x27;stimulus&#x27;</span>]])</span><br><span class="line">      reward = <span class="number">0.</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      ob = np.array([<span class="number">0.</span>])</span><br><span class="line">      reward = (action==self.trial[<span class="string">&#x27;ground_truth&#x27;</span>])*<span class="number">1.0</span></span><br><span class="line">   </span><br><span class="line">    done = <span class="literal">False</span></span><br><span class="line">    info = &#123;<span class="string">&#x27;new_trial&#x27;</span>: <span class="literal">False</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> ob, reward, done, info</span><br><span class="line"></span><br><span class="line">log = &#123;<span class="string">&#x27;ob&#x27;</span>:[], <span class="string">&#x27;action&#x27;</span>:[], <span class="string">&#x27;reward&#x27;</span>:[]&#125;</span><br><span class="line">env = MyDecisionEnv(dt=<span class="number">100</span>)</span><br><span class="line">ob = env.reset()</span><br><span class="line"></span><br><span class="line"><span class="comment"># log[&#x27;ob&#x27;].append(ob)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">  action = env.action_space.sample()</span><br><span class="line">  log[<span class="string">&#x27;action&#x27;</span>].append(action)</span><br><span class="line">  ob, reward, done, info = env.step(action)</span><br><span class="line">  log[<span class="string">&#x27;reward&#x27;</span>].append(reward)</span><br><span class="line">  log[<span class="string">&#x27;ob&#x27;</span>].append(ob)</span><br><span class="line"></span><br><span class="line">log[<span class="string">&#x27;ob&#x27;</span>] = log[<span class="string">&#x27;ob&#x27;</span>][:-<span class="number">1</span>]</span><br><span class="line">f, axes = plt.subplots(<span class="number">3</span>, <span class="number">1</span>, sharex=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> ax, key <span class="keyword">in</span> <span class="built_in">zip</span>(axes, [<span class="string">&#x27;ob&#x27;</span>, <span class="string">&#x27;action&#x27;</span>, <span class="string">&#x27;reward&#x27;</span>]):</span><br><span class="line">  ax.plot(log[key], <span class="string">&#x27;o-&#x27;</span>)</span><br><span class="line">  ax.set_ylabel(key)</span><br></pre></td></tr></table></figure><p><img src="https://img.cwxhmk.top/post/20230721-1.png" alt="运行结果"></p><h1 id="在每个试次的开始设置观测和真实值"><a href="#在每个试次的开始设置观测和真实值" class="headerlink" title="在每个试次的开始设置观测和真实值"></a>在每个试次的开始设置观测和真实值</h1><p>在许多任务中，每个试次的观测和真实值是提前确定的，可以在<code>self._new_trial()</code>中设置。生成的观测和真实值可以用作监督学习的输入和目标。</p><p>观测和真实值可以在<code>self._new_trial()</code>中通过<code>self.add_ob()</code>和<code>self.set_groundtruth()</code>方法设置。用户可以用它们的名字指明观测的阶段和位置。比如，<code>self.add_ob(1, period=&#39;stimulus&#39;, where=&#39;fixation&#39;)</code>。</p><p>允许用户通过<code>self.ob</code>和<code>self.gt</code>访问整个试次的观测和真实值，并通过<code>self.ob_now</code>和<code>self.gt_now</code>访问它们的值。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> neurogym <span class="keyword">as</span> ngym</span><br><span class="line"><span class="keyword">import</span> gym</span><br><span class="line"><span class="keyword">from</span> neurogym <span class="keyword">import</span> TrialEnv</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>] = <span class="string">&#x27;DejaVu Sans&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyDecisionEnv</span>(<span class="title class_ inherited__">TrialEnv</span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, dt=<span class="number">100</span>, timing=<span class="literal">None</span></span>): </span><br><span class="line">    <span class="comment"># 初始化，关键是设置观测空间和动作空间</span></span><br><span class="line">    <span class="built_in">super</span>().__init__(dt=dt)</span><br><span class="line">    self.timing = &#123;<span class="string">&#x27;stimulus&#x27;</span>:<span class="number">500</span>, <span class="string">&#x27;decision&#x27;</span>:<span class="number">500</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> timing:</span><br><span class="line">      self.timing.update(timing)</span><br><span class="line">    </span><br><span class="line">    name = &#123;<span class="string">&#x27;fixation&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;stimulus&#x27;</span>: <span class="number">1</span>&#125;</span><br><span class="line">    self.observation_space = ngym.spaces.Box(low=-<span class="number">1</span>, high=<span class="number">1</span>, shape=(<span class="number">2</span>,), name=name) <span class="comment"># 可以给每个维度命名</span></span><br><span class="line">    name = &#123;<span class="string">&#x27;fixation&#x27;</span>:<span class="number">0</span>, <span class="string">&#x27;choice&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>]&#125;</span><br><span class="line">    self.action_space = ngym.spaces.Discrete(<span class="number">3</span>, name=name)</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">_new_trial</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="comment"># 返回试次相关信息：阶段，刺激，真实值等</span></span><br><span class="line">    periods = [<span class="string">&#x27;stimulus&#x27;</span>, <span class="string">&#x27;decision&#x27;</span>]</span><br><span class="line">    self.add_period(periods)</span><br><span class="line">    stimulus = np.random.uniform(-<span class="number">1</span>, <span class="number">1</span>, (<span class="number">1</span>,))</span><br><span class="line">    self.add_ob(<span class="number">1</span>, period=<span class="string">&quot;stimulus&quot;</span>, where=<span class="string">&quot;fixation&quot;</span>)</span><br><span class="line">    self.add_ob(stimulus, period=<span class="string">&quot;stimulus&quot;</span>, where=<span class="string">&quot;stimulus&quot;</span>)</span><br><span class="line">    <span class="comment"># where对应的是维度名</span></span><br><span class="line">    ground_truth = <span class="built_in">int</span>(stimulus &gt; <span class="number">0</span>)</span><br><span class="line">    self.set_groundtruth(ground_truth, period=<span class="string">&quot;decision&quot;</span>, where=<span class="string">&quot;choice&quot;</span>)</span><br><span class="line"></span><br><span class="line">    trial = <span class="built_in">dict</span>()</span><br><span class="line">    trial[<span class="string">&#x27;stimulus&#x27;</span>] = stimulus</span><br><span class="line">    trial[<span class="string">&#x27;ground_truth&#x27;</span>] = ground_truth</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> trial</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">_step</span>(<span class="params">self, action</span>):</span><br><span class="line">    <span class="comment"># 执行动作，返回观测，奖励等信息</span></span><br><span class="line">    reward = (action==self.gt_now) * <span class="number">1.0</span></span><br><span class="line">    done = <span class="literal">False</span> <span class="comment"># 环境是否需要重置</span></span><br><span class="line">    info = &#123;<span class="string">&#x27;new_trial&#x27;</span>: <span class="literal">False</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> self.ob_now, reward, done, info</span><br><span class="line">env = MyDecisionEnv()</span><br><span class="line">_ = env.reset()</span><br><span class="line"></span><br><span class="line">trial = env.new_trial()</span><br><span class="line">ob, gt = env.ob, env.gt</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(trial)</span><br><span class="line"><span class="built_in">print</span>(ob)</span><br><span class="line"><span class="built_in">print</span>(gt)</span><br><span class="line">fig = ngym.utils.plot_env(env, num_trials=<span class="number">2</span>)</span><br></pre></td></tr></table></figure><h1 id="补充知识"><a href="#补充知识" class="headerlink" title="补充知识"></a>补充知识</h1><ol><li><strong>self：</strong> 在Python中，当定义一个类方法时，第一个参数通常被称为<code>self</code>，它代表类的实例对象，允许在类的方法中访问对象的属性和其他方法。</li><li><strong>super().<strong>init</strong>()：</strong> 在面向对象编程中，当创建一个子类时，通常需要继承父类的属性和方法，可以使用<code>super().__init__()</code>来调用父类的构造方法，确保父类的初始化代码得以执行。当<code>super().__init__()</code>不带参数时，它会调用父类的构造方法，并将子类的实例作为第一个参数传递给父类的构造方法。</li><li><strong>继承：</strong> 在面向对象编程中，继承是一种重要的概念，它允许你创建一个新的类（子类），从一个现有的类（父类）继承属性和方法。子类可以访问父类的属性和方法，并且还可以添加自己的属性和方法。如<code>class Child(Parent):</code> 这样的语法表示子类 Child 继承了父类 Parent。</li><li><strong>时间步（time step）：</strong> 在计算机科学和数学中，时间步长通常用于描述在离散时间模型中的时间间隔。理解时间步长的关键是认识到许多模型和系统在仿真或模拟时需要将时间划分成离散的部分，而时间步长就是这个离散化的单位。在每个时间步长内，系统的状态会被更新，从而使得系统在连续时间范围内的变化可以通过离散时间步长来近似。</li><li><strong>抽象方法：</strong> 抽象方法是指在父类中声明但没有具体实现的方法，它只有方法名、参数列表和文档字符串，没有具体的代码实现。子类继承这个父类时，必须实现这些抽象方法，否则子类也会被视为抽象类，无法实例化。</li></ol><h1 id="参考内容"><a href="#参考内容" class="headerlink" title="参考内容"></a>参考内容</h1><ul><li><a href="https://neurogym.github.io/index.html">neurogym’s documentation!</a></li><li><a href="https://www.gymlibrary.dev/content/basic_usage/">Gym Documentation</a></li><li><a href="https://gymnasium.farama.org/content/basic_usage/">Gymnasium Documentation</a></li><li><a href="https://zhuanlan.zhihu.com/p/89549054">接口与抽象基类</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>二维脑片配准插件开发</title>
      <link href="/2023/07/16/imagej-plugin-8/"/>
      <url>/2023/07/16/imagej-plugin-8/</url>
      
        <content type="html"><![CDATA[<h1 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h1><ol><li><p>在Eclipse中配置Maven环境 Window → Preferences → Maven → Installations → Add → 找到Maven安装路径</p></li><li><p>创建Maven项目 File → New → Other → Maven Project → Create a simple project</p></li><li><p>编写组件并合理布局（FlowLayout和BoxLayout结合）</p><img src="https://img.cwxhmk.top/post/20230717-1.png" alt="界面展示" width="50%" height="50%" /> </li><li><p>编写<mark class="hl-label pink">选择按钮</mark> 和<mark class="hl-label pink">确认按钮</mark> 的触发事件</p></li><li><p>编写<mark class="hl-label pink">降采样按钮</mark> 、<mark class="hl-label pink">配准</mark> 、<mark class="hl-label pink">合并通道</mark> 和<mark class="hl-label pink">保存</mark> 的触发事件</p></li><li><p>整理目录结构：<code>input</code>文件夹存放原始脑片，<code>output</code>文件夹存放配准合并完成的图片，<code>params</code>文件夹存放配准参数，<code>registration</code>文件夹存放中间处理过程得到的图片以及配准文件<br><img src="https://img.cwxhmk.top/post/20230719-3.png" alt="目录结构"></p></li><li><p><code>Run as Maven build</code>生成jar包</p></li></ol><h1 id="效果展示"><a href="#效果展示" class="headerlink" title="效果展示"></a>效果展示</h1><p><img src="https://img.cwxhmk.top/gif/7caa0525-2d17-4fd1-b3a8-c63d54d0b051.gif" alt="效果展示"></p><h1 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h1><ol><li>为什么编写了按钮的触发事件后，运行程序时点击按钮没有反应？<br><strong>答：</strong>需要调用event()函数！</li><li>想获取tempImage.tif中某一张图片，但是总报错说out of range<br><strong>答：</strong>不能在使用<code>tempStack.getProcessor(tempIndex)</code>之前使用<code>tempImage.close()</code>，但手动关闭是不影响的。</li><li>Java中string转int<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">tempIndex</span> <span class="operator">=</span> Integer.valueOf(tempNum.getText());</span><br></pre></td></tr></table></figure></li><li>运行命令行输出的内容如何动态打印到JTextArea<div class="note info flat"><ol start="5"><li>如何获取<code>resources</code>下的文件？<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.getClass().getClassLoader().getResource(<span class="string">&quot;tempImage.tif&quot;</span>).getPath()</span><br></pre></td></tr></table></figure><strong>ChatGPT:</strong><br>当你在执行命令行时，使用Runtime.getRuntime().exec()方法或ProcessBuilder类的start()方法会创建一个新的进程来运行命令。这个新的进程与你的Java程序是独立的，它在操作系统中运行，并与你的Java程序并行执行。这意味着在主线程中执行命令行时，主线程将会被阻塞（即暂停执行），直到命令行执行完毕。</li></ol><p>如果命令行的输出量较大，或者命令行执行时间较长，主线程被阻塞的时间会很长，可能导致你的界面无响应，因为界面的更新和事件处理通常也是在主线程中进行的。</p><p>通过创建一个新的线程来执行命令行，我们实现了并发执行。这意味着在主线程中调用registration()方法时，新线程会被启动，然后在新线程中执行命令行，而主线程会继续执行接下来的代码，保持界面的响应。这样，即使命令行执行时间很长，主线程也不会被阻塞，界面仍然可以响应用户的交互。</p><p>在新线程中，我们使用BufferedReader来读取命令行的输出流，并实时将输出内容追加到JTextArea中，通过调用pluginMain.logMessage.repaint()来强制刷新文本区域，使得输出内容在JTextArea中动态显示。</p><p>使用新线程来执行耗时操作，如命令行执行、网络请求等，是一种常见的做法，它能够有效地保持界面的响应性，提升用户体验。在Java中，你可以通过创建Thread对象，或者使用ExecutorService等高级并发工具来管理线程的执行。</p></div></li><li>调用transform方法时，JTextArea中的内容为什么没有更新<div class="note info flat"><p><strong>ChatGPT:</strong><br>根据你提供的Registration类中的registration()和transform()方法，我注意到在调用transform()方法之前，你通过创建线程来执行了elastix命令。在这种情况下，可能出现elastix命令尚未执行完成，就开始执行transform()方法。</p><p>由于两个命令都是通过独立的线程执行的，所以在elastix命令执行期间，可能会同时执行transform()方法。因此，你可能会看到命令输出结果交错显示，甚至transform()方法的输出可能会被elastix命令的输出覆盖。</p><p>为了确保elastix命令执行完毕后再执行transform()方法，你可以在registration()方法中等待elastix命令执行完成后再调用transform()方法。可以使用Process对象的waitFor()方法，该方法会阻塞当前线程，直到命令执行完成。</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registration</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">elastixUrl</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/elastix&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">brainUrl</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/registration/resizedImage.tif&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">regisTempUrl</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/registration/regisTemp.tif&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> elastixUrl + <span class="string">&quot; -f &quot;</span> + brainUrl + <span class="string">&quot; -m &quot;</span> + regisTempUrl + <span class="string">&quot; -out &quot;</span> + output_1 + <span class="string">&quot; -p &quot;</span> + GlobalPath+<span class="string">&quot;params/para-Standard_bspline.txt&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Process</span> <span class="variable">ps</span> <span class="operator">=</span> Runtime.getRuntime().exec(cmd);</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(ps.getInputStream()));</span><br><span class="line">            String line;</span><br><span class="line">            <span class="keyword">while</span> ((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                pluginMain.logMessage.append(line + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                pluginMain.logMessage.setCaretPosition(pluginMain.logMessage.getDocument().getLength()); <span class="comment">// 滚动到文本末尾</span></span><br><span class="line">                pluginMain.logMessage.repaint(); <span class="comment">// 强制刷新文本区域</span></span><br><span class="line">            &#125;</span><br><span class="line">            ps.waitFor(); <span class="comment">// 等待命令执行完成</span></span><br><span class="line">            transform(); <span class="comment">// 在elastix命令执行完成后调用transform()方法</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>如何确定配准全部完成后再执行接下来的程序？<div class="note info flat"><p><strong>ChatGPT:</strong><br>当我们在Java中定义一个接口，实际上是在创建一种契约，定义了一组方法的签名，而不包含方法的实现。其他类可以实现这个接口并提供实际的方法实现，从而达到对某种功能或行为的规范和约束。在这里，我们要使用接口来实现回调机制，回调机制是一种异步通信的方式，允许一个对象在特定事件发生时通知另一个对象执行特定的操作。</p><p>首先，我们定义一个接口RegistrationCallback，其中包含方法：onTransformCompleted()。</p><p>这个接口中并没有实现任何方法，只是规定了这两个方法的签名。现在我们将在Registration类中使用这个接口。在Registration类中添加一个私有成员变量callback，用于保存实现了RegistrationCallback接口的对象。</p><p>在registration()方法中，我们可以接收一个实现了RegistrationCallback接口的对象，并将它保存在callback变量中。</p><p>在transform()方法中的合适时机调用回调方法。在onTransformFinished()方法中，我们会首先检查callback是否为null，如果不为null，则调用回调对象的对应方法。</p><p>现在，当我们在pluginMain类的registrationBtn监听器中调用Registration类的registration()方法时，我们可以传递一个实现了RegistrationCallback接口的对象。这样，在配准和转换完成后，Registration类会调用回调方法，并在回调方法中执行相应的操作。</p><p>这样可以确保在配准和转换都完成后再执行相关操作。</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新建一个接口RegistrationCallback.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RegistrationCallback</span> &#123;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">onTransformCompleted</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Registration.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Registration</span> &#123;</span><br><span class="line"><span class="keyword">private</span> RegistrationCallback callback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">String</span> <span class="variable">GlobalPath</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> String output_1= <span class="string">&quot;D:/Desktop/brainPro/registration/temp1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registration</span><span class="params">(RegistrationCallback callback)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.callback = callback;</span><br><span class="line"><span class="type">String</span> <span class="variable">elastixUrl</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/elastix&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">brainUrl</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/registration/resizedImage.tif&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">regisTempUrl</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/registration/regisTemp.tif&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> elastixUrl + <span class="string">&quot; -f &quot;</span> + brainUrl + <span class="string">&quot; -m &quot;</span> + regisTempUrl + <span class="string">&quot; -out &quot;</span> + output_1 + <span class="string">&quot; -p &quot;</span> + GlobalPath+<span class="string">&quot;params/para-Standard_bspline.txt&quot;</span>;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Process</span> <span class="variable">ps</span> <span class="operator">=</span> Runtime.getRuntime().exec(cmd);</span><br><span class="line">                <span class="comment">// ps.getInputStream() 获取进程的输出流</span></span><br><span class="line">                <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(ps.getInputStream()));</span><br><span class="line">                String line;</span><br><span class="line">                <span class="keyword">while</span> ((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                    pluginMain.logMessage.append(line + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                    pluginMain.logMessage.setCaretPosition(pluginMain.logMessage.getDocument().getLength()); <span class="comment">// 滚动到文本末尾</span></span><br><span class="line">                    pluginMain.logMessage.repaint(); <span class="comment">// 强制刷新文本区域</span></span><br><span class="line">                &#125;</span><br><span class="line">                ps.waitFor();</span><br><span class="line">                transform();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">transformixUrl</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/transformix&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">outputDir</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/registration/temp2&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">regisAnnoUrl</span> <span class="operator">=</span> <span class="string">&quot;D:/Desktop/brainPro/registration/regisAnno.tif&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> transformixUrl + <span class="string">&quot; -in &quot;</span> + regisAnnoUrl + <span class="string">&quot; -out &quot;</span> + outputDir + <span class="string">&quot; -tp &quot;</span> + output_1 + <span class="string">&quot;/TransformParameters.0.txt&quot;</span>;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Process</span> <span class="variable">ps</span> <span class="operator">=</span> Runtime.getRuntime().exec(cmd);</span><br><span class="line">                <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(ps.getInputStream()));</span><br><span class="line">                String line;</span><br><span class="line">                <span class="keyword">while</span> ((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                    pluginMain.logMessage.append(line + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                    pluginMain.logMessage.setCaretPosition(pluginMain.logMessage.getDocument().getLength()); <span class="comment">// 滚动到文本末尾</span></span><br><span class="line">                    pluginMain.logMessage.repaint(); <span class="comment">// 强制刷新文本区域</span></span><br><span class="line">                &#125;</span><br><span class="line">                ps.waitFor();</span><br><span class="line">                onTransformFinished();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">onTransformFinished</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (callback != <span class="literal">null</span>) &#123;</span><br><span class="line">            callback.onTransformCompleted();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// pluginMain.java</span></span><br><span class="line">registrationBtn.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Registration</span>().registration(<span class="keyword">new</span> <span class="title class_">RegistrationCallback</span>() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onTransformCompleted</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">                regisAnno = <span class="keyword">new</span> <span class="title class_">ImagePlus</span>(<span class="string">&quot;D:/Desktop/brainPro/registration/temp2/result.tif&quot;</span>);</span><br><span class="line">                logMessage.append(<span class="string">&quot;4. 配准已完成&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://blog.csdn.net/weixin_43853855/article/details/117073100">maven环境的搭建+eclipse中配置Maven(详细)</a></li><li><a href="https://blog.csdn.net/weixin_41287260/article/details/94317629">Java的AWT控件Button内容乱码的处理方案</a></li><li><a href="https://blog.csdn.net/sweetgirl520/article/details/51346076">java Swing布局管理之BoxLayout布局</a></li><li><a href="https://blog.csdn.net/paullinjie/article/details/51727753">JPanel左对齐</a></li><li><a href="https://blog.csdn.net/m0_46428066/article/details/115073560">eclipse中在pom.xml添加依赖</a></li><li><a href="https://blog.csdn.net/liang5630/article/details/25651491">JFileChooser (Java Swing提供的文件选择对话框)</a></li><li><a href="https://www.cnblogs.com/jone-chen/p/14270358.html">Java整数间的除法运算那点事</a></li><li><a href="https://blog.csdn.net/One_castle/article/details/100177788">java中如何将String类型转化为double类型</a></li><li><a href="https://blog.csdn.net/qq_35573326/article/details/79974366">Java除法运算（保留小数）</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Eclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>认识你自己</title>
      <link href="/2023/07/16/life-review/"/>
      <url>/2023/07/16/life-review/</url>
      
        <content type="html"><![CDATA[<p>不知道是从什么时候开始，我变了。刚入学那会我多么希望可以有个朋友和我一起上课、吃饭、坐校车啊，那种一个人走在路上突然冒出来的孤独感，我已经很久没有感受到了。我的内心愈发平静，我的喜好愈发明确，我似乎看见了一个更清晰的自我。</p><p>说实话，我对自己之前的学习习惯不是很满意，知识不成体系，记笔记零零散散，记忆随着时间的推移渐渐消退，我却好像什么也没留下，总有一种学了但没学扎实的感觉。这个习惯被我带到了新学校，每天八点半来到实验室，一整天的时间点开了各种网页，检索了各种知识，看过了但不清楚自己是否记住了，下次遇到问题又是同样的搜索路径。我分析数据、写应用程序，却总觉得这种东拼西凑的知识来得不踏实。</p><p>大约是两周前我开始尝试写博客记录每天的学习内容，不是在一天结束的时候写，而是从早上来到工位开始，每日计划、优质博客、学习进展、方法教程等，什么都可以写，总之就是每天结束时要有所收获。和之前全是随笔的博客相比，工作日写下的博客可以说是干货满满。如果我是做一个小项目或是翻译教材，会在博客标题中标上序号，这个小细节在无形之中转化为我坚持的动力。</p><p>我原本就喜欢写博客，但一般把写博客安排在周末，但周末有时又有别的事情，所以总是断断续续的写。现在把自己喜欢的事情融入到每天的学习中，我的情绪变得更稳定，做事更有底气，效率也更高了。最近这几天不到九点回到宿舍，竟觉得待在宿舍好无聊，明明再有两个小时就要睡觉了，可我却觉得非常难熬，刷短视频没意思，对电视剧、电影或者综艺节目没有任何兴趣，有时躺在床上还会怀念白天的工作时光，真怪。</p><p>之前我总想着早早下班，周末坚决不来实验室，但现在我觉得我想在实验室多学一会，周末在宿舍也没事干不如来实验室，我知道我不是在做给老板看，也不是在为他学，我是为我自己的成长和进步付出时间和精力。</p><p>最近还有一个神奇的变化，我现在晚上十一点基本上倒头就睡，早上六点会自然醒，虽然我现在还是会再睡到闹钟响起，但我还是为这个小小的变化感到惊喜。今天早上买了几本字帖，打算以后六点醒来洗漱完练会字，这是我能想到的相对不打扰舍友又能充分利用清晨时间的一种方式，我想变得更好。</p><p>我很享受现在的生活，自我与工作近乎达到平衡状态，我没有因为忙碌的工作丢掉自我，而是将主动权掌握在自己手中，努力借助更优质的平台实现能力跃迁。</p>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Imairs细胞计数教程</title>
      <link href="/2023/07/14/imaris-cell-counting/"/>
      <url>/2023/07/14/imaris-cell-counting/</url>
      
        <content type="html"><![CDATA[<h1 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h1><ol><li>将<code>fuseImage</code>导入<code>Imaris</code></li><li><code>Ctrl+D</code>打开通道面板</li><li>点击<code>Slice</code>测量细胞的直径（取个平均值即可）</li><li>点击<code>Add new Spots</code>（图标为一团黄色的小球） → 点击▶️ → 选择source channel（此处为红色） → 填写直径（此处为1.5µm）→ 点击▶️ → 根据实际情况调整阈值 → 点击绿色箭头 → 点击折线图即可看到整张脑片的细胞计数情况</li><li>点击<code>Add new Surfaces</code>(图标为蓝色的椭球)  → 点击<code>Skip automatic creation, edit manually</code> → 界面右侧改为<code>Select</code> → 左下角<code>Draw</code> → 沿着要统计的脑区轮廓绘制闭合曲线 → 点击<code>Create Surface</code> → 点击<code>Edit</code>（图标为一支铅笔✏）选择<code>Mask Selection</code> → 保持勾选<code>Duplicate channel before applying mask</code> → 点击<code>OK</code>之后可以在右侧通道处看到新增的通道（Channel 4）  → 取消左侧界面<code>Surfaces</code>的勾选，右侧通道仅保留刚刚复制的通道，其余通道取消勾选 → 接下来对该区域进行细胞计数</li><li>点击<code>Add new Spots</code>（图标为一团黄色的小球） → 点击▶️ → 选择source channel（此处注意改为Channel 4） → 填写直径（此处为1.5µm）→ 点击▶️ → 根据实际情况调整阈值 → 点击绿色箭头 → 点击折线图即可看到特定脑区的细胞计数情况</li></ol><h1 id="操作演示"><a href="#操作演示" class="headerlink" title="操作演示"></a>操作演示</h1><iframe src="https://img.cwxhmk.top/gif/1689321542547-1.mp4" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"  width="800px" height="470px"> </iframe><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://zhuanlan.zhihu.com/p/66408698">手把手教你用软件便捷地统计染色图中不同区域的数据</a></li><li><a href="https://www.freeconvert.com/">免费的视频压缩网站</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Imaris </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BIRDS插件代码学习【07】</title>
      <link href="/2023/07/14/imagej-plugin-7/"/>
      <url>/2023/07/14/imagej-plugin-7/</url>
      
        <content type="html"><![CDATA[<h1 id="图像降采样"><a href="#图像降采样" class="headerlink" title="图像降采样"></a>图像降采样</h1><div class="note info flat"><p>原始脑片分辨率过高，与Allen平均脑模板的分辨率相差过大，为得到更好的配准效果，需要将原始脑片的分辨率降低。<br>😎我原本是在ImageJ软件上操作的，没想到用代码实现也并不复杂！</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> I.plugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ij.ImagePlus;</span><br><span class="line"><span class="keyword">import</span> ij.gui.NewImage;</span><br><span class="line"><span class="keyword">import</span> ij.io.FileSaver;</span><br><span class="line"><span class="keyword">import</span> ij.process.ImageProcessor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test07</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">ImagePlus</span> <span class="variable">brainImage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ImagePlus</span>(<span class="string">&quot;D:/Desktop/elastix-5.1.0-win64/input/result1.tif&quot;</span>);</span><br><span class="line"><span class="type">ImageProcessor</span> <span class="variable">bp</span> <span class="operator">=</span> brainImage.getProcessor();</span><br><span class="line"><span class="type">int</span> <span class="variable">width</span> <span class="operator">=</span> bp.getWidth();</span><br><span class="line"><span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> bp.getHeight();</span><br><span class="line">brainImage.show();</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> <span class="variable">scale</span> <span class="operator">=</span> <span class="number">0.1</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">newWidth</span> <span class="operator">=</span> (<span class="type">int</span>)(width*scale);</span><br><span class="line"><span class="type">int</span> <span class="variable">newHeight</span> <span class="operator">=</span> (<span class="type">int</span>)(height*scale);</span><br><span class="line"><span class="type">ImagePlus</span> <span class="variable">resizedImage</span> <span class="operator">=</span> NewImage.createByteImage(<span class="string">&quot;resizedImage&quot;</span>, newWidth, newHeight, <span class="number">0</span>, NewImage.FILL_BLACK);</span><br><span class="line"><span class="type">ImageProcessor</span> <span class="variable">rp</span> <span class="operator">=</span> resizedImage.getProcessor();</span><br><span class="line"></span><br><span class="line">rp = bp.resize(newWidth, newHeight, <span class="literal">false</span>);</span><br><span class="line">resizedImage.setProcessor(rp);</span><br><span class="line">resizedImage.show();</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">FileSaver</span>(resizedImage).saveAsTiff(<span class="string">&quot;D:/Desktop/elastix-5.1.0-win64/input/resized-result1.tif&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="脑区识别"><a href="#脑区识别" class="headerlink" title="脑区识别"></a>脑区识别</h1><div class="note info flat"><p>代码效果：鼠标移动到图片的哪个位置，就在Eclipse控制台输出对应的脑区，超出全脑范围则输出null。</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> I.plugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.Point;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseListener;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseMotionListener;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ij.ImagePlus;</span><br><span class="line"><span class="keyword">import</span> ij.ImageStack;</span><br><span class="line"><span class="keyword">import</span> ij.gui.NewImage;</span><br><span class="line"><span class="keyword">import</span> ij.io.FileSaver;</span><br><span class="line"><span class="keyword">import</span> ij.plugin.RGBStackMerge;</span><br><span class="line"><span class="keyword">import</span> ij.process.ImageProcessor;</span><br><span class="line"><span class="keyword">import</span> jxl.Cell;</span><br><span class="line"><span class="keyword">import</span> jxl.Sheet;</span><br><span class="line"><span class="keyword">import</span> jxl.Workbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test06</span> <span class="keyword">implements</span> <span class="title class_">MouseListener</span>, MouseMotionListener &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">ImagePlus</span> <span class="variable">fuseImage</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">ImagePlus</span> <span class="variable">brainImage</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">ImagePlus</span> <span class="variable">annoImage</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">public</span> Map&lt;Integer,String&gt; grayMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提取脑区轮廓</span></span><br><span class="line"><span class="keyword">public</span> ImageProcessor <span class="title function_">getLineImg</span><span class="params">(ImageProcessor ip, ImageProcessor op)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">lenX</span> <span class="operator">=</span> ip.getWidth();</span><br><span class="line"><span class="type">int</span> <span class="variable">lenY</span> <span class="operator">=</span> ip.getHeight();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; lenX; i ++) &#123; <span class="comment">//按列</span></span><br><span class="line"><span class="type">int</span> <span class="variable">begin</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">//初始像素值为黑色</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; lenY; j ++) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> (<span class="type">int</span>)ip.getPixelValue(i, j);</span><br><span class="line"><span class="keyword">if</span>(temp != begin) &#123;</span><br><span class="line">op.set(i, j, <span class="number">255</span>);</span><br><span class="line">begin = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; lenY; j ++) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">begin</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">//初始像素值为黑色</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; lenX; i ++) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> (<span class="type">int</span>)ip.getPixelValue(i, j);</span><br><span class="line"><span class="keyword">if</span>(temp != begin) &#123;</span><br><span class="line">op.set(i, j, <span class="number">255</span>);</span><br><span class="line">begin = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> op;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 监听鼠标 将excel中的灰度值-脑区读取到HashMap中</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addMouseListener</span><span class="params">()</span> <span class="keyword">throws</span> Exception, IOException &#123;</span><br><span class="line"><span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;D:/Desktop/rgb_name.xls&quot;</span>);</span><br><span class="line"><span class="type">Workbook</span> <span class="variable">wb</span> <span class="operator">=</span> Workbook.getWorkbook(file);</span><br><span class="line"><span class="type">Sheet</span> <span class="variable">sheet</span> <span class="operator">=</span> wb.getSheet(<span class="string">&quot;test1&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; sheet.getRows(); i ++) &#123;</span><br><span class="line">Cell[] cell = sheet.getRow(i);</span><br><span class="line">grayMap.put(Integer.valueOf(cell[<span class="number">0</span>].getContents()),cell[<span class="number">1</span>].getContents());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//System.out.println(grayMap);</span></span><br><span class="line">wb.close();</span><br><span class="line"></span><br><span class="line">fuseImage.show();</span><br><span class="line">fuseImage.getCanvas().addMouseListener(<span class="built_in">this</span>);</span><br><span class="line">fuseImage.getCanvas().addMouseMotionListener(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseClicked</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mousePressed</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseReleased</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseEntered</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseExited</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseDragged</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseMoved</span><span class="params">(MouseEvent e)</span> &#123;</span><br><span class="line"><span class="comment">// 监听鼠标的移动</span></span><br><span class="line"><span class="type">int</span> <span class="variable">currentSlice</span> <span class="operator">=</span> fuseImage.getCurrentSlice();</span><br><span class="line"><span class="type">Point</span> <span class="variable">point</span> <span class="operator">=</span> fuseImage.getCanvas().getCursorLoc();</span><br><span class="line"><span class="type">int</span> <span class="variable">val</span> <span class="operator">=</span> (<span class="type">int</span>)annoImage.getImageStack().getVoxel(point.x, point.y, currentSlice-<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(grayMap.get(val));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 主程序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, Exception &#123;</span><br><span class="line">brainImage = <span class="keyword">new</span> <span class="title class_">ImagePlus</span>(<span class="string">&quot;D:\\Desktop\\elastix-5.1.0-win64\\input\\result1-1.tif&quot;</span>);</span><br><span class="line"><span class="type">ImageStack</span> <span class="variable">brainStack</span> <span class="operator">=</span> brainImage.getStack();</span><br><span class="line"></span><br><span class="line">annoImage = <span class="keyword">new</span> <span class="title class_">ImagePlus</span>(<span class="string">&quot;D:\\Desktop\\elastix-5.1.0-win64\\result\\result.tif&quot;</span>);</span><br><span class="line"><span class="type">ImageProcessor</span> <span class="variable">ap</span> <span class="operator">=</span> annoImage.getProcessor();</span><br><span class="line"><span class="type">int</span> <span class="variable">width</span> <span class="operator">=</span> ap.getWidth();</span><br><span class="line"><span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> ap.getHeight();</span><br><span class="line"></span><br><span class="line"><span class="type">ImagePlus</span> <span class="variable">lineImage</span> <span class="operator">=</span> NewImage.createByteImage(<span class="string">&quot;lineImage&quot;</span>, width, height, <span class="number">0</span>, NewImage.FILL_BLACK);</span><br><span class="line"><span class="type">ImageStack</span> <span class="variable">lineStack</span> <span class="operator">=</span> lineImage.getStack();</span><br><span class="line"><span class="type">ImageProcessor</span> <span class="variable">lp</span> <span class="operator">=</span> lineImage.getProcessor();</span><br><span class="line"></span><br><span class="line"><span class="type">ImageProcessor</span> <span class="variable">op</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Test06</span>().getLineImg(ap, lp);</span><br><span class="line"></span><br><span class="line">lineImage.setProcessor(op);</span><br><span class="line">lineImage.show();</span><br><span class="line"> </span><br><span class="line">fuseImage = NewImage.createByteImage(<span class="string">&quot;fuseImage&quot;</span>, width, height, <span class="number">0</span>, NewImage.FILL_BLACK);</span><br><span class="line"></span><br><span class="line"><span class="type">ImageStack</span> <span class="variable">fuseStack</span> <span class="operator">=</span> RGBStackMerge.mergeStacks(brainStack, lineStack, <span class="literal">null</span>, <span class="literal">true</span>);</span><br><span class="line">fuseImage.setStack(fuseStack);</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">FileSaver</span>(fuseImage).saveAsTiff(<span class="string">&quot;D:/Desktop/fuseImage-1.tif&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Test06</span>().addMouseListener();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="操作演示"><a href="#操作演示" class="headerlink" title="操作演示"></a>操作演示</h1><p><img src="https://img.cwxhmk.top/gif/20230714-birds-test.gif" alt="操作演示"></p><h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><ol><li>Eclipse中导入jxl.jar包，具体方法可参考<a href="https://blog.csdn.net/qq_48455576/article/details/111871181">博客</a>，需要注意jxl.jar包只能处理.xls文件</li><li>脑片降低分辨率后统计出的各个脑区的细胞数目，需要与人工计数的结果进行对比，如果差别不大，则后续采用降低分辨率的脑片进行配准。</li><li>配准后的图像使用<code>Imaris</code>软件计数，具体操作步骤见文章<a href="https://chen.cwxhmk.top/2023/07/14/imaris-cell-counting/">Imairs细胞计数教程</a></li></ol><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://blog.csdn.net/qq_48455576/article/details/111871181">Java读取Excel表格中的数据</a></li><li><a href="https://blog.csdn.net/yincheng_917/article/details/82685492">Java键值对的使用</a></li><li><a href="https://www.aliyundrive.com/s/SErQkyqyvie">jxl.jar包下载地址</a></li><li><a href="https://beecut.cn/video-to-gif-online">视频转Gif在线工具</a></li><li><a href="https://zhuanlan.zhihu.com/p/66408698">手把手教你用软件便捷地统计染色图中不同区域的数据</a></li><li><a href="https://imaris.oxinst.com/learning/?businesses=bitplane">Imaris官方视频教程</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ImageJ </tag>
            
            <tag> Java </tag>
            
            <tag> Eclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《神经动力学》学习笔记【01】</title>
      <link href="/2023/07/13/neuronal-dynamics-1/"/>
      <url>/2023/07/13/neuronal-dynamics-1/</url>
      
        <content type="html"><![CDATA[<div class="note info flat"><p>课程地址：<a href="https://www.bilibili.com/video/BV1U4411Y77o">[进入哔哩哔哩观看 资源1]</a>  <a href="https://www.bilibili.com/video/BV1x7411Z715/">[进入哔哩哔哩观看 资源2]</a>  <a href="https://lcnwww.epfl.ch/gerstner/NeuronalDynamics-MOOCall.html">[进入youtube观看]</a><br>课件汇总：<a href="https://neuronaldynamics.epfl.ch/lectures.html">[PPT下载]</a><br>参考教材：Neuronal Dynamics: From Single Neurons to Networks and Models of Cognition<br><a href="https://www.aliyundrive.com/s/LxiP8SVFtZN">[下载地址]</a><br>提取码: <span class="hide-inline"><button type="button" class="hide-button" style="">点击查看<br>  </button><span class="hide-content">rk96</span></span></p></div><h1 id="神经动力学：从单个神经元到网络和认知模型"><a href="#神经动力学：从单个神经元到网络和认知模型" class="headerlink" title="神经动力学：从单个神经元到网络和认知模型"></a>神经动力学：从单个神经元到网络和认知模型</h1><p>当我们做决策时，我们的大脑中发生了什么？是什么触发了神经元发送信号？神经编码是什么？</p><p>这本面向高年级本科生和初级研究生的教科书，为计算和理论神经科学提供了全面而最新的的介绍。它涵盖了经典的主题，包括<code>Hodgkin-Huxley</code>方程和<code>Hopfield</code>模型，以及该领域在现代的发展，如广义线性模型和决策理论。概念通过清晰的逐步解释引入，适合仅有基础微分方程和概率知识的读者，并辅以丰富的图表和详细的实例说明。</p><p>章末总结和随堂练习使本书非常适合课堂教学或者自学。作者也指出了文献和大量的参考数目，对于有兴趣进一步研究的读者来说将非常有价值。</p><h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><div class="row">    <embed src="https://img.cwxhmk.top/pdf/catalog.pdf" width="100%" height="550" type="application/pdf"></div><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这本面向高年级本科生和初级研究生的教科书系统地介绍了关于神经建模、神经动力学、神经编码以及神经网络领域。它可以作为计算和理论神经科学的入门课程的教材，也可以作为研究生级别更加专注于神经动力学和神经建模的课程的主要教材。对于想学习不同神经元模型和神经活动描述之间关系的研究人员和学生来说，本书也是一个有用的资源。</p><p>所有的数学概念都以一步一步的方式进行介绍。所有的章节都有丰富的图表和实例。每一章都以简短的总结和一系列数学练习结尾。在作者的<a href="https://neuronaldynamics-exercises.readthedocs.io/en/latest/">网页</a>上提供了用于数值模拟的<code>python</code>源代码，以阐述章节的主要观点和模型。</p><p>本书分为4部分，共20章。<strong>Part I</strong>对计算神经科学及其数学工具的基础知识进行了概括性介绍。它涵盖了经典的内容，比如<code>Hodgkin-Huxley</code>模型、离子通道和树突等，以及二维微分方程系统的相平面分析。本书特别关注在<code>Hodgkin-Huxley</code>模型和<code>Morris-Lecar</code>模型等简化的二维神经元模型中触发动作电位的阈值问题。</p><p><strong>Part II</strong>着重介绍单个神经元动力学的简化模型。它涵盖了带有适应性和不带适应性的非线性积分-放电模型<code>integrate-and-fire model</code>，尤其是二次和指数的积分-放电模型，以及<code>Izhikevich</code>模型和自适应指数积分-发放模型。还讨论了神经动力学中噪声的问题，并呈现了两种经典的噪声描述。首先，通过随机尖峰到达引起的随机性：这个方法导致电压微分方程中的噪声项，可以用朗之万方程表示。其次，神经元内在的随机性导致在亚阈区域时跨越触发阈值的“逃逸”：这个方法引出了广义线性模型的框架，该模型会在神经编码和解码的应用中系统地介绍和讨论。强调第二部分中神经元模型和生物数据之间的关系，并介绍了系统的参数优化算法。</p><p><strong>Part III</strong>将第二部分得出的简化模型用于构建网络。以群体活动方程，也称为群体发放率，描述神经网络动力学的集体特性。确定了可以使用标准发放速率模型描述群体活动的条件。</p><p><strong>Part IV</strong>将动力学与认知联系起来。使用群体活动方程分析计算和认知神经科学中著名的范式，比如在决策或记忆检索过程中的神经活动。在第四部分，我们也概述了与突触可塑性相关的学习理论。本书以极有吸引力的神经动力学原理帮助帕金森病人的应用结尾。</p><p>本书的一小部分内容基于《Spiking Neuron Models》，该书于2002年首次出版，并在此后多次重印。与此同时，这个领域在发生变化，我们认为简单更新《Spiking Neuron Models》的第二版不足以肯定到目前所出现的发展。</p><p>从更一般的角度来看，我们设计一本从一开始就作为教科书而不是专题著作的书将非常有用。因此，本书更突出与实验数据的联系，有更多解释性文字，并且最重要的是，提供了一系列在多年的课堂教学中已经经过测试的练习题。</p><p>我们希望这本书对学生和研究人员都能有所帮助。</p><h1 id="给读者的建议"><a href="#给读者的建议" class="headerlink" title="给读者的建议"></a>给读者的建议</h1><p>每一章以一个具体的问题开始，并在第一节给出直观的答案。随着章节的进行，内容变得更加高级，呈现方式也更加技术化。在第一次阅读本书时，可以先只阅读每一章的第一节或前两节，然后快速浏览后续节。</p><p>更具体的建议取决于读者的背景。比如，建议初次接触计算神经科学领域的读者在开始第二部分和第四部分之前，建议花足够的时间学习第一部分的经典材料。专业的读者可以完全跳过第一部分，直接开始阅读第二部分。</p><p>在第三部分，主要思想在第12章和第15章进行了阐述，这些章节为第四部分的速率模型打下了基础。第三部分更具技术性的章节在第一次阅读时可以跳过，但有必要对当下计算神经科学领域的最新发展有一个深入的理解。</p><p>第四部分涉及神经动力学到认知问题的应用，可以按任意的顺序阅读。</p><p><code>*</code>标记的小节在数学上更高级，第一次阅读本书时可以忽略。</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 神经动力学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RNN学习笔记【01】</title>
      <link href="/2023/07/12/RNN-1/"/>
      <url>/2023/07/12/RNN-1/</url>
      
        <content type="html"><![CDATA[<div class="note info flat"><p>第一次找到和我要做的课题那么接近的教程，人工翻译一遍不过分吧！😎<br>本文对应的代码在这里！😽<a href="https://colab.research.google.com/drive/1e-bXFhYU-uBsNb1MqpDXRG6pdi0kjepf?usp=sharing">[Open in colab]</a>😽</p></div><h1 id="任务优化的循环神经网络建模"><a href="#任务优化的循环神经网络建模" class="headerlink" title="任务优化的循环神经网络建模"></a>任务优化的循环神经网络建模</h1><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>这里，我们基于人工神经网络的方法构建循环神经网络。学习人工神经网络或深度学习，不仅是当今机器学习的主导框架，对计算神经科学而言也是一个有用的工具。</p><p>深度学习本身可能并不符合生物现实。然而，深度学习最终的结果可能是有用的大脑模型（不保证，但是可能）。由于人工神经网络的复杂性，它们可以模拟复杂的行为和神经活动。</p><p>从优化的角度来说，人工神经网络建模可以提供规范性解释，即为什么一个网络可以以某种方式完成某个任务，因为我们可以设计目标函数，类似于生物进化的视角。</p><h2 id="任务介绍"><a href="#任务介绍" class="headerlink" title="任务介绍"></a>任务介绍</h2><p><img src="https://img.cwxhmk.top/post/rnn_obj.png" alt="2AFC"></p><div class="note info flat"><p>双向强迫选择任务<a href="https://neurogym.github.io/envs/PerceptualDecisionMaking-v0.html">PerceptualDecisionMaking</a>，被试需要整合两个刺激来决定哪一个刺激的平均水平更高。<br>在刺激阶段会呈现一个有噪声的刺激。刺激的强度（coherence）在每个试次中是随机抽样的。因为刺激中存在噪声，智能体需要随时间整合刺激信息。<br><strong>参数介绍：</strong><br><code>dt</code>：Timestep duration. (def: 100 (ms) int)<br><code>rewards</code>：  </p><ul><li><code>R_ABORTED</code>: given when breaking fixation. (def: -0.1 float)  </li><li><code>R_CORRECT</code>：given when correct. (def: +1. float)  </li><li><code>R_FAIL</code>：given when incorrect. (def: 0. float)</li></ul><p><code>timing</code>：Description and duration of periods forming a trial.<br><code>stim_scale</code>：Controls the difficulty of the experiment. (def: 1., float)<br><code>cohs</code>：list of float, coherence levels controlling the difficulty of the task<br><code>sigma</code>：float, input noise level<br><code>dim_ring</code>：int, dimension of ring input and output</p></div><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><ul><li><a href="https://neurogym.github.io/">NeuroGym</a>是一个精选的神经科学任务集合，具有统一的接口。其目标是促进关于神经科学任务的神经网络模型的训练。<br><img src="https://img.cwxhmk.top/post/2023-pipeline.png" alt="NeuroGym"></li><li><a href="https://colab.research.google.com/">Google Colab</a>是一个基于云端的免费Jupyter笔记本环境，为用户提供了方便、免费的编码环境，并具备强大的计算资源和协作功能，适用于数据科学家、研究人员和机器学习工程师等进行代码开发、实验和协作。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install neurogym (for training environments)</span></span><br><span class="line">! git clone https://github.com/gyyang/neurogym.git</span><br><span class="line">%cd neurogym</span><br><span class="line">! pip install -e .</span><br><span class="line"></span><br><span class="line"><span class="comment"># import packages</span></span><br><span class="line"><span class="keyword">import</span> time <span class="comment"># for measuring time</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np <span class="comment"># for numerical computation</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> cm <span class="comment"># for plotting figures</span></span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.colors <span class="keyword">import</span> ListedColormap, LinearSegmentedColormap</span><br><span class="line"><span class="keyword">from</span> matplotlib.lines <span class="keyword">import</span> Line2D</span><br><span class="line"><span class="keyword">from</span> IPython <span class="keyword">import</span> display <span class="comment"># for controlling colab</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gym <span class="comment"># for neurogym</span></span><br><span class="line"><span class="keyword">import</span> neurogym <span class="keyword">as</span> ngym <span class="comment"># for training environments</span></span><br><span class="line"><span class="keyword">import</span> torch <span class="comment"># for training neural nets</span></span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA <span class="comment"># for principal component analysis</span></span><br><span class="line"><span class="keyword">from</span> scipy.special <span class="keyword">import</span> softmax</span><br><span class="line">mpl.rcParams.update(mpl.rcParamsDefault)</span><br></pre></td></tr></table></figure></li></ul><h2 id="模型概览"><a href="#模型概览" class="headerlink" title="模型概览"></a>模型概览</h2><p><img src="https://img.cwxhmk.top/post/2023-RNN-model.png" alt="RNN模型概览"></p><div class="note info flat"><p>$x(t)$：输入变量</p><p>$r(t)$：循环变量</p><p>$o(t)$：输出</p><p>$W_x$：输入权重【可训练】</p><p>$W_r, b_r$：循环权重 &amp; 偏置</p><p>$W_o, b_o$：输出权重 &amp; 偏置</p><p>$\alpha&#x3D;\frac{\bigtriangleup t}{\tau }$ </p></div><p>此外，在人工神经网络建模中，我们可以使用各种各样的激活函数，比如<code>ReLU</code>、<code>sigmoid</code>和<code>softplus</code>函数。</p><img src="https://img.cwxhmk.top/post/2023_act_fun.png" alt="激活函数" width="50%" height="50%" /> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Parameter definition</span></span><br><span class="line"><span class="comment"># Hyperparameters</span></span><br><span class="line">hpar = <span class="built_in">dict</span>(</span><br><span class="line">    <span class="comment"># Task parameters</span></span><br><span class="line">    dt = <span class="number">20</span>, <span class="comment"># simulation time step [ms]</span></span><br><span class="line">    stim_len = <span class="number">1000</span>, <span class="comment"># stimulus input duration [ms]</span></span><br><span class="line">    stim_noise = <span class="number">0.3</span>, <span class="comment"># stimulus input noise [unitless]</span></span><br><span class="line">    seq_len = <span class="number">60</span>, <span class="comment"># trial duration in time steps</span></span><br><span class="line">    <span class="comment"># Network parameters</span></span><br><span class="line">    n_neurons = <span class="number">64</span>, <span class="comment"># number of recurrent neurons</span></span><br><span class="line">    network_noise = <span class="number">0.1</span>, <span class="comment"># noise to network [unitless]</span></span><br><span class="line">    tau = <span class="number">100</span>, <span class="comment"># network time constant [ms]</span></span><br><span class="line">    activation_fun = <span class="string">&#x27;relu&#x27;</span>, <span class="comment"># activation function(sigmoid, relu, softplus)</span></span><br><span class="line">    <span class="comment"># Network parameters：training</span></span><br><span class="line">    batch_size = <span class="number">16</span>, <span class="comment"># size of batch</span></span><br><span class="line">    n_iteration = <span class="number">1000</span>, <span class="comment"># number of epochs</span></span><br><span class="line">    learning_rate = <span class="number">0.01</span>, <span class="comment"># training learning rate</span></span><br><span class="line">    optimizer = <span class="string">&#x27;Adam&#x27;</span>, <span class="comment"># optimizer(Adam, RMSprop, SGD)</span></span><br><span class="line">    loss = <span class="string">&#x27;CrossEntropy&#x27;</span> <span class="comment"># loss function(CrossEntropy, L1, L2)</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><div class="note info flat"><p><code>batch</code>：指每次迭代中用于训练模型的样本数量。批大小的选择会影响训练的效果和速度。较大的批大小可以提高训练的效率，因为可以同时处理更多的样本，但会消耗更多的内存。较小的批大小可以提供更多的随机性和模型收敛的稳定性，但可能会导致训练时间增加。<br><code>iteration</code>：指完成整个训练数据集的一次遍历。迭代的数量取决于训练数据集的大小和训练过程的要求。通常，较大的数据集需要更多的迭代来使模型收敛，而较小的数据集可能需要较少的迭代。</p></div><h2 id="训练-RNN-执行任务"><a href="#训练-RNN-执行任务" class="headerlink" title="训练 RNN 执行任务"></a>训练 RNN 执行任务</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># make neurogym environment</span></span><br><span class="line">task_name = <span class="string">&#x27;PerceptualDecisionMaking-v0&#x27;</span></span><br><span class="line">kwargs = &#123;<span class="string">&#x27;dt&#x27;</span>: hpar[<span class="string">&#x27;dt&#x27;</span>],</span><br><span class="line">          <span class="string">&#x27;timing&#x27;</span>: &#123;<span class="string">&#x27;stimulus&#x27;</span>: hpar[<span class="string">&#x27;stim_len&#x27;</span>]&#125;,</span><br><span class="line">          <span class="string">&#x27;sigma&#x27;</span>: hpar[<span class="string">&#x27;stim_noise&#x27;</span>]&#125;</span><br><span class="line">env = gym.make(task_name, **kwargs) </span><br><span class="line"></span><br><span class="line"><span class="comment"># make supervised dataset</span></span><br><span class="line">dataset = ngym.Dataset(env, batch_size=hpar[<span class="string">&#x27;batch_size&#x27;</span>], seq_len=hpar[<span class="string">&#x27;seq_len&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate one batch of data when called</span></span><br><span class="line">inputs, target = dataset()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Input to network has shape(SeqLen,Batch,Dim)=&#x27;</span>, inputs.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Target to network has shape(SeqLen,Batch)=&#x27;</span>, target.shape)</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="comment"># Input to network has shape(SeqLen,Batch,Dim)= (60, 16, 3)</span></span><br><span class="line"><span class="comment"># Target to network has shape(SeqLen,Batch)= (60, 16)</span></span><br></pre></td></tr></table></figure><div class="note info flat"><p><code>gym.make(task_name, **kwargs)</code>：是OpenAI Gym库中用于创建一个与特定任务相关的环境对象。<code>task_name</code>表示要创建的任务的名称，例如<code>CartPole-v1</code>，每个名称对应一个特定的任务环境。<code>**kwargs</code>是一个可选的关键字参数，用于传递额外的配置选项给环境。<br>在Python中，<code>**</code>用于将一个字典（dictionary）解包为关键字参数传递给函数。字典的关键字需与函数的参数名称匹配，参数顺序可以改变。</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Task structure</span></span><br><span class="line">i_trial = np.random.choice(hpar[<span class="string">&#x27;batch_size&#x27;</span>]) <span class="comment"># 随机从一个batch内选择一个trial</span></span><br><span class="line">end = <span class="built_in">sum</span>([v <span class="keyword">for</span> _,v <span class="keyword">in</span> env.timing.items()])/<span class="number">1000</span> <span class="comment"># 单位换为s</span></span><br><span class="line">times = np.arange(end, step=env.dt/<span class="number">1000</span>)</span><br><span class="line">rules = end - env.timing[<span class="string">&#x27;decision&#x27;</span>]/<span class="number">1000</span>, end</span><br><span class="line"></span><br><span class="line">f, ax = plt.subplots(<span class="number">1</span>, <span class="number">2</span>, figsize=(<span class="number">16</span>,<span class="number">5</span>))</span><br><span class="line">ax[<span class="number">0</span>].axvspan(rules[<span class="number">0</span>], rules[<span class="number">1</span>], facecolor=<span class="string">&#x27;grey&#x27;</span>, alpha=<span class="number">0.2</span>)</span><br><span class="line">ax[<span class="number">0</span>].plot(times, inputs[:,i_trial,<span class="number">1</span>], <span class="string">&#x27;blue&#x27;</span>, label=<span class="string">&#x27;Evidence for right motion&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].plot(times, inputs[:,i_trial,<span class="number">2</span>], <span class="string">&#x27;red&#x27;</span>, label=<span class="string">&#x27;Evidence for left motion&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].plot(times, inputs[:,i_trial,<span class="number">0</span>], <span class="string">&#x27;green&#x27;</span>, label=<span class="string">&#x27;Fixation rule&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_ylabel(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_ylim([-<span class="number">0.1</span>,<span class="number">1.1</span>])</span><br><span class="line">ax[<span class="number">0</span>].legend(loc=<span class="string">&#x27;upper left&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_xlabel(<span class="string">&#x27;time(s)&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_title(<span class="string">f&#x27;Input to RNN(trial number=<span class="subst">&#123;i_trial&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax[<span class="number">1</span>].axvspan(rules[<span class="number">0</span>], rules[<span class="number">1</span>], facecolor=<span class="string">&#x27;grey&#x27;</span>, alpha=<span class="number">0.2</span>)</span><br><span class="line">ax[<span class="number">1</span>].hlines(y=<span class="number">1</span>, xmin=times[<span class="number">0</span>], xmax=times[-<span class="number">1</span>], color=<span class="string">&#x27;gray&#x27;</span>, linestyle=<span class="string">&quot;dashed&quot;</span>)</span><br><span class="line">ax[<span class="number">1</span>].hlines(y=<span class="number">2</span>, xmin=times[<span class="number">0</span>], xmax=times[-<span class="number">1</span>], color=<span class="string">&#x27;gray&#x27;</span>, linestyle=<span class="string">&quot;dashed&quot;</span>)</span><br><span class="line">ax[<span class="number">1</span>].text(<span class="number">0</span>, <span class="number">0.08</span>, <span class="string">&#x27;Fixation&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].text(<span class="number">0</span>, <span class="number">0.9</span>, <span class="string">&#x27;Right Decision&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].text(<span class="number">0</span>, <span class="number">1.9</span>, <span class="string">&#x27;Left Decision&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].plot(times, target[:,i_trial], <span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].set_ylabel(<span class="string">&#x27;desired output&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].set_ylim([-<span class="number">0.1</span>,<span class="number">2.1</span>])</span><br><span class="line">ax[<span class="number">1</span>].set_xlabel(<span class="string">&#x27;time(s)&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].set_title(<span class="string">f&#x27;Desired output from RNN(trial number=<span class="subst">&#123;i_trial&#125;</span>)&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://img.cwxhmk.top/post/2023-sample-trial.png" alt="示例trial的输入和输出"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Model definition</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RNN</span>(torch.nn.Module):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, input_size, output_size, **hpar</span>):</span><br><span class="line">    <span class="built_in">super</span>().__init__()</span><br><span class="line">    self.input_size = input_size</span><br><span class="line">    self.output_size = output_size</span><br><span class="line">    self.hidden_size = hpar[<span class="string">&#x27;n_neurons&#x27;</span>]</span><br><span class="line">    self.noise = hpar[<span class="string">&#x27;network_noise&#x27;</span>]</span><br><span class="line">    self.tau = hpar[<span class="string">&#x27;tau&#x27;</span>]</span><br><span class="line">    self.alpha = hpar[<span class="string">&#x27;dt&#x27;</span>]/self.tau</span><br><span class="line">    self.input2rec = torch.nn.Linear(self.input_size, self.hidden_size, bias=<span class="literal">False</span>)</span><br><span class="line">    self.rec2rec = torch.nn.Linear(self.hidden_size, self.hidden_size)</span><br><span class="line">    self.rec2output = torch.nn.Linear(self.hidden_size, self.output_size)</span><br><span class="line">    self.normal = torch.distributions.normal.Normal(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    self.set_activation_fun(**hpar)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">set_activation_fun</span>(<span class="params">self, **hpar</span>):</span><br><span class="line">    <span class="keyword">if</span> hpar[<span class="string">&#x27;activation_fun&#x27;</span>] == <span class="string">&#x27;sigmoid&#x27;</span>:</span><br><span class="line">      self.activation = torch.sigmoid</span><br><span class="line">    <span class="keyword">elif</span> hpar[<span class="string">&#x27;activation_fun&#x27;</span>] == <span class="string">&#x27;relu&#x27;</span>:</span><br><span class="line">      self.activation = torch.relu</span><br><span class="line">    <span class="keyword">elif</span> hpar[<span class="string">&#x27;activation_fun&#x27;</span>] == <span class="string">&#x27;softplus&#x27;</span>:</span><br><span class="line">      self.activation = F.softplus</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">raise</span> NotImplementedError(<span class="string">&#x27;Activation functions should be either ReLU, Sigmoid, or Softplus&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">init_hidden</span>(<span class="params">self, input_shape</span>):</span><br><span class="line">    batch_size = input_shape[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> torch.zeros(batch_size, self.hidden_size)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">recurrence</span>(<span class="params">self, <span class="built_in">input</span>, hidden</span>):</span><br><span class="line">    noise = self.noise * self.normal.sample(hidden.shape)</span><br><span class="line">    h_new = self.activation(self.input2rec(<span class="built_in">input</span>) + self.rec2rec(hidden))</span><br><span class="line">    h_new = hidden * (<span class="number">1</span>-self.alpha) + h_new * self.alpha</span><br><span class="line">    h_new += noise * (<span class="number">2</span>*self.alpha) ** <span class="number">0.5</span></span><br><span class="line">    <span class="keyword">return</span> h_new</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span>, hidden=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> hidden <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">      hidden = self.init_hidden(<span class="built_in">input</span>.shape).to(<span class="built_in">input</span>.device)</span><br><span class="line">    rnn_output = []</span><br><span class="line">    steps = <span class="built_in">range</span>(<span class="built_in">input</span>.size(<span class="number">0</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> steps:</span><br><span class="line">      hidden = self.recurrence(<span class="built_in">input</span>[i], hidden)</span><br><span class="line">      rnn_output.append(hidden)</span><br><span class="line">    </span><br><span class="line">    rnn_output = torch.stack(rnn_output, dim=<span class="number">0</span>)</span><br><span class="line">    output = self.rec2output(rnn_output)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output, rnn_output</span><br><span class="line"></span><br><span class="line">input_size = env.observation_space.shape[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(input_size) <span class="comment"># </span></span><br><span class="line">output_size = env.action_space.n</span><br><span class="line">net = RNN(input_size, output_size, **hpar)</span><br><span class="line"><span class="built_in">print</span>(net)</span><br><span class="line"><span class="keyword">for</span> name, param <span class="keyword">in</span> net.named_parameters():</span><br><span class="line">  <span class="keyword">if</span> param.requires_grad:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\t&#x27;</span>, name, <span class="string">&quot;,&quot;</span> , param.data.shape)</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="comment"># RNN(</span></span><br><span class="line"><span class="comment">#   (input2rec): Linear(in_features=3, out_features=64, bias=False)</span></span><br><span class="line"><span class="comment">#   (rec2rec): Linear(in_features=64, out_features=64, bias=True)</span></span><br><span class="line"><span class="comment">#   (rec2output): Linear(in_features=64, out_features=3, bias=True)</span></span><br><span class="line"><span class="comment"># )</span></span><br><span class="line"><span class="comment"># input2rec.weight , torch.Size([64, 3])</span></span><br><span class="line"><span class="comment"># rec2rec.weight , torch.Size([64, 64])</span></span><br><span class="line"><span class="comment"># rec2rec.bias , torch.Size([64])</span></span><br><span class="line"><span class="comment"># rec2output.weight , torch.Size([3, 64])</span></span><br><span class="line"><span class="comment"># rec2output.bias , torch.Size([3])</span></span><br></pre></td></tr></table></figure><div class="note info flat"><p><code>__init__</code>：在Python中，__init__是一个特殊的方法（也称为构造方法），用于在创建类的实例时进行初始化操作。__init__方法在创建类的实例时自动调用，并用于设置对象的初始状态。它接受类的实例作为第一个参数（通常被命名为self），以便可以访问和操作该实例的属性和方法。除了self参数外，__init__方法可以接受其他参数，这些参数可以用来初始化对象的属性。<br><code>super().__init__()</code>：调用父类的构造方法，确保父类的初始化操作得以执行。<br><code>Activation function</code>：ReLU、Sigmoid、Softplus<br><code>Optimizer</code>：Adam、RMSprop、SGD<br><code>loss function</code>：CrossEntropy、L1、L2</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># train model</span></span><br><span class="line">learning_rate = <span class="number">0.01</span></span><br><span class="line">optimizer = <span class="string">&#x27;Adam&#x27;</span></span><br><span class="line">loss_function = <span class="string">&#x27;CrossEntropy&#x27;</span></span><br><span class="line"></span><br><span class="line">hpar[<span class="string">&#x27;learning_rate&#x27;</span>] = learning_rate</span><br><span class="line">hpar[<span class="string">&#x27;optimizer&#x27;</span>] = optimizer</span><br><span class="line">hpar[<span class="string">&#x27;loss_function&#x27;</span>] = loss_function</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train_model</span>(<span class="params">net, dataset, **hpar</span>):</span><br><span class="line">  <span class="comment"># define an optimizer</span></span><br><span class="line">  learning_rate = hpar[<span class="string">&#x27;learning_rate&#x27;</span>]</span><br><span class="line">  <span class="keyword">if</span> hpar[<span class="string">&#x27;optimizer&#x27;</span>] == <span class="string">&#x27;Adam&#x27;</span>:</span><br><span class="line">    optimizer = torch.optim.Adam(net.parameters(), lr=learning_rate)</span><br><span class="line">  <span class="keyword">elif</span> hpar[<span class="string">&#x27;optimizer&#x27;</span>] == <span class="string">&#x27;RMSprop&#x27;</span>:</span><br><span class="line">    optimizer = torch.optim.RMSprop(net.parameters(), lr=learning_rate)</span><br><span class="line">  <span class="keyword">elif</span> hpar[<span class="string">&#x27;optimizer&#x27;</span>] == <span class="string">&#x27;SGD&#x27;</span>:</span><br><span class="line">    optimizer = torch.optim.SGD(net.parameters(), lr=learning_rate)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> NotImplementedError(<span class="string">&#x27;Optimizer should be either Adam, RMSprop, or SGD&#x27;</span>)</span><br><span class="line">  <span class="comment"># define a loss function</span></span><br><span class="line">  <span class="keyword">if</span> hpar[<span class="string">&#x27;loss&#x27;</span>] == <span class="string">&#x27;CrossEntropy&#x27;</span>:</span><br><span class="line">    criterion = torch.nn.CrossEntropyLoss()</span><br><span class="line">  <span class="keyword">elif</span> hpar[<span class="string">&#x27;loss&#x27;</span>] == <span class="string">&#x27;L1&#x27;</span>:</span><br><span class="line">    criterion = torch.nn.L1loss()</span><br><span class="line">  <span class="keyword">elif</span> hpar[<span class="string">&#x27;loss&#x27;</span>] == <span class="string">&#x27;L2&#x27;</span>:</span><br><span class="line">    criterion = torch.nn.MSELoss()</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> NotImplementedError(<span class="string">&#x27;Loss function should be either CrossEntropy, l1, or L2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  start_time = time.time()</span><br><span class="line">  losses = []</span><br><span class="line">  accs = []</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Plot</span></span><br><span class="line">  fig = plt.figure(figsize=[<span class="number">18</span>,<span class="number">6</span>])</span><br><span class="line">  plt.tight_layout()</span><br><span class="line">  ax0 = fig.add_subplot(<span class="number">121</span>)</span><br><span class="line">  ax0.set_xlim([<span class="number">0</span>,hpar[<span class="string">&#x27;n_iteration&#x27;</span>]])</span><br><span class="line">  plt.ylim([<span class="number">0</span>,<span class="number">0.5</span>])</span><br><span class="line">  ax0.set_xlabel(<span class="string">&#x27;Number of iteration&#x27;</span>)</span><br><span class="line">  ax0.set_ylabel(<span class="string">&#x27;Loss&#x27;</span>)</span><br><span class="line">  ax0.set_title(<span class="string">&#x27;RNN model training curve&#x27;</span>)</span><br><span class="line">  ax1 = fig.add_subplot(<span class="number">121</span>, sharex=ax0, frameon=<span class="literal">False</span>)</span><br><span class="line">  ax1.yaxis.tick_right()</span><br><span class="line">  ax1.yaxis.set_label_position(<span class="string">&#x27;right&#x27;</span>)</span><br><span class="line">  ax1.set_ylabel(<span class="string">&#x27;Accuracy(%)&#x27;</span>)</span><br><span class="line">  ax1.set_ylim([<span class="number">0</span>,<span class="number">100</span>])</span><br><span class="line">  ax1.yaxis.label.set_color(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">  ax0.spines[<span class="string">&#x27;right&#x27;</span>].set_color(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">  ax1.tick_params(axis=<span class="string">&#x27;y&#x27;</span>, colors=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">  ax2 = fig.add_subplot(<span class="number">122</span>)</span><br><span class="line">  ax2.set_title(<span class="string">&#x27;RNN model recurrent weight $W_r$&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Loop</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(hpar[<span class="string">&#x27;n_iteration&#x27;</span>]):</span><br><span class="line">    inputs, labels = dataset() <span class="comment"># 一个batch的数据</span></span><br><span class="line">    inputs = torch.from_numpy(inputs).<span class="built_in">type</span>(torch.<span class="built_in">float</span>)</span><br><span class="line">    labels = torch.from_numpy(labels.flatten()).<span class="built_in">type</span>(torch.long)</span><br><span class="line"></span><br><span class="line">    optimizer.zero_grad() <span class="comment"># clear the gradient buffers</span></span><br><span class="line">    output, _ = net(inputs) <span class="comment"># run the network</span></span><br><span class="line">    output = output.view(-<span class="number">1</span>, output_size)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> hpar[<span class="string">&#x27;loss&#x27;</span>] == <span class="string">&#x27;CrossEntropy&#x27;</span>:</span><br><span class="line">      loss = criterion(output, labels)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      loss = criterion(output, F.one_hot(labels).<span class="built_in">type</span>(torch.<span class="built_in">float</span>))</span><br><span class="line">    loss.backward() <span class="comment"># backpropagation</span></span><br><span class="line">    optimizer.step() <span class="comment"># gradient descent</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># compute the running loss every 100 steps</span></span><br><span class="line">    losses.append(loss.item())</span><br><span class="line">    <span class="comment"># 将输出张量转换为 NumPy 数组，然后选择最后 hpar[&#x27;batch_size&#x27;] 行，并找到选定数组中每个样本的预测类别的索引。最终，pred 是一个包含每个样本预测类别索引的数组。</span></span><br><span class="line">    pred = np.argmax(output.detach().numpy()[(-hpar[<span class="string">&#x27;batch_size&#x27;</span>]):,:],axis=-<span class="number">1</span>)</span><br><span class="line">    true = labels.detach().numpy()[(-hpar[<span class="string">&#x27;batch_size&#x27;</span>]):]</span><br><span class="line">    accs.append((pred==true).mean()*<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">100</span> == <span class="number">99</span>:</span><br><span class="line">      accs_ma = accs.copy()</span><br><span class="line">      accs_ma[<span class="number">10</span>:] = np.convolve(accs_ma, np.ones(<span class="number">10</span>)/<span class="number">10</span>, mode=<span class="string">&#x27;valid&#x27;</span>)</span><br><span class="line"></span><br><span class="line">      ax0.plot(losses, color=<span class="string">&#x27;k&#x27;</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">      ax1.plot(accs_ma, color=<span class="string">&#x27;r&#x27;</span>, linewidth=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">      recurrent_weight = net.get_parameter(<span class="string">&#x27;rec2rec.weight&#x27;</span>).detach().numpy()</span><br><span class="line">      im = ax2.imshow(recurrent_weight, clim=[-<span class="number">0.6</span>,<span class="number">0.6</span>], cmap=<span class="string">&#x27;RdBu_r&#x27;</span>)</span><br><span class="line">      ax2.set_xlabel(<span class="string">&#x27;Presynaptic neuron index&#x27;</span>)</span><br><span class="line">      ax2.set_ylabel(<span class="string">&#x27;Postsynaptic neuron index&#x27;</span>)</span><br><span class="line">      cb = plt.colorbar(im, ax=ax2)</span><br><span class="line"></span><br><span class="line">      display.clear_output(wait=<span class="literal">True</span>)</span><br><span class="line">      display.display(plt.gcf())</span><br><span class="line">      <span class="keyword">if</span> i != hpar[<span class="string">&#x27;n_iteration&#x27;</span>] -<span class="number">1</span>:</span><br><span class="line">        cb.remove()</span><br><span class="line">    <span class="keyword">if</span> i == hpar[<span class="string">&#x27;n_iteration&#x27;</span>] -<span class="number">1</span>:</span><br><span class="line">      display.clear_output(wait=<span class="literal">True</span>)</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">f&#x27;Final training loss=<span class="subst">&#123;np.<span class="built_in">round</span>(np.mean(losses[(-<span class="number">100</span>):]),<span class="number">2</span>)&#125;</span>&#x27;</span>)</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">f&#x27;Final training accuracy(%)=<span class="subst">&#123;np.<span class="built_in">round</span>(np.mean(accs[(-<span class="number">100</span>):]),<span class="number">2</span>)&#125;</span>&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> net</span><br><span class="line">net = RNN(input_size, output_size, **hpar)</span><br><span class="line">net = train_model(net, dataset, **hpar)</span><br></pre></td></tr></table></figure><p><img src="https://img.cwxhmk.top/post/2023-train-result.png" alt="训练误差及准确率"></p><h2 id="分析训练好的-RNN-模型"><a href="#分析训练好的-RNN-模型" class="headerlink" title="分析训练好的 RNN 模型"></a>分析训练好的 RNN 模型</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Analysis</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_model</span>(<span class="params">net, env, num_trial=<span class="number">200</span></span>):</span><br><span class="line">  env.reset(no_step=<span class="literal">True</span>)</span><br><span class="line">  input_dict = &#123;&#125;</span><br><span class="line">  activity_dict = &#123;&#125;</span><br><span class="line">  trial_infos = &#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_trial):</span><br><span class="line">    trial_info = env.new_trial()</span><br><span class="line">    ob, gt = env.ob, env.gt <span class="comment"># observation and ground-truth</span></span><br><span class="line">    inputs = torch.from_numpy(ob[:, np.newaxis, :]).<span class="built_in">type</span>(torch.<span class="built_in">float</span>)</span><br><span class="line"></span><br><span class="line">    action_pred, rnn_activity = net(inputs)</span><br><span class="line">    action_pred = action_pred.detach().numpy()[:, <span class="number">0</span>, :]</span><br><span class="line">    choice = np.argmax(action_pred[-<span class="number">1</span>, :])</span><br><span class="line">    correct = choice==gt[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    _<span class="built_in">input</span> = inputs[:, <span class="number">0</span>, :].detach().numpy()</span><br><span class="line">    rnn_activity = rnn_activity[:, <span class="number">0</span>, :].detach().numpy()</span><br><span class="line">    input_dict[i] = _<span class="built_in">input</span></span><br><span class="line">    activity_dict[i] = rnn_activity</span><br><span class="line">    trial_infos[i] = trial_info</span><br><span class="line">    trial_infos[i].update(&#123;</span><br><span class="line">        <span class="string">&#x27;correct&#x27;</span>: correct,</span><br><span class="line">        <span class="string">&#x27;pred&#x27;</span>: action_pred,</span><br><span class="line">        <span class="string">&#x27;target&#x27;</span>: dataset.env.gt</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="keyword">return</span> input_dict, activity_dict, trial_infos</span><br><span class="line"></span><br><span class="line">run_inputs, activity_dict, trial_infos = run_model(net, dataset.env)</span><br><span class="line">test_acc = np.<span class="built_in">round</span>(np.mean([val[<span class="string">&#x27;correct&#x27;</span>] <span class="keyword">for</span> val <span class="keyword">in</span> trial_infos.values()])*<span class="number">100</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Testing accuracy(%)=<span class="subst">&#123;test_acc&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># randomly choose an example trial</span></span><br><span class="line">i_trial = np.random.choice(<span class="number">200</span>)</span><br><span class="line">coh = trial_infos[i_trial][<span class="string">&#x27;coh&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;coherence=<span class="subst">&#123;coh&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># dict_items([(&#x27;fixation&#x27;, 100), (&#x27;stimulus&#x27;, 1000), (&#x27;delay&#x27;, 0), (&#x27;decision&#x27;, 100)])</span></span><br><span class="line">end = <span class="built_in">sum</span>([v <span class="keyword">for</span> _,v <span class="keyword">in</span> env.timing.items()])/<span class="number">1000</span> </span><br><span class="line">times = np.arange(end, step=env.dt/<span class="number">1000</span>) <span class="comment"># 0~(end-1)</span></span><br><span class="line">rules = end - env.timing[<span class="string">&#x27;decision&#x27;</span>]/<span class="number">1000</span>, end</span><br><span class="line"></span><br><span class="line">f, ax = plt.subplots(<span class="number">1</span>, <span class="number">2</span>, figsize=(<span class="number">16</span>,<span class="number">5</span>))</span><br><span class="line">ax[<span class="number">0</span>].axvspan(rules[<span class="number">0</span>], rules[<span class="number">1</span>], facecolor=<span class="string">&#x27;grey&#x27;</span>, alpha=<span class="number">0.2</span>)</span><br><span class="line">ax[<span class="number">0</span>].plot(times, run_inputs[i_trial][:,<span class="number">1</span>], <span class="string">&#x27;blue&#x27;</span>, label=<span class="string">&#x27;Evidence for right motion&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].plot(times, run_inputs[i_trial][:,<span class="number">2</span>], <span class="string">&#x27;red&#x27;</span>, label=<span class="string">&#x27;Evidence for left motion&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].plot(times, run_inputs[i_trial][:,<span class="number">0</span>], <span class="string">&#x27;green&#x27;</span>, label=<span class="string">&#x27;Fixation rule&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].legend(loc=<span class="string">&#x27;upper left&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_xlabel(<span class="string">&#x27;time(s)&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_ylabel(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_title(<span class="string">f&#x27;Input to RNN(trial number=<span class="subst">&#123;i_trial&#125;</span> coherence=<span class="subst">&#123;coh&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">im = ax[<span class="number">1</span>].imshow(softmax(trial_infos[i_trial][<span class="string">&#x27;pred&#x27;</span>],axis=-<span class="number">1</span>).T, extent=[times[<span class="number">0</span>],end,-<span class="number">0.5</span>,<span class="number">2.5</span>], aspect=<span class="string">&#x27;auto&#x27;</span>, origin=<span class="string">&#x27;lower&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].text(<span class="number">0.05</span>,<span class="number">0.1</span>,<span class="string">&#x27;Fixation&#x27;</span>, color=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].text(<span class="number">0.05</span>,<span class="number">1</span>,<span class="string">&#x27;Right decision&#x27;</span>, color=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].text(<span class="number">0.05</span>,<span class="number">2</span>,<span class="string">&#x27;Left decision&#x27;</span>, color=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].plot(times, trial_infos[i_trial][<span class="string">&#x27;target&#x27;</span>], <span class="string">&#x27;k&#x27;</span>, linewidth=<span class="number">5</span>, label=<span class="string">&#x27;ground truth&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].set_xlabel(<span class="string">&#x27;time(s)&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].set_ylabel(<span class="string">&#x27;RNN output&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].set_yticks([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">ax[<span class="number">1</span>].set_title(<span class="string">f&#x27;RNN output(trial number=<span class="subst">&#123;i_trial&#125;</span> coherence=<span class="subst">&#123;coh&#125;</span>)&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].legend()</span><br><span class="line"></span><br><span class="line">cb = plt.colorbar(im, ax=ax[<span class="number">1</span>])</span><br><span class="line">cb.ax.set_title(<span class="string">&#x27;Predicted probabolity&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://img.cwxhmk.top/post/2023-sample-output.png" alt="示例试次输出结果展示"></p><div class="note info flat"><p>RNN模型测试准确率达到90%以上时，PCA分析不同运动一致比例条件下RNN群体活动轨迹比较容易分开。如果模型的准确率不高，则轨迹比较集中。🦁也就是说，模型是否训练好要设定一个performance threshold~</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PCA(2 principal components)</span></span><br><span class="line">activity = np.concatenate(<span class="built_in">list</span>(activity_dict[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>)), axis=<span class="number">0</span>)</span><br><span class="line">pca = PCA(n_components=<span class="number">3</span>)</span><br><span class="line">pca.fit(activity)</span><br><span class="line">activity_pc = pca.transform(activity)</span><br><span class="line"></span><br><span class="line">blues = cm.get_cmap(<span class="string">&#x27;Blues&#x27;</span>, <span class="built_in">len</span>(env.cohs)+<span class="number">1</span>)</span><br><span class="line">reds = cm.get_cmap(<span class="string">&#x27;Reds&#x27;</span>, <span class="built_in">len</span>(env.cohs)+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">figure = plt.figure(figsize=([<span class="number">7</span>,<span class="number">7</span>]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">  activity_pc = pca.transform(activity_dict[i])</span><br><span class="line">  trial = trial_infos[i]</span><br><span class="line">  color_c = blues <span class="keyword">if</span> trial[<span class="string">&#x27;ground_truth&#x27;</span>] == <span class="number">0</span> <span class="keyword">else</span> reds</span><br><span class="line">  color = color_c(np.where(env.cohs == trial[<span class="string">&#x27;coh&#x27;</span>])[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">  plt.plot(activity_pc[:,<span class="number">0</span>], activity_pc[:,<span class="number">1</span>], <span class="string">&#x27;o-&#x27;</span>, color=color)</span><br><span class="line"></span><br><span class="line">  plt.plot(activity_pc[<span class="number">0</span>,<span class="number">0</span>], activity_pc[<span class="number">0</span>,<span class="number">1</span>], <span class="string">&#x27;^&#x27;</span>, color=<span class="string">&#x27;black&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">handles, labels = plt.gca().get_legend_handles_labels()</span><br><span class="line">dot = Line2D([], [], marker=<span class="string">&#x27;^&#x27;</span>, label=<span class="string">&#x27;Starting point&#x27;</span>, color=<span class="string">&#x27;black&#x27;</span>, linestyle=<span class="string">&#x27;None&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line">lines = []</span><br><span class="line"><span class="keyword">for</span> i_coh, v_coh <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">list</span>(<span class="built_in">enumerate</span>(env.cohs))): <span class="comment"># index value</span></span><br><span class="line">  line_r = Line2D([], [], label=<span class="string">f&#x27;L motion trial, c=<span class="subst">&#123;v_coh&#125;</span>&#x27;</span>, color=reds(i_coh))</span><br><span class="line">  lines.append(line_r)</span><br><span class="line"><span class="keyword">for</span> i_coh, v_coh <span class="keyword">in</span> <span class="built_in">enumerate</span>(env.cohs):</span><br><span class="line">  line_b = Line2D([], [], label=<span class="string">f&#x27;R motion trial, c=<span class="subst">&#123;v_coh&#125;</span>&#x27;</span>, color=blues(i_coh))</span><br><span class="line">  lines.append(line_b)</span><br><span class="line">handles.extend([dot]+lines)</span><br><span class="line">plt.legend(title=<span class="string">&#x27;Legend&#x27;</span>, bbox_to_anchor=(<span class="number">1.4</span>,<span class="number">1.0</span>), handles=handles, frameon=<span class="literal">False</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;PC 1&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;PC 2&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;State space based on principal component analysis&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><img src="https://img.cwxhmk.top/post/2023-PC-2.png" alt="图片说明" width="80%" height="70%" /> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PCA(3 principal components)</span></span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line">activity = np.concatenate(<span class="built_in">list</span>(activity_dict[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>)), axis=<span class="number">0</span>)</span><br><span class="line">pca = PCA(n_components=<span class="number">3</span>)</span><br><span class="line">pca.fit(activity)</span><br><span class="line">activity_pc = pca.transform(activity)</span><br><span class="line"></span><br><span class="line">blues = cm.get_cmap(<span class="string">&#x27;Blues&#x27;</span>, <span class="built_in">len</span>(env.cohs)+<span class="number">1</span>)</span><br><span class="line">reds = cm.get_cmap(<span class="string">&#x27;Reds&#x27;</span>, <span class="built_in">len</span>(env.cohs)+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=([<span class="number">7</span>,<span class="number">7</span>]))</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">  activity_pc = pca.transform(activity_dict[i])</span><br><span class="line">  trial = trial_infos[i]</span><br><span class="line">  color_c = blues <span class="keyword">if</span> trial[<span class="string">&#x27;ground_truth&#x27;</span>] == <span class="number">0</span> <span class="keyword">else</span> reds</span><br><span class="line">  color = color_c(np.where(env.cohs == trial[<span class="string">&#x27;coh&#x27;</span>])[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">  ax.plot(activity_pc[:,<span class="number">0</span>], activity_pc[:,<span class="number">1</span>], activity_pc[:,<span class="number">2</span>], <span class="string">&#x27;o-&#x27;</span>, color=color)</span><br><span class="line"></span><br><span class="line">  ax.plot(activity_pc[<span class="number">0</span>,<span class="number">0</span>], activity_pc[<span class="number">0</span>,<span class="number">1</span>], activity_pc[<span class="number">0</span>,<span class="number">2</span>],<span class="string">&#x27;^&#x27;</span>, color=<span class="string">&#x27;black&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">handles, labels = plt.gca().get_legend_handles_labels()</span><br><span class="line">dot = Line2D([], [], marker=<span class="string">&#x27;^&#x27;</span>, label=<span class="string">&#x27;Starting point&#x27;</span>, color=<span class="string">&#x27;black&#x27;</span>, linestyle=<span class="string">&#x27;None&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line">lines = []</span><br><span class="line"><span class="keyword">for</span> i_coh, v_coh <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">list</span>(<span class="built_in">enumerate</span>(env.cohs))): <span class="comment"># index value</span></span><br><span class="line">  line_r = Line2D([], [], label=<span class="string">f&#x27;L motion trial, c=<span class="subst">&#123;v_coh&#125;</span>&#x27;</span>, color=reds(i_coh))</span><br><span class="line">  lines.append(line_r)</span><br><span class="line"><span class="keyword">for</span> i_coh, v_coh <span class="keyword">in</span> <span class="built_in">enumerate</span>(env.cohs):</span><br><span class="line">  line_b = Line2D([], [], label=<span class="string">f&#x27;R motion trial, c=<span class="subst">&#123;v_coh&#125;</span>&#x27;</span>, color=blues(i_coh))</span><br><span class="line">  lines.append(line_b)</span><br><span class="line">handles.extend([dot]+lines)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;PC 1&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;PC 2&#x27;</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">&#x27;PC 3&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;State space based on principal component analysis&#x27;</span>)</span><br><span class="line">plt.legend(title=<span class="string">&#x27;Legend&#x27;</span>, bbox_to_anchor=(<span class="number">1.6</span>,<span class="number">0.9</span>), handles=handles, frameon=<span class="literal">False</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://img.cwxhmk.top/post/2023-PC-3.png" alt="PCA（三个主成分）"></p><h1 id="补充知识"><a href="#补充知识" class="headerlink" title="补充知识"></a>补充知识</h1><h2 id="kwargs"><a href="#kwargs" class="headerlink" title="**kwargs"></a>**kwargs</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kwargs = &#123;<span class="string">&#x27;arg1&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;arg3&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;arg2&#x27;</span>: <span class="string">&#x27;hello&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">example_function</span>(<span class="params">arg1, arg2, arg3</span>):</span><br><span class="line">    <span class="built_in">print</span>(arg1)</span><br><span class="line">    <span class="built_in">print</span>(arg2)</span><br><span class="line">    <span class="built_in">print</span>(arg3)</span><br><span class="line"></span><br><span class="line">example_function(**kwargs)</span><br><span class="line"><span class="comment"># 10</span></span><br><span class="line"><span class="comment"># hello</span></span><br><span class="line"><span class="comment"># True</span></span><br></pre></td></tr></table></figure><h2 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h2><p>在Python中，字典是一种可变的数据结构，用于存储键-值对的集合。字典可以使用<code>&#123;&#125;</code>来创建，也可以通过<code>dict()</code>函数创建。<br><code>update</code>方法可以接受一个字典对象或包含键值对的可迭代对象作为参数，并将其中的键值对添加到调用<code>update</code>方法的字典中。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">my_dict = &#123;<span class="string">&#x27;key1&#x27;</span>: <span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>&#125;</span><br><span class="line">my_dict = <span class="built_in">dict</span>(</span><br><span class="line">  key1 = value1,</span><br><span class="line">  key2 = value2,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">my_dict = &#123;<span class="string">&#x27;key1&#x27;</span>: <span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>&#125;</span><br><span class="line">new_dict = &#123;<span class="string">&#x27;key3&#x27;</span>: <span class="string">&#x27;value3&#x27;</span>, <span class="string">&#x27;key4&#x27;</span>: <span class="string">&#x27;value4&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">my_dict.update(new_dict)</span><br><span class="line"><span class="built_in">print</span>(my_dict)</span><br><span class="line"><span class="comment"># 输出：&#123;&#x27;key1&#x27;: &#x27;value1&#x27;, &#x27;key2&#x27;: &#x27;value2&#x27;, &#x27;key3&#x27;: &#x27;value3&#x27;, &#x27;key4&#x27;: &#x27;value4&#x27;&#125;</span></span><br></pre></td></tr></table></figure><h2 id="time-time"><a href="#time-time" class="headerlink" title="time.time()"></a>time.time()</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">start_time = time.time()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">  <span class="built_in">print</span>(i)</span><br><span class="line">end_time = time.time() <span class="comment"># 可用于计算程序运行的时间</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;程序用时：<span class="subst">&#123;end_time-start_time&#125;</span>s&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="参考内容"><a href="#参考内容" class="headerlink" title="参考内容"></a>参考内容</h1><ul><li><a href="https://colab.research.google.com/drive/1jv51d1VfMvWNSc6YeJeoSRvNdO5c1UJW?usp=sharing">Methods of BCS: Mathematical modeling and simulation（Part II）</a></li><li><a href="https://www.nature.com/articles/s41593-019-0520-2">A deep learning framework for neuroscience</a></li><li><a href="https://github.com/neurogym/neurogym">NeuroGym</a></li><li><a href="https://colab.research.google.com/github/HurleyJames/GoogleColabExercise/blob/master/Intro_to_PyTorch.ipynb">Introduction to PyTorch</a></li><li><a href="https://neurogym.github.io/understanding_neurogym_task.html">Understanding Neurogym Task</a></li><li><a href="https://www.gymlibrary.dev/content/environment_creation/">Gym: Make your own custom environment</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RNN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows设置代理及取消代理</title>
      <link href="/2023/07/11/set-proxy/"/>
      <url>/2023/07/11/set-proxy/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本来想用<code>coursera-dl</code>下载coursera上面的网课，结果一直报错，想找找下载视频的插件，也没找到好用的，最终还是回归伟大的哔哩哔哩！😽</p></div><h1 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h1><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 翻墙后设置代理</span><br><span class="line"><span class="built_in">set</span> http_proxy=http://<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>(代理的IP地址):<span class="number">1080</span>(代理的端口号)</span><br><span class="line"><span class="built_in">set</span> https_proxy=http://<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>(代理的IP地址):<span class="number">1080</span>(代理的端口号)</span><br><span class="line"># 不翻墙的话需要取消代理，否则打开一些页面会很慢</span><br><span class="line"><span class="built_in">set</span> http_proxy=</span><br><span class="line"><span class="built_in">set</span> https_proxy=</span><br></pre></td></tr></table></figure><h1 id="油猴插件"><a href="#油猴插件" class="headerlink" title="油猴插件"></a>油猴插件</h1><p>点击网站右上角（篡改猴）图标→获取新脚本→搜索用户脚本→安装</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://blog.csdn.net/z784561257/article/details/89380423">windows下使用代理并取消代理</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BrainPy学习笔记【01】</title>
      <link href="/2023/07/10/brainpy-1/"/>
      <url>/2023/07/10/brainpy-1/</url>
      
        <content type="html"><![CDATA[<h1 id="安装教程（Windows环境）"><a href="#安装教程（Windows环境）" class="headerlink" title="安装教程（Windows环境）"></a>安装教程（Windows环境）</h1><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">conda env list</span><br><span class="line">conda create --name bdp python=<span class="number">3</span>.<span class="number">9</span> -y</span><br><span class="line">conda activate bdp</span><br><span class="line"></span><br><span class="line">python -m pip install git+https://git.openi.org.cn/OpenI/BrainPy</span><br><span class="line">conda install numpy</span><br><span class="line">pip install &quot;jax[cpu]&quot; -f https://whls.blob.core.windows.<span class="built_in">net</span>/unstable/index.html</span><br><span class="line">python -m pip install brainpylib # 报错 需要安装matplotlib</span><br><span class="line">conda install matplotlib</span><br><span class="line">python -m pip install brainpylib</span><br><span class="line"></span><br><span class="line">conda install ipykernel</span><br></pre></td></tr></table></figure><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://github.com/c-xy17/NeuralModeling">《神经计算建模实战》代码</a></li><li><a href="https://brainpy.readthedocs.io/en/latest/quickstart/installation.html">BrainPy文档</a></li><li><a href="https://blog.csdn.net/Fellyhosn/article/details/129903163?spm=1001.2014.3001.5502">【brainpy学习笔记】基础知识1(安装、JIT编译与编程基础)</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BrainPy </tag>
            
            <tag> 计算建模 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BIRDS插件代码学习【06】</title>
      <link href="/2023/07/10/imagej-plugin-6/"/>
      <url>/2023/07/10/imagej-plugin-6/</url>
      
        <content type="html"><![CDATA[<h1 id="今日计划"><a href="#今日计划" class="headerlink" title="今日计划"></a>今日计划</h1><ul><li><input checked="" disabled="" type="checkbox"> 准备和刘越老师讨论的PPT，主要整理计算建模的思路以及难点</li><li><input checked="" disabled="" type="checkbox"> 提取单张脑片的脑区轮廓</li><li><input checked="" disabled="" type="checkbox"> BrainPy环境搭建</li><li><input checked="" disabled="" type="checkbox"> 整理计算神经科学领域比较有名的实验室和科学家</li></ul><h1 id="提取脑区轮廓"><a href="#提取脑区轮廓" class="headerlink" title="提取脑区轮廓"></a>提取脑区轮廓</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> I.plugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ij.ImagePlus;</span><br><span class="line"><span class="keyword">import</span> ij.ImageStack;</span><br><span class="line"><span class="keyword">import</span> ij.gui.NewImage;</span><br><span class="line"><span class="keyword">import</span> ij.io.FileSaver;</span><br><span class="line"><span class="keyword">import</span> ij.plugin.RGBStackMerge;</span><br><span class="line"><span class="keyword">import</span> ij.process.ImageProcessor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test06</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> ImageProcessor <span class="title function_">getLineImg</span><span class="params">(ImageProcessor ip, ImageProcessor op)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">lenX</span> <span class="operator">=</span> ip.getWidth();</span><br><span class="line"><span class="type">int</span> <span class="variable">lenY</span> <span class="operator">=</span> ip.getHeight();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; lenX; i ++) &#123; <span class="comment">//按列</span></span><br><span class="line"><span class="type">int</span> <span class="variable">begin</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">//初始像素值为黑色</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; lenY; j ++) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> (<span class="type">int</span>)ip.getPixelValue(i, j);</span><br><span class="line"><span class="keyword">if</span>(temp != begin) &#123;</span><br><span class="line">op.set(i, j, <span class="number">255</span>);</span><br><span class="line">begin = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; lenY; j ++) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">begin</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">//初始像素值为黑色</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; lenX; i ++) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> (<span class="type">int</span>)ip.getPixelValue(i, j);</span><br><span class="line"><span class="keyword">if</span>(temp != begin) &#123;</span><br><span class="line">op.set(i, j, <span class="number">255</span>);</span><br><span class="line">begin = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> op;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">ImagePlus</span> <span class="variable">brainImage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ImagePlus</span>(<span class="string">&quot;D:/Desktop/downSampleImage0160.tif&quot;</span>);</span><br><span class="line"><span class="type">ImageStack</span> <span class="variable">brainStack</span> <span class="operator">=</span> brainImage.getStack();</span><br><span class="line"></span><br><span class="line"><span class="type">ImagePlus</span> <span class="variable">annoImage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ImagePlus</span>(<span class="string">&quot;D:/Desktop/anno_output/result0160.tif&quot;</span>);</span><br><span class="line"><span class="type">ImageProcessor</span> <span class="variable">ap</span> <span class="operator">=</span> annoImage.getProcessor();</span><br><span class="line"><span class="type">int</span> <span class="variable">width</span> <span class="operator">=</span> ap.getWidth();</span><br><span class="line"><span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> ap.getHeight();</span><br><span class="line"></span><br><span class="line"><span class="type">ImagePlus</span> <span class="variable">lineImage</span> <span class="operator">=</span> NewImage.createByteImage(<span class="string">&quot;lineImage&quot;</span>, width, height, <span class="number">0</span>, NewImage.FILL_BLACK);</span><br><span class="line"><span class="type">ImageStack</span> <span class="variable">lineStack</span> <span class="operator">=</span> lineImage.getStack();</span><br><span class="line"><span class="type">ImageProcessor</span> <span class="variable">lp</span> <span class="operator">=</span> lineImage.getProcessor();</span><br><span class="line"></span><br><span class="line"><span class="type">ImageProcessor</span> <span class="variable">op</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Test06</span>().getLineImg(ap, lp);</span><br><span class="line"></span><br><span class="line">lineImage.setProcessor(op);</span><br><span class="line">lineImage.show();</span><br><span class="line"> </span><br><span class="line"><span class="type">ImagePlus</span> <span class="variable">fuseImage</span> <span class="operator">=</span> NewImage.createByteImage(<span class="string">&quot;fuseImage&quot;</span>, width, height, <span class="number">0</span>, NewImage.FILL_BLACK);</span><br><span class="line"></span><br><span class="line"><span class="type">ImageStack</span> <span class="variable">fuseStack</span> <span class="operator">=</span> RGBStackMerge.mergeStacks(brainStack, lineStack, <span class="literal">null</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">fuseImage.setStack(fuseStack);</span><br><span class="line">fuseImage.show();</span><br><span class="line">        <span class="comment">// 保存图片</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">FileSaver</span>(fuseImage).saveAsTiff(<span class="string">&quot;D:/Desktop/fuseImage.tif&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="细胞计数"><a href="#细胞计数" class="headerlink" title="细胞计数"></a>细胞计数</h1><div class="note info flat"><p>没想到BIRDS里细胞计数是通过调用Imaris的方法实现的，看来还是要学一下这个软件的用法🥲运行Imaris前记得先运行<code>license server.bat</code>~<br>.tif → .ims可以通过<code>ImarisFileConverter.exe</code>实现，Imaris默认安装在C盘。<br>没有找到很方便的API，看代码似乎是要现在Imaris里面操作完成之后，Java再获取对应的数据，这好像和我想要达到的效果不一样。<br>👻不想动脑子，怎么办！！！</p></div><h1 id="流程测试"><a href="#流程测试" class="headerlink" title="流程测试"></a>流程测试</h1><div class="note info flat"><p>⭐脑片与标准脑模板的尺寸要大致相同，为了不过度损失脑片分辨率，此处对标准脑模板进行上采样<br>⭐<code>elastix.exe</code>配准的参数使用<code>para-Standard_bspline.txt</code>、<code>para-Standard_affine.txt</code>和<code>para-Standard_rigid.txt</code>（去掉了对图片维度的限制）效果比较好<br>👻不知道为什么提取的脑区轮廓有很明显的锯齿，难道是因为我把注释图片分辨率调高了？不过问题不大~<br>👻由于原始脑片本身边缘有破损，因此与轮廓边缘处会出现明显的变形</p></div><ol><li>将标准脑模板和注释图片的分辨率提高至与脑片匹配的程度（尽量不损失原始脑片的图像分辨率）<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">Image.MAX_IMAGE_PIXELS = <span class="literal">None</span></span><br><span class="line">raw = Image.<span class="built_in">open</span>(<span class="string">r&quot;D:/Desktop/elastix-5.1.0-win64/input/result1.tif&quot;</span>)</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">r&quot;D:/Desktop/elastix-5.1.0-win64/out_anno/annotationImage0270.tif&quot;</span>)</span><br><span class="line"><span class="comment"># img = Image.open(r&quot;D:/Desktop/elastix-5.1.0-win64/out_temp/tempImage0270.tif&quot;)</span></span><br><span class="line"></span><br><span class="line">target_width = raw.size[<span class="number">0</span>]</span><br><span class="line">scale = <span class="built_in">round</span>(target_width/img.size[<span class="number">0</span>],<span class="number">1</span>)</span><br><span class="line">width = <span class="built_in">int</span>(img.size[<span class="number">0</span>]*scale)</span><br><span class="line">height = <span class="built_in">int</span>(img.size[<span class="number">1</span>]*scale)</span><br><span class="line"></span><br><span class="line">out = img.resize((width, height))</span><br><span class="line"><span class="built_in">type</span> = img.<span class="built_in">format</span></span><br><span class="line">out.save(<span class="string">&#x27;D:/Desktop/elastix-5.1.0-win64/out_anno/annotationImage0270-1.tif&#x27;</span>,<span class="built_in">type</span>)</span><br><span class="line"><span class="comment"># out.save(&#x27;D:/Desktop/elastix-5.1.0-win64/out_temp/tempImage0270-1.tif&#x27;,type)</span></span><br></pre></td></tr></table></figure></li><li>脑片与图谱配准<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">elastix -f input/result1.tif -m out_temp/tempImage0270-<span class="number">1</span>.tif -out output -p input/para-Standard_rigid.txt -p input/para-Standard_affine.txt -p input/para-Standard_bspline_2.txt</span><br><span class="line"></span><br><span class="line">transformix -<span class="keyword">in</span> out_anno/annotationImage0270-<span class="number">1</span>.tif -out result -tp output/TransformParameters.<span class="number">2</span>.txt</span><br></pre></td></tr></table></figure></li></ol><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://imagej.nih.gov/ij/developer/api/ij/ij/plugin/package-summary.html">Package ij.plugin</a></li><li><a href="https://github.com/utsavdj/automated-cell-counter-java-code">Automated Cell Counter in Java</a></li><li><a href="https://www.zhihu.com/question/265785687">如何用Imaris数细胞？</a></li><li><a href="https://imaris.github.io/imglib2-imaris-bridge/">ImgLib2-Imaris-Bridge</a></li><li><a href="https://imaris.github.io/imglib2-imaris-bridge/apidocs/">imglib2-imaris-bridge 9.7.2.0 API</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ImageJ </tag>
            
            <tag> Java </tag>
            
            <tag> Eclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决mac电脑更新后V2rayU无法启动</title>
      <link href="/2023/07/09/v2rayu-mac/"/>
      <url>/2023/07/09/v2rayu-mac/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>电脑更新完以后，突然一直弹出警告让我卸载V2rayU，┭┮﹏┭┮，这可是我的宝贝软件，怎么能卸载呢？？？在网上搜索了半天，终于找到解决方案了！</p></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 命令行输入</span></span><br><span class="line">sudo codesign --force --deep --sign - /Applications/V2rayU.app</span><br><span class="line"><span class="comment"># 2. 右键单击软件→显示简介→勾选☑️覆盖恶意软件保护</span></span><br><span class="line"><span class="comment"># 3. 打开软件</span></span><br><span class="line"><span class="comment"># 4. 命令行输入</span></span><br><span class="line">sudo codesign --force --deep --sign - ~/.V2rayU/V2rayUTool</span><br><span class="line">sudo codesign --force --deep --sign - ~/.V2rayU/v2ray-core/v2ray</span><br></pre></td></tr></table></figure><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://github.com/yanue/V2rayU/releases">v2raU下载链接</a></li><li><a href="https://zhuanlan.zhihu.com/p/641261094">应用程序“V2rayU.app”无法打开的解决方法</a></li><li><a href="https://github.com/yanue/V2rayU/issues/1234">应用程序“V2rayU.app”无法打开的解决办法</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> V2rayU </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BIRDS插件代码学习【05】</title>
      <link href="/2023/07/08/imagej-plugin-5/"/>
      <url>/2023/07/08/imagej-plugin-5/</url>
      
        <content type="html"><![CDATA[<h1 id="Java-调用命令行"><a href="#Java-调用命令行" class="headerlink" title="Java 调用命令行"></a>Java 调用命令行</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test05</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> <span class="string">&quot;calc&quot;</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="type">Process</span> <span class="variable">ps</span> <span class="operator">=</span> Runtime.getRuntime().exec(cmd);<span class="comment">//打开计算器</span></span><br><span class="line"><span class="comment">// ps.getInputStream() 获取进程的输出流</span></span><br><span class="line"><span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(ps.getInputStream()));</span><br><span class="line">String line;</span><br><span class="line"><span class="keyword">while</span>((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">System.out.println(line);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="elastix-使用"><a href="#elastix-使用" class="headerlink" title="elastix 使用"></a>elastix 使用</h1><ol><li>下载 <a href="https://github.com/SuperElastix/elastix/releases">elastix-5.1.0-win64</a>，解压后得到<code>elastix.exe</code>和<code>transformix.exe</code></li><li>下载 elastix 用户手册<div class="row">    <embed src="https://img.cwxhmk.top/pdf/elastix-5.1.0-manual.pdf" width="100%" height="550" type="application/pdf"></div></li><li>命令行调用<code>elastix.exe</code>和<code>transformix.exe</code>得到配准后的脑片<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">elastix.exe --<span class="built_in">help</span></span><br><span class="line">elastix -f input/downSampleImage.tif -m input/tempImage.tif -out output -p input/Parameters_BSpline.txt</span><br><span class="line"></span><br><span class="line">transformix.exe --<span class="built_in">help</span></span><br><span class="line">transformix -<span class="keyword">in</span> input/annotationImage.tif -out result -tp output/TransformParameters.<span class="number">0</span>.txt</span><br><span class="line"># 参数文件中可以设置输出格式，默认为mhd，此处修改为tif</span><br></pre></td></tr></table></figure></li></ol><h1 id="ImageJ-合并通道"><a href="#ImageJ-合并通道" class="headerlink" title="ImageJ 合并通道"></a>ImageJ 合并通道</h1><ol><li>将待合并的两张图像载入ImageJ<div class="fj-gallery"><p><img src="https://img.cwxhmk.top/post/20230709-1.png" alt="脑片"><br><img src="https://img.cwxhmk.top/post/20230709-2.png" alt="脑区轮廓"></p>          </div></li><li>Image→Color→Merge Channels</li><li>脑片保留红色通道，脑区轮廓保留绿色通道（注意不要勾选create composite，以免保存时仅有最上层的通道）<br><img src="https://img.cwxhmk.top/post/20230709-3.png" alt="合并通道"></li><li>保存为tif文件<img src="https://img.cwxhmk.top/post/20230709-4.png" alt="合并后的图像" width="50%" height="50%" /></li></ol><h1 id="二维脑片配准关键步骤"><a href="#二维脑片配准关键步骤" class="headerlink" title="二维脑片配准关键步骤"></a>二维脑片配准关键步骤</h1><ol><li>定位与脑片最匹配的图谱（相似度最高）</li><li>获取Allen全脑平均模板<code>tempImage</code>和对应的注释文件<code>annotationImage</code></li><li>通过<code>elastix.exe</code>和<code>transformix.exe</code>对脑片配准（模板→脑片 注释→脑片）</li><li>根据注释文件获取脑区轮廓<code>lineImage</code></li><li>轮廓与脑片合并得到<code>fuseImage</code></li><li>根据annotationImage的像素值匹配脑区</li><li>脑区细胞计数<br><img src="https://img.cwxhmk.top/post/20230709-5.png" alt="二维脑片配准流程图"></li></ol><h1 id="今日总结"><a href="#今日总结" class="headerlink" title="今日总结"></a>今日总结</h1><p>到目前为止感觉BIRDS的配准是通过elastix实现的，需要看一下elastix的论文，然后试一下elastix进行脑片配准的效果。</p><p>不管老板对我的要求是怎样的，我对自己的要求就是把一个小项目做完再做下一个小项目，不能三心二意。我的课题要根据我自己的兴趣来，广泛涉猎给自己找一条出路，我现在没有能力回绝老板的各种要求就是因为我没有能够给出其他方案，要行动起来。</p><p>每天拿出1~2个小时跟着吴思老师实验室出的书《神经计算建模实战——基于brainpy》实操一下，总要下点功夫入门计算神经科学吧！可能需要补一下微积分的知识😎</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://github.com/SuperElastix/elastix">elastix image registration toolbox</a></li><li><a href="https://blog.csdn.net/calabash_man/article/details/108266692">Java 调用命令行</a></li><li><a href="https://blog.csdn.net/Joker00007/article/details/112402763">医学图像配准工具Elastix的配置和入门</a></li><li><a href="https://elastix.lumc.nl/modelzoo/">elastix Model Zoo</a></li><li><a href="https://github.com/SuperElastix/ElastixModelZoo/tree/master/models/Par0009">elatix 参数</a></li><li><a href="https://github.com/Brainpy/Brainpy">BrainPy</a></li><li><a href="https://blog.csdn.net/Fellyhosn/article/details/129903163?spm=1001.2014.3001.5502">【brainpy学习笔记】基础知识1(安装、JIT编译与编程基础)</a></li><li><a href="https://www.jingege.wang/2020/07/22/%e5%88%a9%e7%94%a8image-j%e6%8b%86%e5%88%86%e5%92%8cmerge%e8%8d%a7%e5%85%89%e5%9b%be%e7%89%87/">利用ImageJ拆分和Merge荧光图片</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ImageJ </tag>
            
            <tag> Java </tag>
            
            <tag> Eclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BIRDS插件代码学习【04】</title>
      <link href="/2023/07/06/imagej-plugin-4/"/>
      <url>/2023/07/06/imagej-plugin-4/</url>
      
        <content type="html"><![CDATA[<h1 id="体素-voxel"><a href="#体素-voxel" class="headerlink" title="体素 voxel"></a>体素 voxel</h1><div class="note success simple"><p>体素是三维空间的像素。体素网格是用固定大小的立方块作为最小单元来表示三维物体的一种数据结构。</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 该程序实现鼠标事实获取stack当前图像（slice）的体素值（16unit 颜色值）</span></span><br><span class="line"><span class="comment"> * 备注：通过该体素值可以进一步匹配到对应的脑区（该程序不包含此部分）</span></span><br><span class="line"><span class="comment"> * 代码主要参考了BIRDS配准源码</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 文欣</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">package</span> I.plugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.Point;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseListener;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseMotionListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ij.IJ;</span><br><span class="line"><span class="keyword">import</span> ij.ImageJ;</span><br><span class="line"><span class="keyword">import</span> ij.ImagePlus;</span><br><span class="line"><span class="keyword">import</span> ij.ImageStack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test04</span> <span class="keyword">implements</span> <span class="title class_">MouseListener</span>,MouseMotionListener&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="title function_">Test04</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ImagePlus brainImg;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ImageJ</span>();</span><br><span class="line"></span><br><span class="line">brainImg = IJ.openImage(<span class="string">&quot;D:/Desktop/annotationOrgImage.tif&quot;</span>);</span><br><span class="line">brainImg.show();</span><br><span class="line"></span><br><span class="line">System.out.println(brainImg.getTitle());</span><br><span class="line">System.out.println(brainImg.getStackSize());</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Test04</span>().addMouseListener();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addMouseListener</span><span class="params">()</span> &#123;</span><br><span class="line"> </span><br><span class="line">brainImg.getCanvas().addMouseListener(<span class="built_in">this</span>);</span><br><span class="line">brainImg.getCanvas().addMouseMotionListener(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseMoved</span><span class="params">(MouseEvent e)</span> &#123;</span><br><span class="line"><span class="type">ImageStack</span> <span class="variable">brainStack</span> <span class="operator">=</span> brainImg.getImageStack();</span><br><span class="line"><span class="type">int</span> <span class="variable">currentSlice</span> <span class="operator">=</span> brainImg.getCurrentSlice(); </span><br><span class="line"><span class="type">Point</span> <span class="variable">tempPoint</span> <span class="operator">=</span> brainImg.getCanvas().getCursorLoc();</span><br><span class="line"><span class="type">int</span> <span class="variable">val</span> <span class="operator">=</span> (<span class="type">int</span>)(brainStack.getVoxel(tempPoint.x, tempPoint.y, currentSlice-<span class="number">1</span>));<span class="comment">//16位像素值</span></span><br><span class="line">System.out.println(val); <span class="comment">//打印</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseDragged</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseClicked</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mousePressed</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseReleased</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseEntered</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseExited</span><span class="params">(MouseEvent e)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://blog.csdn.net/u010858605/article/details/113663883">Class.getClassLoader().getResourceAsStream()</a></li><li><a href="https://zhuanlan.zhihu.com/p/348563616">什么是体素(Voxel)?</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ImageJ </tag>
            
            <tag> Java </tag>
            
            <tag> Eclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BIRDS插件代码学习【03】</title>
      <link href="/2023/07/05/imagej-plugin-3/"/>
      <url>/2023/07/05/imagej-plugin-3/</url>
      
        <content type="html"><![CDATA[<h1 id="图像预处理过程"><a href="#图像预处理过程" class="headerlink" title="图像预处理过程"></a>图像预处理过程</h1><h2 id="图像介绍"><a href="#图像介绍" class="headerlink" title="图像介绍"></a>图像介绍</h2><p>DownSample.java文件中主要涉及了以下图像：</p><ul><li><code>ourBrainImage</code>：导入ImageJ的原始图像</li><li><code>Atlas132labelImage</code>：Allen小鼠脑图谱（冠状面）570×400×660</li><li><code>tempInvertOrgImage</code>：Allen小鼠脑平均模板反转</li><li><code>tempOrgImage</code>：Allen小鼠脑平均模板</li><li><code>annotationImage</code>：注释图谱<br>其中Atlas132labelImage、annotationImage、tempOrgImage和tempInvertOrgImage是直接存入cache的。Atlas132labelImage仅仅是用于展示脑图谱，并没有做过多的处理。tempOrgImage和annotationImage均由Allen Brain提供（<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8152789/">CCFv3</a>）。</li></ul><h2 id="获取CCFv3小鼠全脑平均模板和注释"><a href="#获取CCFv3小鼠全脑平均模板和注释" class="headerlink" title="获取CCFv3小鼠全脑平均模板和注释"></a>获取CCFv3小鼠全脑平均模板和注释</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nrrd <span class="comment"># pip install pynrrd</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">AVGT, metaAVGT = nrrd.read(<span class="string">&#x27;average_template_25.nrrd&#x27;</span>); <span class="comment"># 25 voxel</span></span><br><span class="line">ANO, metaANO = nrrd.read(<span class="string">&#x27;CCFv3_annotation_25.nrrd&#x27;</span>);</span><br><span class="line"></span><br><span class="line">AVGT.shape <span class="comment"># (528, 320, 456)</span></span><br><span class="line"><span class="comment"># 存储average template</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">526</span>):</span><br><span class="line">    <span class="built_in">slice</span> = AVGT[i+<span class="number">1</span>,:,:].astype(<span class="built_in">float</span>)</span><br><span class="line">    <span class="built_in">slice</span> /= np.<span class="built_in">max</span>(<span class="built_in">slice</span>)</span><br><span class="line">    im = Image.fromarray(np.uint8(plt.cm.gray(<span class="built_in">slice</span>)*<span class="number">255</span>))</span><br><span class="line">    im.save(<span class="string">&#x27;avgt/avgt_coronal_%d.png&#x27;</span>%(i+<span class="number">1</span>))</span><br><span class="line"><span class="comment"># 存储annotation</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">526</span>):</span><br><span class="line">    <span class="built_in">slice</span> = ANO[i+<span class="number">1</span>,:,:].astype(<span class="built_in">float</span>)</span><br><span class="line">    <span class="built_in">slice</span> /= <span class="number">2000</span></span><br><span class="line">    im = Image.fromarray(np.uint8(plt.cm.gray(<span class="built_in">slice</span>)*<span class="number">255</span>))</span><br><span class="line">    im.save(<span class="string">&#x27;anno/ano_coronal_%d.png&#x27;</span>%(i+<span class="number">1</span>))</span><br></pre></td></tr></table></figure><h1 id="今日总结"><a href="#今日总结" class="headerlink" title="今日总结"></a>今日总结</h1><p>我之前并没有留意BIRDS插件一开始载入缓存文件夹中的内容，本以为就是把github下载下来的压缩包解压，但今天仔细看了一下代码，才发现中间调用了AddtionalFile.java，用于生成orgInvertImage.tif，该代码又使用了InverTool.java，看来细节还是蛮多的。</p><p>我花了很长时间找annotationImage的原始出处，最终发现最有可能的来源是CCFv3，但下载后是nrrd格式，用ImageJ打开是矢状面。我在github、Allen社区以及文章提供的数据中下载到的模板和注释，打开后都是矢状面。晚上回到宿舍以后我还是不甘心，总觉得作者不应该没有提供冠状面的模板，我从nrrd这个文件格式入手，意外看到了一篇博客下面的评论，ImageJ里面可以查看stacks的正交视角！！！我试了一下，果然可以看到冠状面！</p><p>接下来的问题就是怎么把全脑冠状面存储为tif格式，昨天没想到好的解决办法，今天早上试了一下Allen提供的API，写了个循环获取冠状面（按顺序命名），然后用ImageJ读取Image sequence并存储为tif格式。（我没有找到BIRDS里面用的voxel是20µm的模板，但感觉问题不大~）</p><p>┭┮﹏┭┮ 今天早上喜提周六文献汇报，看论文去了！</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://atlas.brain-map.org/atlas?atlas=602630314">Allen Adult Mouse Brain Reference Atalases</a></li><li><a href="http://download.alleninstitute.org/informatics-archive/current-release/">CCFv3 资源</a></li><li><a href="http://help.brain-map.org/display/mouseconnectivity/API#API-DownloadAtlas3-DReferenceModels">Allen API</a></li><li><a href="http://download.alleninstitute.org/publications/allen_mouse_brain_common_coordinate_framework/">allen_mouse_brain_common_coordinate_framework</a></li><li><a href="https://blog.csdn.net/gaohanggaolegao/article/details/85222482">NRRD文件格式-基本定义</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ImageJ </tag>
            
            <tag> Java </tag>
            
            <tag> Eclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BIRDS插件代码学习【02】</title>
      <link href="/2023/07/04/imagej-plugin-2/"/>
      <url>/2023/07/04/imagej-plugin-2/</url>
      
        <content type="html"><![CDATA[<h1 id="ImageJ常用方法"><a href="#ImageJ常用方法" class="headerlink" title="ImageJ常用方法"></a>ImageJ常用方法</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建新的图像窗口</span></span><br><span class="line"><span class="type">ImagePlus</span> <span class="variable">lineImage</span> <span class="operator">=</span> NewImage.createByteImage(<span class="literal">null</span>, <span class="number">500</span>, <span class="number">300</span>, <span class="number">10</span>, NewImage.FILL_WHITE);</span><br><span class="line"><span class="type">ImageStack</span> <span class="variable">lineImageStack</span> <span class="operator">=</span> PreciseRegistration.lineImage.getImageStack();</span><br><span class="line">PreciseRegistration.lineImage.setStack(lineImageStack);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 展示图像</span></span><br><span class="line">lineImage.show();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查看stack的某一张</span></span><br><span class="line"><span class="comment">// getProcessor:Returns an ImageProcessor for the specified slice, where 1&lt;=n&lt;=nslices.</span></span><br><span class="line"><span class="type">ImageProcessor</span> <span class="variable">imageProcessor</span> <span class="operator">=</span> annotationImageStack.getProcessor(<span class="number">120</span>);</span><br><span class="line"><span class="type">ImagePlus</span> <span class="variable">myImg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ImagePlus</span>(<span class="string">&quot;ip2&quot;</span>, imageProcessor);</span><br><span class="line">myImg.show();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存图像</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">FileSaver</span>(PreciseRegistration.lineImage).saveAsTiff(GlobalValue.URL+<span class="string">&quot;/registration/precise/line.tif&quot;</span>);</span><br></pre></td></tr></table></figure><h1 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">创建一个 CountDownLatch 对象时，需要指定一个初始计数值，该计数值表示需要等待的线程数量。</span></span><br><span class="line"><span class="comment">每当一个线程完成了其任务，它调用 CountDownLatch 的 countDown() 方法，计数器的值就会减一。</span></span><br><span class="line"><span class="comment">当计数器的值变成 0 时，等待的线程就会被唤醒，继续执行它们的任务。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CountDownLatch;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test03</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">CountDownLatch</span> <span class="variable">count</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">5</span>);<span class="comment">//在线程执行完之前，会阻塞主程序的执行</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> i;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot; &quot;</span>+(num+<span class="number">1</span>));</span><br><span class="line">            count.countDown();</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            count.await();</span><br><span class="line">        &#125; <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            System.out.println(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Runtime.getRuntime().availableProcessors()); <span class="comment">// 返回可用的计算资源</span></span><br><span class="line">    System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 执行完毕···&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">输出结果：</span></span><br><span class="line"><span class="comment">Thread-0 1</span></span><br><span class="line"><span class="comment">Thread-4 5</span></span><br><span class="line"><span class="comment">Thread-3 4</span></span><br><span class="line"><span class="comment">Thread-2 3</span></span><br><span class="line"><span class="comment">Thread-1 2</span></span><br><span class="line"><span class="comment">16</span></span><br><span class="line"><span class="comment">main 执行完毕···</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><img src="https://img.cwxhmk.top/post/20230704-2.png" alt="使用多线程处理图像"></p><h1 id="脑片配准-fuseImage"><a href="#脑片配准-fuseImage" class="headerlink" title="脑片配准 fuseImage"></a>脑片配准 fuseImage</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">RGBStackMerge</span> <span class="variable">rgbStackMerge</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RGBStackMerge</span>();</span><br><span class="line">fuseImageStack = rgbStackMerge.mergeStacks(lenX, lenY, lenZ, downSampleImageStack, lineImageStack, <span class="literal">null</span>, <span class="literal">true</span>);</span><br><span class="line">PreciseRegistration.getPreciseregistration().fuseImage.setStack(fuseImageStack);</span><br></pre></td></tr></table></figure><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/post/20230704-7.png" alt="templateImage"><br><img src="https://img.cwxhmk.top/post/20230704-8.png" alt="invertImage"><br><img src="https://img.cwxhmk.top/post/20230704-3.png" alt="downSampleImage"><br><img src="https://img.cwxhmk.top/post/20230704-4.png" alt="annotationImage"><br><img src="https://img.cwxhmk.top/post/20230704-5.jpg" alt="lineImage"><br><img src="https://img.cwxhmk.top/post/20230704-6.png" alt="fuseImage"></p>          </div><h1 id="脑区识别"><a href="#脑区识别" class="headerlink" title="脑区识别"></a>脑区识别</h1><p><img src="https://img.cwxhmk.top/post/20230704-1.png" alt="鼠标悬停即可识别脑区"></p><h1 id="今日总结"><a href="#今日总结" class="headerlink" title="今日总结"></a>今日总结</h1><p>昨天看了一整天代码，今天再看这些java和ImageJ的方法就没有那么生疏了，今天还掌握了一个java新技能：多线程！（本科四年一直听说但从未使用过的谜之知识）。昨天研究了半天的ImageProcessor，今天发现BIRDS里很多地方也用到了，不过主要是对stack的处理。昨天发现界面中切换到precise面板时，会弹出配准后的脑片，即使不手动校正，效果已经能达到我的预期了，所以今天就从这个地方入手，希望能找到脑片配准的核心代码。</p><p>BIRDS中主要涉及了annotationImage、lineImage、fuseImage和downsampleImage这四组图片，脑片配准的效果就是通过合并downsampleImage和lineImage得到的。起初我主要在看脑区的轮廓线是如何得到的，似乎是遍历像素，特定位置赋为白色，但我最开始不懂为什么annotationImage会实现这种效果。后面我发现脑区识别也是获取鼠标位置以后根据像素灰度值与脑区进行匹配（提前存在一个excel文件里面），这些功能的实现都不算复杂，最关键的点就是如何给不同的脑区赋不同的颜色（虽然我还没有找到这部分代码，但大胆猜测是将脑图谱直接灰度化，不过怎么脑区和对应的灰度值是怎么得到的我还没想清楚）。</p><p>本以为图像预处理部分不是很重要，但今天的代码看下来，downsample部分是必须要看的，里面就包括我比较关心的annotationImage.tif，coarse部分也会得到一个类似的图像文件，只不过是和脑片配准之后的。明天可以重点看预处理这部分代码，慢慢来。</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://docs.oracle.com/javase/8/docs/api/overview-summary.html">Java™ Platform, Standard Edition 8 API Specification</a></li><li><a href="https://docs.oracle.com/javase/8/docs/api/java/awt/event/package-summary.html">Package java.awt.event</a></li><li><a href="https://docs.oracle.com/javase/8/docs/api/javax/swing/event/package-summary.html">Package javax.swing.event</a></li><li><a href="https://imagej.nih.gov/ij/developer/api/ij/ij/ImagePlus.html">Class ImagePlus</a></li><li><a href="https://imagej.nih.gov/ij/developer/api/ij/ij/gui/package-summary.html">Package ij.gui</a></li><li><a href="https://zhuanlan.zhihu.com/p/619615713">JAVA 多线程编程之CountDownLatch</a></li><li><a href="https://www.cnblogs.com/Andya/p/12925634.html">Java—CountDownLatch使用详解</a></li><li><a href="https://www.cnblogs.com/xiaofuge/p/14040715.html">Thread.start() ，它是怎么让线程启动的呢？ </a></li><li><a href="https://blog.csdn.net/u010519674/article/details/108435107">Java 线程计数器</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ImageJ </tag>
            
            <tag> Java </tag>
            
            <tag> Eclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BIRDS插件代码学习【01】</title>
      <link href="/2023/07/03/imagej-plugin/"/>
      <url>/2023/07/03/imagej-plugin/</url>
      
        <content type="html"><![CDATA[<h1 id="BIRDS简介"><a href="#BIRDS简介" class="headerlink" title="BIRDS简介"></a>BIRDS简介</h1><p><a href="https://github.com/bleach1by1/BIRDS_plugin">BIRDS</a>（Bi-channel Image Registration and Deep-learning Segmentation for efficient, versatile mapping of mouse brain）是ImageJ的一个插件，由费鹏老师实验室开发，主要用于小鼠脑片配准和细胞计数。BIRDS改进了脑片与图谱的配准算法，并借助Imaris实现了全脑的三维可视化。 </p><img src="https://img.cwxhmk.top/post/20230703-1.png" alt="BIRDS界面" width="50%" height="50%" /> <p>BIRDS主要包括downsample、coarse、precise、visual和setSeg五个部分，分别用于图像预处理、图片配准、可视化检查和手动校正以及脑区分割预测。</p><p>我关注的主要是前三部分，核心是脑片和图谱的配准，具体流程如下图。</p><p><img src="https://img.cwxhmk.top/post/20230703-2.png" alt="BIRDS脑片配准流程"></p><h1 id="Java-GUI-组件"><a href="#Java-GUI-组件" class="headerlink" title="Java GUI 组件"></a>Java GUI 组件</h1><h2 id="JPanel-面板"><a href="#JPanel-面板" class="headerlink" title="JPanel 面板"></a>JPanel 面板</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JPanel</span> <span class="variable">northPanel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>();</span><br></pre></td></tr></table></figure><h2 id="JLabel-标签"><a href="#JLabel-标签" class="headerlink" title="JLabel 标签"></a>JLabel 标签</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JLabel</span> <span class="variable">urlLabel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JLabel</span>(<span class="string">&quot;url:&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="JTextField-单行文本框"><a href="#JTextField-单行文本框" class="headerlink" title="JTextField 单行文本框"></a>JTextField 单行文本框</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JTextField</span> <span class="variable">urlText</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JTextField</span>(<span class="number">20</span>);</span><br></pre></td></tr></table></figure><h2 id="JOptionPane"><a href="#JOptionPane" class="headerlink" title="JOptionPane"></a>JOptionPane</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JOptionPane.showMessageDialog(<span class="literal">null</span>,<span class="string">&quot;Pay attention to the cache url!&quot;</span>,<span class="string">&quot;warning&quot;</span>,JOptionPane.WARNING_MESSAGE);</span><br></pre></td></tr></table></figure><h2 id="JTabbedPane"><a href="#JTabbedPane" class="headerlink" title="JTabbedPane"></a>JTabbedPane</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">JTabbedPane centerPanel;</span><br><span class="line"><span class="type">JPanel</span> <span class="variable">mypanel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>();</span><br><span class="line"><span class="type">Button</span> <span class="variable">mybutton</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Button</span>(<span class="string">&quot;import&quot;</span>);</span><br><span class="line">mypanel.add(mybutton);</span><br><span class="line">centerPanel.addTab(<span class="string">&quot;rawImg&quot;</span>, <span class="keyword">new</span> <span class="title class_">ImageIcon</span>(tabImage), mypanel);</span><br><span class="line">centerPanel.setSelectedIndex(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><h2 id="JButton-按钮"><a href="#JButton-按钮" class="headerlink" title="JButton 按钮"></a>JButton 按钮</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JButton</span> <span class="variable">urlButton</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;choose&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="JTextArea-多行文本框"><a href="#JTextArea-多行文本框" class="headerlink" title="JTextArea 多行文本框"></a>JTextArea 多行文本框</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JTextArea</span> <span class="variable">logText</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JTextArea</span>(<span class="string">&quot;Welcome!&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="JFrame-窗"><a href="#JFrame-窗" class="headerlink" title="JFrame 窗"></a>JFrame 窗</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">frame = <span class="keyword">new</span> <span class="title class_">JFrame</span>(<span class="string">&quot;BIRDS01&quot;</span>);</span><br><span class="line">frame.add(southJsp, BorderLayout.SOUTH);</span><br><span class="line">frame.add(centerPanel, BorderLayout.CENTER);</span><br><span class="line">frame.add(northPanel, BorderLayout.NORTH);</span><br><span class="line">frame.setSize(<span class="number">500</span>, <span class="number">600</span>);</span><br><span class="line">frame.setVisible(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//frame.setLocation(600, 300);</span></span><br><span class="line">frame.setLocationRelativeTo(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure><h1 id="组件触发事件"><a href="#组件触发事件" class="headerlink" title="组件触发事件"></a>组件触发事件</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">urlButton.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;o((&gt;ω&lt; ))o&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">centerPanel.addChangeListener(<span class="keyword">new</span> <span class="title class_">ChangeListener</span>()&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stateChanged</span><span class="params">(ChangeEvent e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;目前选中的是面板&quot;</span> + centerPanel.getSelectedIndex());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="获取ImageJ图片"><a href="#获取ImageJ图片" class="headerlink" title="获取ImageJ图片"></a>获取ImageJ图片</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ij.ImageJ;</span><br><span class="line"><span class="keyword">import</span> ij.IJ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ImageJ</span>(); <span class="comment">//打开ImageJ</span></span><br><span class="line">brainImg = IJ.getImage(); <span class="comment">//获取导入ImageJ的图片</span></span><br></pre></td></tr></table></figure><h1 id="今日总结"><a href="#今日总结" class="headerlink" title="今日总结"></a>今日总结</h1><p>不知道是不是因为把显示器搬到实验室的原因，今天工作非常有动力，面对BIRDS源码中超级多的包和类，一点都没有害怕，就奔着一个很小的目标去了：我要搞清楚这个插件是怎么获取到我导入ImageJ中的图片的。今天主要就是学习了BirdsPlugin.java这个文件的代码，对应的是BIRDS插件的GUI，组件布局和触发事件等都在这个文件里面。虽然还不太熟悉java中图像处理的一些方法，但今天学会了看API（要是有具体的使用示例就更好了），也是一个进步！</p><p>下一步还是要明确目标：学习脑片与图谱配准的算法！！！BirdsPlugin.java中case2要仔细读一下，我一切换到precise板块，极短的时间内就会弹出配准后的脑片序列，而且也不像提前存好的图片，这个tab触发的逻辑要仔细读一下。不过脑片与图谱配准的核心算法应该是在coarse那部分，明天认真读一下！！！</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://blog.csdn.net/coolyuan/article/details/107061996">JAVA中图片缩放getscaledinstance使其自适应JFrame</a></li><li><a href="https://docs.oracle.com/javase/8/docs/api/overview-summary.html">Java™ Platform, Standard Edition 8 API Specification</a></li><li><a href="https://docs.oracle.com/javase/tutorial/">The Java™ Tutorials</a></li><li><a href="https://blog.csdn.net/qq_21808961/article/details/80657491">Java GUI编程3—基本容器:JFrame</a></li><li><a href="https://blog.csdn.net/qq_21808961/article/details/80658063">Java GUI编程4—标签组件JLabel</a></li><li><a href="https://blog.csdn.net/qq_21808961/article/details/80667554">Java GUI编程7—其他容器</a></li><li><a href="https://blog.csdn.net/qq_21808961/article/details/80711384">Java GUI编程10—事件处理</a></li><li><a href="https://blog.csdn.net/qq_42103091/article/details/103746492">Java中的高级组件面板——JTabbedPane(选项卡面板)</a></li><li><a href="https://blog.csdn.net/m0_47646824/article/details/120607711">【通俗易懂学JAVA】——public void与public static void的区别</a></li><li><a href="https://blog.csdn.net/zht666/article/details/7869383">Java中@Override的作用</a></li><li><a href="https://www.cnblogs.com/yangzhou5/articles/12088096.html">图片处理——图片处理工具ImageJ(转)</a></li><li><a href="https://www.saoniuhuo.com/article/detail-210424.html">ij.ImagePlus.getProcessor()方法的使用及代码示例</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ImageJ </tag>
            
            <tag> Java </tag>
            
            <tag> Eclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>做选择</title>
      <link href="/2023/07/02/making-choices/"/>
      <url>/2023/07/02/making-choices/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>我不得不承认，除了友情上的一些小挫折，我的大学生活真的是太顺利了，似乎没有太用力就一步一步走到了保研升学这个岔路口。曾经我并没有觉得这样有什么问题，直到我读博一年以后，我愈发觉得做出明智的选择是多么重要，而大学时的我是多么稚嫩和无知。</p></div><h1 id="那些年少无知做出的选择"><a href="#那些年少无知做出的选择" class="headerlink" title="那些年少无知做出的选择"></a>那些年少无知做出的选择</h1><ol><li>关于学习：身边的老师、同学都说成绩很重要，学校的保研政策也只有加权排名这一项，我在大学的工作重心就只放在的课程学习上，准确的说是应试上。缺少了知识体系的构建和课程内容的实践，课程设计和实践项目代码也没有很好的归档，导致毕业以后沉淀的内容很少。</li><li>关于比赛：其实我一直对自己的能力没有太多自信，大家对计算机专业的第一印象就是编程能力强，可我却没参加过程序设计竞赛，除了学校开设的课程以外，我没有花额外的时间提升自己的编程水平。现在在课题组内做一些具体的任务，我可以很明显的感觉到解决问题没有一个完整的思路，写代码也离不开CSDN（呜呜呜），太丢人了！</li><li>关于自学：大学的时候，尤其是大三、大四的时候，我有大把的空余时间，明明知道项目很重要，机器学习和人工智能很火，但却始终没有学起来，网课反复观看前几集。我现在的数据分析大量需要机器学习的算法，导师天天提神经网络，可我脑子里却没有一个成型的概念。</li><li>关于文档：我大学里学习专业课程，每次考完试笔记和学习资料就扔一边了，从来没有试着整理成电子文档保存下来，或者和其他课程建立联系。课程设计完成以后代码就丢一边了，没有系统的保管代码。现在做项目需要用到以前的专业知识，我都差不多要重新学，知识储备干净地像一张白纸。</li><li>关于跨专业：我之前对专业没有什么概念，什么专业好，什么专业天坑，我都没怎么了解过。关于跨专业到神经生物学，我当时只是觉得我不是很喜欢用别人写好的模型做项目，我想有自己的东西，做研究也挺好的，这个专业挺需要计算机的，于是我就跨专业了。但我当时至少应该了解一下这个专业是干什么的，就业前景如何，也可以试着听几节神经生物学相关的课，看看自己是否对这个专业真的感兴趣。这样我也不会来到新的课题组之后不知道自己可以干什么，不知道自己对什么研究方向感兴趣，苦苦摸索。</li><li>关于选导师：保研那段时间，除了上科大是我主动联系的导师以外，我入营的其他学校都是老师主动联系的我。我当时很天真，我认为应该答应第一个联系我的老师，毕竟是这个老师先联系我的，却忽视了选导师最重要的是适合自己。如果时光机让我回到一年前，我会对当时的我说：了解一下这个老师的研究方向、课题组规模和人员配置、工资情况、有无科研助理、出勤要求、课题组氛围、课题组内部对导师的评价，不要不好意思问，不要轻易做决定，在提交系统之前，你有选择导师的主动权。</li><li>关于直博：当时脑院只招直博生，于是我稀里糊涂直博了。我知道直博只需要五年就可以拿到博士学位，但我不知道导师会上来就拿博士生的标准要求一个本科毕业的学生，不知道博士延毕的比例这么高，不知道博士读不完会一无所有。如果可以重来，我希望自己先读一个硕士，既可以从本科慢慢过渡提升自己的能力，也可以探索自己是否有意愿读博。既然走上了这条路，就好好地走下去吧！</li></ol><h1 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h1><ol><li>无论是做计划还是做选择，给自己至少三个选项，从中选最优的那一个</li><li>现在过得难一点是好事，未来或许会轻松一点</li><li>我们的记忆是有限的，学到的知识要及时整理，不要觉得麻烦，这些都是宝贵的财富</li><li>在决定做出改变之前，先进行原型设计，以最小的成本体验要做出的改变（有点类似于创业过程中的MVP）</li><li>不要害怕向别人寻求帮助和建议，事前暴露自己的无知也比掉坑里再呼救要好得多</li><li>时刻保持清醒</li><li>学习要有连续性，不要每个东西都只学个皮毛</li><li>成事之根本：行动起来</li></ol>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 思考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>图像风格迁移</title>
      <link href="/2023/06/26/style-transfer/"/>
      <url>/2023/06/26/style-transfer/</url>
      
        <content type="html"><![CDATA[<h1 id="数据集准备"><a href="#数据集准备" class="headerlink" title="数据集准备"></a>数据集准备</h1><p>按照该链接下载coco数据集的指定类，作为训练数据集。<a href="https://github.com/KaranJagtiani/YOLO-Coco-Dataset-Custom-Classes-Extractor">YOLO-Coco-Dataset-Custom-Classes-Extractor</a></p><h1 id="开源模型介绍"><a href="#开源模型介绍" class="headerlink" title="开源模型介绍"></a>开源模型介绍</h1><p>风格迁移模型参照该github开源项目。<a href="https://github.com/kleinicke/onnx_small_style">onnx_small_style</a> 。</p><ul><li>images&#x2F;目录下包含输入图片文件夹、输出图片文件夹及风格图片文件夹</li><li>model&#x2F;目录下有按特定风格图片及尺寸训练好的模型，可以直接使用</li><li>风格迁移在线demo1：<a href="https://vicalloy.github.io/image-transformer/">风格迁移网站</a></li><li>风格迁移在线demo2：<a href="https://huggingface.co/spaces/akhaliq/AnimeGANv2">风格迁移网站</a></li></ul><p><img src="https://img.cwxhmk.top/post/230626_1.png" alt="项目内容介绍"> </p><h1 id="模型训练及测试"><a href="#模型训练及测试" class="headerlink" title="模型训练及测试"></a>模型训练及测试</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用训练好的模型</span></span><br><span class="line">python neural_style/neural_style.py <span class="built_in">eval</span> --content-image images/content-images/birds.jpeg --model model/rain_princess.model --output-image images/output-images/birds_rain.jpg --cuda <span class="number">0</span> <span class="comment"># cpu</span></span><br><span class="line"><span class="comment"># 训练自己的模型</span></span><br><span class="line">python neural_style/neural_style.py train --dataset dataset --style-image images/style-images/girl.jpg --save-model-<span class="built_in">dir</span> model --epochs <span class="number">2</span> --cuda <span class="number">1</span> <span class="comment"># gpu</span></span><br></pre></td></tr></table></figure><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>训练过程中报内存不足时，考虑风格图片的尺寸是否过大，或者减小batchsize</li><li>如果使用自己的笔记本训练数据，最好不要使用完整的coco数据集，可以只选取某些类别的图像数据</li></ol>]]></content>
      
      
      <categories>
          
          <category> 项目实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 计算机视觉 </tag>
            
            <tag> Pytorch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬取网站数据</title>
      <link href="/2023/06/26/spider/"/>
      <url>/2023/06/26/spider/</url>
      
        <content type="html"><![CDATA[<h1 id="爬虫基本步骤"><a href="#爬虫基本步骤" class="headerlink" title="爬虫基本步骤"></a>爬虫基本步骤</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;https://www.google.com/&#x27;</span> <span class="comment">#以爬取谷歌页面为例</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537 36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Edg/114.0.1823.58&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">proxies=&#123;</span><br><span class="line">    <span class="string">&#x27;http&#x27;</span>:<span class="string">&#x27;http://127.0.0.1:10808&#x27;</span> <span class="comment">#依据本地代理端口填写地址</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.get(url=url, headers=headers, proxies=proxies)</span><br><span class="line"><span class="built_in">print</span>(r.status_code) <span class="comment">#200</span></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><h1 id="经验-●’◡’●"><a href="#经验-●’◡’●" class="headerlink" title="经验(●’◡’●)"></a>经验(●’◡’●)</h1><ol><li>静态页面一般可以直接通过get请求获得网页数据</li><li>需要js动态渲染的页面获取数据会稍微复杂一点，可以先查看返回的xhr或json文件是否有想要的数据（预览），或者ctrl+F搜索关键词</li><li>通过“发起程序”可以查看文件的请求程序发起链</li><li>爬虫的关键是抓包！找到我们感兴趣的数据！</li></ol><h1 id="应用案例1：爬取网站课件"><a href="#应用案例1：爬取网站课件" class="headerlink" title="应用案例1：爬取网站课件"></a>应用案例1：爬取网站课件</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://classroom.zju.edu.cn/pptnote/v1/schedule/search-ppt?course_id=49219&amp;sub_id=848702&amp;per_page=100&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span> : <span class="string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Edg/114.0.1823.43&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">page_num = <span class="number">2</span></span><br><span class="line">date = <span class="string">&#x27;20230615&#x27;</span></span><br><span class="line">save_dir = <span class="string">&#x27;D:/Desktop/ppt_img/&#x27;</span> + date + <span class="string">&#x27;/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(page_num):</span><br><span class="line">    params = &#123;<span class="string">&#x27;page&#x27;</span>:i+<span class="number">1</span>&#125;</span><br><span class="line">    r = requests.get(url=url, headers=headers, params=params)</span><br><span class="line">    <span class="comment"># print(r.status_code)</span></span><br><span class="line">    text = r.text</span><br><span class="line">    text_dict = json.loads(text)</span><br><span class="line">    ppt_list = text_dict[<span class="string">&#x27;list&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(ppt_list))</span><br><span class="line">    folder = os.path.exists(save_dir + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> folder:</span><br><span class="line">        os.makedirs(save_dir + <span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ppt_list)):</span><br><span class="line">        content = json.loads(ppt_list[j][<span class="string">&#x27;content&#x27;</span>])</span><br><span class="line">        img_url = content[<span class="string">&#x27;pptimgurl&#x27;</span>]</span><br><span class="line">        r = requests.get(img_url,headers=headers)</span><br><span class="line">        save_path = save_dir + <span class="built_in">str</span>(i) + <span class="string">&#x27;/&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;_&#x27;</span> + <span class="built_in">str</span>(j) + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(save_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:<span class="comment">#把图片数据写入本地，wb表示二进制储存</span></span><br><span class="line">            f.write(r.content)</span><br></pre></td></tr></table></figure><h1 id="应用案例2：爬取Allen小鼠脑图谱"><a href="#应用案例2：爬取Allen小鼠脑图谱" class="headerlink" title="应用案例2：爬取Allen小鼠脑图谱"></a>应用案例2：爬取Allen小鼠脑图谱</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://atlas.brain-map.org/atlasviewer/atlases/602630314/576985993.json&quot;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span> : <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Edg/114.0.1823.58&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.get(url=url, headers=headers)</span><br><span class="line"><span class="built_in">dict</span> = json.loads(r.text)</span><br><span class="line">num = <span class="built_in">len</span>(<span class="built_in">dict</span>[<span class="string">&#x27;msg&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;section_images&#x27;</span>])</span><br><span class="line">img_dict = <span class="built_in">dict</span>[<span class="string">&#x27;msg&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;section_images&#x27;</span>]</span><br><span class="line"><span class="comment"># print(img_dict[130][&#x27;path&#x27;])</span></span><br><span class="line">add_1 = <span class="string">&quot;https://atlas.brain-map.org/cgi-bin/imageservice?path=&quot;</span></span><br><span class="line">add_2 = <span class="string">&quot;&amp;mime=1&amp;zoom=3&amp;width=1140&amp;height=800&quot;</span></span><br><span class="line"></span><br><span class="line">save_dir = <span class="string">&quot;D:/Desktop/allen_img/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">    path = img_dict[i][<span class="string">&#x27;path&#x27;</span>]</span><br><span class="line">    img_url = add_1 + path[:-<span class="number">4</span>] + <span class="string">&#x27;_rendered.aff&#x27;</span> + add_2</span><br><span class="line">    r = requests.get(img_url, headers=headers)</span><br><span class="line">    save_path = save_dir + <span class="built_in">str</span>(i+<span class="number">1</span>) + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(save_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(r.content)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Stray Birds</title>
      <link href="/2023/03/11/stray-birds/"/>
      <url>/2023/03/11/stray-birds/</url>
      
        <content type="html"><![CDATA[<p>我至今还未在生活中遇到过一个见到鸟会和我一样兴奋的人，无论是眼前掠过的阴影，还是耳边传来的鸟啼，我都会忍不住抬头四处找寻源头。很多时候朋友会顺着我的目光，看一眼，“嗯”一声，然后继续之前的话题。其实，我曾经也不怎么关注“天上飞的”，只认得马路上随处可见的麻雀和阴雨天低飞的燕子，其余一律称为鸟。</p><p>除了麻雀和燕子，我认识的第一种鸟是喜鹊。大二阳光长跑，我常去河边的红色跑道，下午的阳光透过树木的枝叶照得跑道颜色更加鲜亮。我总能看见几只黑白相间、胖乎乎的鸟，在地上蹦跳着找食物。后来是好朋友根据我描述的特征，告诉我：全身黑的地方很黑，白的地方很白，个头中等的鸟就是喜鹊。从那以后，我就记住了，然后我惊奇地发现，校园里竟然有那么多喜鹊。</p><p>大学时，我在不懂得如何独处也不愿独处时不得不孤身一人。那时我最喜欢的事情就是在校园里闲逛，生活中偶然遇到的鸟带给我很多快乐。在西操场门口看到金翅雀展开的金黄色的翅膀，在大草坪前看到白鹡鸰在小水洼里梳理羽毛，走出宿舍惊奇地看到落在山楂树上的红嘴蓝鹊，和妈妈视频的时候意外发现脖子上一圈花纹的珠颈斑鸠，去北餐厅吃饭的路上看到立在树干上的啄木鸟，连着好多天去同一个地方终于拍到了鹊鸲···每次凭借着记忆里的特征百度搜索到看到的鸟时，我都觉得很有成就感。</p><p>爱看鸟的这个习惯被我带到了新的学校，很幸运每天去坐校车会有一段步行的路程，我有足够的时间和距离去感受清晨。我看到两只身体纤长的小鸟衔着树枝筑巢，一前一后，分工明确；我看到一只圆鼓鼓、白肚皮的小鸟没站稳，用嘴咬住一根细树枝荡到了下面的树杈上（我想那一刻小鸟是不是忘记了自己会飞）；我看到飞到半路的鸟突然在空中“刹车”、掉头回到原来停驻的树上···有时看着看着会笑出声来，发觉生命是多么奇妙啊！</p><p>大学毕业那天，我没有像平日里那么有仪式感，没有发什么感慨的小长文，而是直接坐上了去西安的高铁。在去车站的出租车上，我一直在哭，但我是快乐的。我想：终于解脱了。不会有恶语相加，不会有孤立无援，不会在路上边走边哭，不会再害怕睡觉时被人晃醒，都不会了。我可以去奔赴新的生活了。但我舍不得那些见过我伤疤、仍选择陪我一起对抗苦难的好朋友，舍不得那些一直肯定和鼓励我的老师，舍不得一起同窗四年的同学···</p><p>我常常想，除了学习之外，大学教会了我什么呢？杨绛先生曾说，世态人情，可作书读，可当戏看。也许我看了一场大戏，我是看客，却也是戏中人。我学会独处，一个人消遣时光也是一大幸事；我学会感恩，感激在我人生中某个阶段出现且对我施以最大善意的过客；我变得平和与知足，和过去相比，现在的自由生活仿佛是天堂。</p><p>我曾经的QQ昵称借用泰戈尔的《飞鸟集》（Stray Birds），但我想自己更愿意把stray birds翻译为离群的鸟，在人际关系上我不太主动，有时有些迟钝，但我愿意相信好的友情磁场一定是互相吸引的。会不会即使离群，仍有人作陪？</p><p>我相信一切能够听见<br>甚至预见离散，遇见另一个自己<br>而有些瞬间无法把握<br>任凭东走西顾，逝去的必然不返<br>请看我头置簪花，一路走来一路盛开<br>                            ——《生如夏花》</p>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Matlab常用命令</title>
      <link href="/2023/01/10/matlab-skills/"/>
      <url>/2023/01/10/matlab-skills/</url>
      
        <content type="html"><![CDATA[<ol><li>矩阵拼接<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>(<span class="number">2</span>,A,B) <span class="comment">% 相当于[A,B]</span></span><br><span class="line"><span class="built_in">cat</span>(<span class="number">1</span>,A,B) <span class="comment">% 相当于[A;B]</span></span><br></pre></td></tr></table></figure></li><li>去除重复元素<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">unique(A，<span class="string">&#x27;sorted&#x27;</span>) <span class="comment">% 去除重复元素，且升序排列（&#x27;sorted&#x27;一般省略）</span></span><br><span class="line">unique(A,<span class="string">&#x27;stable&#x27;</span>) <span class="comment">% 去除重复元素，不排序</span></span><br><span class="line">unique(A,<span class="string">&#x27;rows&#x27;</span>); <span class="comment">% 去除重复的行</span></span><br></pre></td></tr></table></figure></li><li>查找元素下标<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span>(X)：返回一个包含元素索引的向量</span><br><span class="line"><span class="built_in">find</span>(X,n)：返回 X 中元素的前n个索引</span><br><span class="line"><span class="built_in">find</span>(X,n,Direction)：根据Direction在X中找到n个索引，其中Direction-<span class="string">&#x27;first&#x27;</span>或<span class="string">&#x27;last&#x27;</span></span><br><span class="line">[row,col] = <span class="built_in">find</span>()：返回数组中元素的行列下标</span><br><span class="line">[row,col,V] = <span class="built_in">find</span>()：返回包含非零元素的向量V</span><br></pre></td></tr></table></figure></li><li>查看矩阵中是否有某个元素<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ismember</span>(<span class="number">1</span>,A) <span class="comment">% 若包含则返回值为1，否则为0</span></span><br></pre></td></tr></table></figure></li><li>打开matlab出现警告“名称不存在或不是目录”<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">edit pathdef <span class="comment">% 把对应的路径删掉即可</span></span><br></pre></td></tr></table></figure></li><li>保存变量<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">save(<span class="string">&#x27;abc.mat&#x27;</span>,<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;n&#x27;</span>) <span class="comment">% 将变量m和 保存到abc.mat文件</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Matlab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>愉快的周末</title>
      <link href="/2023/01/08/a-happy-weekend/"/>
      <url>/2023/01/08/a-happy-weekend/</url>
      
        <content type="html"><![CDATA[<p>前几天和小彤彤说好周末出去逛街，十点在百货大楼见面。我今天虽然出门比之前稍晚一会，但等公交并没有花很久，赶在约定的时间点前一分钟到达了目的地，然后又等了她十分钟左右。我早上只喝了玉米糊，她是根本没吃饭。我们在尚街逛到十一点左右，就去金鼎吃重庆火锅啦！店里有免费的甜品，番茄和牛油的鸳鸯锅锅底也很有卖相和食欲，我们点了双人套餐，又加了一份金针菇，后面写了好评，店家又送了两个炸蛋，太幸福了！！！套餐里食物种类不少，肉类也很新鲜，服务人员会及时加汤，我们两个都吃的饱饱的！吃完火锅有点渴，我们去了茶百道买奶茶，我点的店里的新品，喝起来有点像茶和奶酪的结合体。我们坐在店里休息的时候，有一对年纪很小的双胞胎一直看着我们笑，好可爱！休息好后我们一起去了商场，小彤彤帮我选了牛仔裤和毛衣，牛仔裤很有弹性，毛衣也是试了三件以后我最满意的一件，收获满满~</p><p>虽然我一年中大部分时间都不在聊城，但每次回家后都会想和好朋友见一面，一起吃好吃的，一起在热闹的地方逛一逛，一起聊聊天~(●’◡’●)我相信健康的友谊会让彼此受益！</p><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/post/230108_1.jpg"><br><img src="https://img.cwxhmk.top/post/230108_2.jpg"><br><img src="https://img.cwxhmk.top/post/230108_3.jpg"></p>          </div><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">今日小结 </summary><div class="toggle-content"><ol><li>今天大部分时间是在听小彤彤讲她的事情，有在小小践行《人性的弱点》中作者总结的与人交往的原则</li><li>给爷爷奶奶买的收音机到了，他们看起来很喜欢，很快就学会如何操作了！</li><li>给弟弟买了草莓蛋糕杯，他一口气吃完了，我猜测应该是好吃的</li></ol></div></details>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 游玩 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>取钱小记</title>
      <link href="/2023/01/06/draw-money/"/>
      <url>/2023/01/06/draw-money/</url>
      
        <content type="html"><![CDATA[<p>过年前陪爷爷奶奶去银行取钱，是我们之间的一个小默契。奶奶说，这钱是一部分是过年给小孩子们发压岁钱用的，剩下的留着用作年后日常花销。我们拿上银行卡和存折，走上十多分钟就可以到银行，顺利地话在自助取款机上就可以完成取钱任务。但偶尔也会有一些突发情况，需要存折、身份证但忘记带，或者不记得银行卡密码了···</p><p><strong>第一次取钱</strong></p><p>往年我都是放寒假回家，今年情况特殊，是临时变更学习场所，回家以后还要准备线上考试。在复习周的某天上午，爷爷奶奶提出想让我带他们去取钱，我想着当天剩下的复习任务不是很重了，便答应了。爷爷需要在中国银行取￥5000，奶奶需要在中国邮政储蓄银行取这一年的养老金。</p><p>我们家离银行很近，各大银行都在一条街上，相互离得也不远。我们先走到中国邮政，就想着先把奶奶卡里的钱取出来。结果我在自助取款机看卡的余额只有两块钱。银行的工作人员说可能是卡没有激活，需要存折才行。但奶奶出门没想那么多，只带了两张银行卡和两张身份证。爷爷心急，把奶奶说了一通，让奶奶回家取存折。奶奶本想和我们一起去中国银行取钱，但爷爷说她来回要很久，现在回家可以节省些时间，奶奶才迈着不太轻快的步伐回家了。</p><p>我和爷爷去中国银行取钱就比较顺利了，自助取款机上没有钱了，我们在大厅里的取款机上取的钱，有工作人员的热心服务，取钱任务很快就完成了。我和爷爷回到中国邮政门口，时不时张望着路口处有没有奶奶的身影，奶奶走路慢，年纪大了又不敢骑自行车，我们等了很久，才看到我们期待的身影。不过坏消息是，存折上查出来的余额依旧是两块钱。奶奶有些着急，念叨着：那我的老年金去哪里了？后来爷爷提出看看社保卡上有没有钱，我就拿着社保卡去自助取款机上试了一下，没想到养老金真在这个卡上！爷爷奶奶悬着的心终于放下了，取钱顺利完成！</p><p>之前从来没有用这张社保卡取过钱，谁能想到钱在这里呢？🥲</p><p><strong>第二次取钱</strong></p><p>第一次取钱结束后，我在饭桌上郑重声明，在我考试结束前谁都别来打扰我。于是，家里人真的让我清净了两天。上次从奶奶的社保卡里取了钱，爷爷一直想去看看他的社保卡里有没有钱，但我在忙考试就没敢提这个事情。昨天下午四点多考完试，爷爷奶奶还又找我确认了一遍：考完试这下你没什么事了吧？🤣</p><p>今天早上爷爷想让我带他查一下他的社保卡里有没有钱，我们拿着社保卡和身份证就出发了，想着应该很快就能回来。我在自助取款机上试了一下，密码竟然还是默认的卡号后六位数字，有了上次的经验，我知道是卡没激活。我们去找工作人员问了一下，激活需要本人到场，需要本人的身份证，但由于爷爷不会写字，我代签的话需要提供身份证。我想着既然来了就帮爷爷把这个事情办好，我让他在大厅坐着等我回去取身份证，爷爷还提醒我骑自行车来，比较快。</p><p>我也不知道来回花了多久，总之戴着口罩有点喘，进了大厅有点出汗。我看了柜台窗口上叫的业务号，我们当时领的号已经过去了，我就重新排了个业务号，前面有6个人。大部分都是老年人取钱的业务，所以没等多久就到我们了。工作人员一听说我要代签，很是诧异，对我爷爷说：大爷，我看你年纪也不大，自己的名字写不了吗？爷爷无奈地摇了摇头。我领了代签，一顿签字以后，爷爷一顿按手印。又是拍合照，又是录密码，又是点确认，前前后后花了半小时左右。</p><p>我当时回头望了下沙发上坐着的一群老年人，他们大部分都在看我们激活银行卡，我不知道他们是觉得我们太慢了，还是在羡慕爷爷有孙女陪着来，我自己更倾向于后者。(❁´◡&#96;❁)社保卡激活以后，我们麻烦工作人员查了下余额，没想到里面有两万多，透过口罩我都能感觉到爷爷的开心。爷爷没有取钱，查完余额我们就回家啦~</p><p>记得以前爷爷奶奶都是拜托爸爸帮他们取钱，不知道什么时候他们开始愿意让我带他们一起去取钱。和爷爷奶奶在一起时，我觉得自己是大孩子了，我可以在这个信息时代为他们抵挡一些风浪，我也很想被爷爷奶奶依靠！👵👧👴</p>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 家人 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>冬学期结束感想</title>
      <link href="/2023/01/05/end-of-winter-semester/"/>
      <url>/2023/01/05/end-of-winter-semester/</url>
      
        <content type="html"><![CDATA[<p>今天下午四点零五结束了冬学期的最后一门考试！考前的时间充实且紧张，可真到开考倒计时变为0时，一切紧张和焦虑就都被抛在身后，关注的只是考题和脑子里的知识。牵绊着我们的一件件事情结束时，会带给我一种很奇妙的感觉，我想是这件事情承载的关注与一切戛然而止造成的落差导致的。我会突然觉得似乎也没什么，再不愿面对的事情总归是过去了。该背的知识点再拗口也背下来了，再难理解的知识也照样听进去了，逼自己一把，没什么是不可能的。</p><p>下午系统自动收卷的那一刻，我感到非常释然，我终于可以回到没有考试任务的生活节奏中来了。每天全部的时间都可以自己安排，这下总不能说没什么做任务了，如果没有考试复习压力，我依旧没有推进任务，那问题就出在我身上了。虽然这段时间我在备考的过程中每天时间利用率都比较高，但我不知道没有了考试这个有紧迫时限且不得不去认真准备的事情之后，我能否把有效的时间用在科研任务上。</p><p>我很期待未来一段时间的实践，我想证明我可以。👍</p>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 考试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>及时按下暂停键⏸</title>
      <link href="/2023/01/03/press-stop-button/"/>
      <url>/2023/01/03/press-stop-button/</url>
      
        <content type="html"><![CDATA[<div class="note success flat"><p>牛顿第一定律：任何物体都要保持匀速直线运动或静止状态，直到外力迫使它改变运动状态为止。</p></div><p>我经常会想，要是生活有<code>replay button</code>该多好，要是我从大一就好好练习编程能力，是不是也有机会参加计算机的竞赛？要是我考完四六级以后听英语老师的话一鼓作气把英语的证书都考下来，或者没有就此把英语扔到一旁，我现在英语的听说读写是不是都超好？要是我坚持把收藏的网课看完，现在是不是已经成为跨界高手了？要是我把时间管理的好习惯坚持到今天，是不是面对多任务就游刃有余了？这种想法其实没有太大意义，时间不会重来，即使让我重新来过，我能否坚定地做出难而正确的选择呢？</p><p>相较于<code>replay button</code>，我认为<code>pause button</code>更常用且可操作性更高。原本拿起手机📱是想看一下群里的通知，却不知不觉看起了推送和短视频；明知道有很紧急的事情要做，却因为别人的一句批评而深陷消极情绪；明明知道任务A更重要，却仍选择将时间花在一个个无关紧要的事情上；本来只想网购一个本子，却不自主地挑起了衣服···这样的场景数不胜数，很多时候我们处于这种失控状态。这时我们需要做的是果断按下暂停键，防止负面情绪伤人伤己。</p><p>我们的大脑中有两个小人，小人A喜欢轻轻松松，小人B喜欢自我约束。我们的大脑乐于处于愉快且低能耗的状态，因此大多数情况下是小人A说了算，但这往往会让我们变得贪玩和懒散。当我们想做出改变时，小人A和小人B会在脑内开始打架，往往还是小人A获胜。就像我们在追剧时，想着看完这一集就去学习或者就去睡觉，但一集结束后，我们还未来得及打败那个想继续看下去的小人，下一级就自动播放了，这时我们往往会想，刚刚的剧情好精彩，不如就再看一集吧。</p><p>那小人B怎样才能打败小人A呢？以我个人经验而言，可以有两种方法。<strong>第一种</strong>，内心的小人在斗争时，再努力挣扎一下，强迫自己去做另一件可以带来正向影响的事情，在事件的切换中找回对生活的掌控感。就比如我今天下午复习的节奏很乱，经常被别人打断，但我又不能对家人发脾气，晚饭后没复习好的失落感配上饭桌上叽叽喳喳的说话声，我突然陷入一种极强的消极情绪，对什么事情都失去了兴趣，但我强迫自己把刚刚看的视频回放的重点总结出来，但此时心情还是不好，于是我又去洗了个澡（即使我心情不好什么都不想做，但我知道洗澡极大概率会让我的心情变好，于是我就去做了），洗完澡果然心情就恢复正常了，我又可以重新投入学习中了。<strong>第二种</strong>，借助外界刺激，这种往往是不可控的，而且是可遇不可求的。比如玩手机的时候老板发来消息问任务怎么样了，逛街时看到群消息确定了考试日期等，这种刺激往往会马上给小人B注入能量，从而促使我们立刻放下手头的玩乐活动，转而投入学习或者工作。</p><p>多审视自身状态，面对行为上的自我放逐，及时按下暂停键。</p><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">昨天晚上睡觉时的一点思考 </summary><div class="toggle-content"><ol><li>要想和比自己地位或能力高的人有效对话，首先要在认知领域上有相交，不要习惯做门外汉。</li><li>不要着急看到结果，把功夫花在关键事情上，改变自然就会发生。</li></ol></div></details>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 思考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>动态思维</title>
      <link href="/2023/01/02/dynamic-mind/"/>
      <url>/2023/01/02/dynamic-mind/</url>
      
        <content type="html"><![CDATA[<p>导师在某次组会上说，我手头的多个任务并不是互相孤立的，有的任务两两之间存在<mark class="hl-label green">联系</mark> ，比如arduino和Bpod两者配合实现动物行为的触发和记录，学懂了一方，会对另一方起到促进作用。自此以后，我变得有意识地关注事物之间的联系。我时常会在攻克某个小障碍之后豁然开朗，我不仅明白了事物背后的原理，而且看待其他问题时有了新的视角和思路。</p><p>说实话，我本身存在很强的定式思维，比如我拿到一个任务，如果周围人都说这个任务很难，而我恰巧在这方面也不是很自信，那我很可能就先入为主地认为自己无法很好地完成这个任务，在执行过程中就可能变得畏手畏脚。或者，我会从触发思绪的一个事件点（有可能只是一句话、一个通知、一张图片等）发散思考，悲观地认为很长一段时间甚至一辈子都会是这样。这种思考方式在我很小的时候就出现了，我小时候一直是短头发，我很羡慕别的女孩子头发长长的，扎起来又精神又好看，但我头发一长就会被妈妈带去理发店，我常常躺在床上想，结婚时短发穿婚纱会不会不好看？我会不会一辈子都是短头发呢？但事实是，我从初三就开始留长发了，在我自己有意愿且有能力自己扎头发以后，妈妈并没有阻拦过我留长发。回看过去，很多时候我们忽视了事物发展的动态性，<mark class="hl-label pink">有时只有站在较长的时间尺度上才能看见变化本身</mark> 。</p><p>这几天复习时，把老师讲课的视频回放又看了一遍。其实我上课时有认真听老师讲课，但有的老师讲课时间长，有的老师讲课语速快，有的内容我比较生疏，总之第一遍听下来，我几乎捕获不到老师讲课的框架和重点。渐渐地，这些课程回放在我眼中变成一个个凶狠的怪兽，我在临近期末考试时才不得不选择重新听课。神奇的是，第二次听课时，我发现这些课程之间很多内容是互通的，几乎每个老师都会介绍动作电位、突触以及膜片钳技术，有三位老师都讲到了长时程增强，有两位老师都讲到了量子释放，谷氨酸和GABA受体也是在各个老师口中常出现的词，一个一个回放看下来，似乎曾经在我眼里困难重重的神经生物学知识，变得条理清晰起来。各个老师的讲解互相补充和联系，知识点逐渐串联成了知识面。</p><p>我所说的<mark class="hl-label green">动态思维</mark> ，也可以说是成长型思维、主观能动性，或者用发展的眼光看问题，在我看来都是一个意思，就是要认识到我们所处的世界的在发展的，事物之间是相互联系而不是孤立的或一成不变的。我们总觉得自己的想法是正确的、有预见性的，但这往往很有迷惑性，我们往往容易忽视事物之间的联系，也很难用静止的思维去评判动态发展的事物。事物在变化，随着对事物的熟悉程度或思考深度增加，我们对事物的认识同样会发生变化。所以不要害怕困难，主动权掌握在我们手里，我们可以用积极的行动改变认知，进而影响任务的走向。</p>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 思考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023年的第一天</title>
      <link href="/2023/01/01/the-first-day-of-2023/"/>
      <url>/2023/01/01/the-first-day-of-2023/</url>
      
        <content type="html"><![CDATA[<p>前几天就计划好今天去东昌湖玩，只不过从下午改到了上午。其实往年元旦我都是在学校过的，三天的假期很少有机会回家。今年沾了疫情的光，去年十二月底就回家了，新的一年第一天，一家人就要整整齐齐出去玩！爸爸把车停到摩天轮里面的停车场了，我们就顺便在摩天轮附件逛着玩了一会。之前总是远远的看过摩天轮🎡，这是第一次看到正门，近距离看摩天轮时发现摩天轮转地好慢！没想到旁边还有一个小型的动物园，有好多匹白色的矮马🐎和各种颜色的孔雀🦚，有的小马的毛发还编了辫子，超级可爱🤩</p><p>一路向鼓楼走去，东昌湖结冰了，冰面上零星散落着砖块、摔炮盒和烟花桶，想必先前有很多人想来测试一下冰面的厚度吧，向远处望去，隐约看到一只水鸭踉跄地在冰面上走来走去，画面有些滑稽。本以为今天鼓楼这边会很热闹，没想到却是没多少人，路两侧布满了红色的摊位，出摊的却很少。大冷天的，冰糖葫芦的生意当属第一，比如我们就给商家贡献了五串糖葫芦🍡的交易。路边上有两个大爷在卖气球🎈，是短视频里很流行的花朵🌼笑脸气球，我想：要是康康带我来这里玩，肯定会给我买气球的！</p><p>今天又是喜欢给爷爷奶奶拍照的小陈同学( •̀ ω •́ )~抓紧复习去啦！！！🐇</p><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/post/lake%20(2).jpg"><br><img src="https://img.cwxhmk.top/post/lake%20(9).jpg"><br><img src="https://img.cwxhmk.top/post/lake%20(5).jpg"><br><img src="https://img.cwxhmk.top/post/lake%20(6).jpg"><br><img src="https://img.cwxhmk.top/post/lake%20(7).jpg"><br><img src="https://img.cwxhmk.top/post/lake%20(8).jpg"><br><img src="https://img.cwxhmk.top/post/lake%20(1).jpg"></p>          </div>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 游玩 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022年的最后一天</title>
      <link href="/2022/12/31/last-day-of-2022/"/>
      <url>/2022/12/31/last-day-of-2022/</url>
      
        <content type="html"><![CDATA[<p>今天早上赖床了，八点多才起床，早上依旧是喝玉米糊。妈妈今天倒班，白天一直在家。上午我磨蹭到九点才挪动到书桌旁边，开始背大型仪器的问答题，背了大概一小时左右，妈妈说一会陪她逛超市。我第一反应是拒绝的，因为今天安排的复习任务比较多，但妈妈第二次提出这个要求的时候我就同意了，毕竟妈妈很少有空逛超市。我午睡本来打算睡半小时的，结果愣是睡了一个半小时，午睡时长确实是一个大问题，怎么才能控制一下呢？每次醒来都发现下午也快过去了时，真的要命！下午把突触那一节的回放◀看了一遍，老师有划重点，视频大概两个小时左右，所以听起来并不费力。</p><p>晚上看到清一色复盘2022的推文，复习的心❤️一下子乱了，总想再看看人民日报制作的年度温暖视频，再看会搞笑的脱口秀，可是复习的重任和一周一度的周报和组会在心头压着，我突然emo😈起来，逮住男朋友就开始找事。磨蹭到晚上九点才开始继续复习，看了一部分神经环路的视频，然后开始看学习记忆的视频（这个老师有明确说考题）。复习着复习着，就到晚上十一点了，拖延真的是无形中对我们的消耗。很多时候我们一些令人费解的行为，比如一直刷视频、想寻求刺激、觉得身体疲惫等等，可能只是在拖延时间，借此逃避高压的现实。但实际上拖延是在为现实增负，大脑🧠习惯沉溺在舒适区，这就注定成长和突破是要付出一些代价的。</p><p>最近我每天都用<mark class="hl-label pink">Forest</mark> 软件记录时间，主要是学习、工作和写博客三大块。我每天都忙活到十一点多，但一看一天的专注时长才三小时左右，不禁感叹时间都去哪儿了？我是不是也在假装很努力，实际上浪费了很多时间呢？前几天写2022年年度复盘时，我给2023年定的主题词是“告别拖延”，我希望这次不仅是说一说，而是真正落实到每一天的生活中，落实到每一个任务中。明年的课程会少很多，要尽快转入科研主线，多做一些为自己增值的事情，少一些无理取闹和胡思乱想。多读书，多写作，多思考，多实践，多锻炼。希望新的一年我可以<mark class="hl-label pink">交到好朋友</mark> ，培养一门兴趣爱好，情绪也更加稳定。无论所处环境如何，要始终热爱生活，踏实做事，真诚待人，逐渐变成自己喜欢的样子。</p><p>最后借用总书记新年贺词中的一句话结尾，路虽远，行则将至；事虽难，做则必成。祝愿大家身体健康、新年快乐、皆得所愿！</p>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2022年度总结</title>
      <link href="/2022/12/28/my-2022/"/>
      <url>/2022/12/28/my-2022/</url>
      
        <content type="html"><![CDATA[<h1 id="2022我是怎么度过的"><a href="#2022我是怎么度过的" class="headerlink" title="2022我是怎么度过的"></a>2022我是怎么度过的</h1><h2 id="1月"><a href="#1月" class="headerlink" title="1月"></a>1月</h2><ul><li>抓拍了几张小侄女在我家玩的照片，打印出来以后她超级喜欢</li><li>和爸爸、弟弟还有奶奶一起去了月季公园，玩了呐喊喷泉，还发现了一群鸽子🕊</li><li>爸爸给我买了草莓🍓糖葫芦，嘻嘻嘻</li><li>和小彤彤吃了海底捞，看了电影🎞️《李茂扮太子》（当时是在是没什么电影可看了）</li><li>楼下有小朋友打雪仗，年轻真好</li><li>买了手机支架，正好在奶奶包馄饨时录了个视频，就是手机美颜有点重了</li></ul><h2 id="2月"><a href="#2月" class="headerlink" title="2月"></a>2月</h2><ul><li>全家出动去月季公园看花灯，逞能玩射箭🏹结果弓都拉不开，箭直接掉出来了，丢人</li><li>和爸爸还有弟弟一起放风筝🪁，我不理解：难道跑不快就放不起来风筝吗？</li><li>和周敏还有王茹冰一起吃了火锅，收到了她们送的生日礼物🎁</li><li>和雨曦一起拼好了积木，摁零件摁地手疼</li><li>一家人在赶海人为我过了21周岁的生日，嘻嘻嘻</li><li>情人节前一天爸爸去给妈妈买项链，顺便给我买了一条手链！手上戴着四叶草🍀，天天都是幸运girl！</li><li>和小彤彤一起吃了串串，看了电影🎞️《这个杀手不太冷静》</li><li>收到了康康送的耳机，不过不太习惯全入耳式的耳机</li><li>在忙毕业设计里小鼠体态识别的实现！</li></ul><h2 id="3月"><a href="#3月" class="headerlink" title="3月"></a>3月</h2><ul><li>妇女节前一天收到了康康送的一大捧花，玫瑰的颜色好温柔🥰</li><li>百合花开了，味道太浓郁，只能放在阳台散散味道了</li><li>神奇的物物交换：西红柿、草莓、牛油果🥑</li></ul><h2 id="4月"><a href="#4月" class="headerlink" title="4月"></a>4月</h2><ul><li>给大一的同学做经验分享，结束后收到了冯导给我准备的礼物！📕</li><li>毕业实习时数据库被黑客删了，网络安全很重要哇！</li><li>在宿舍门口拍到了红嘴蓝鹊，我愿称之为目前见过的最美的鸟~</li></ul><h2 id="5月"><a href="#5月" class="headerlink" title="5月"></a>5月</h2><ul><li>学校的古树上挂满了心愿卡，我总喜欢饭后逛着看一看大家的愿望</li><li>筹备并拍摄毕业证，用班费给每个人买了一束玫瑰花🌹</li><li>和裴焱一起做了美甲💅，我们选的都是兔子，哈哈哈</li><li>拍到了粉紫色的天空！</li></ul><h2 id="6月"><a href="#6月" class="headerlink" title="6月"></a>6月</h2><ul><li>毕业答辩，是校优嘿嘿~</li><li>小李约我在西区跳蚤市场见面，送了我一个贝壳，嘿嘿</li><li>全校组织各个学院拍毕业照，那天阳光很刺眼，照片里很多人眼睛都没睁开</li><li>交完毕设材料，第二天我就去西安找康康啦！实现了一起在城墙上骑车的愿望！我竟然还进了创新港！</li><li>大四下，国华因为疫情没能回学校，我们约好了在西安见面，去了海洋馆，还一起看了电影🎞️《坏蛋联盟》</li><li>拿到驾照啦，不过至今还没碰过车🚗</li><li>知道我快去杭州了，舅舅请我们吃了一顿大餐！</li><li>月底，爸爸妈妈担心我一个人，硬是要陪我一起去杭州，路线：聊城-济南-济南西-杭州东。那时候我还不懂换乘，只记得我们到杭州以后地贴坐过站了，出了地铁又找不到良渚实验室的位置，天很闷热，汗水把眼睛都弄湿了，最后在手机电量耗尽时终于找舍友拿到了钥匙🔑</li><li>爸爸妈妈跟团去乌镇和西湖旅游，他们给我买了好多特产，回聊城前带我吃了顿好吃的，不过那家店比较坑···</li></ul><h2 id="7月"><a href="#7月" class="headerlink" title="7月"></a>7月</h2><ul><li>我有自己的工作牌了，也收到了浙江大学的录取通知书~</li><li>在肥叔充了100块钱，喜欢吃店里的锅贴</li><li>开始学习3D建模，陆陆续续完成了一些小任务，找到了一点点成就感</li><li>月底请了五天假，和康康回家见家长啦！幸福幸福幸福！一起遛弯，一起淋雨，一起等蛋糕，一起给玩偶涂颜色，一起吃超好吃的烤肉，一起踩点去看电影🎞️《独行月球》···</li></ul><h2 id="8月"><a href="#8月" class="headerlink" title="8月"></a>8月</h2><ul><li>七夕收到了爸爸给的红包还有康康送的项链~</li><li>去北京参加暑期培训，CNeuro 2022，被一群大佬虐了十天，呜呜呜</li><li>小李趁周末来找我玩，一起吃了火锅，还送了我一捧橘色泡泡！</li><li>知道医院健身房位置之后，经常早起去打卡2公里~</li></ul><h2 id="9月"><a href="#9月" class="headerlink" title="9月"></a>9月</h2><ul><li>搬进学校宿舍啦，是双人间，舍友人也很nice~</li><li>临近中秋节，收到了来自食堂和学校的月饼投喂！</li><li>收到了小彤彤送的《云彩收集者手册》，没想到同门师姐也是一位云彩爱好者，嘿嘿~</li><li>参加了新生典礼和开学典礼，小夜灯汇成一片蓝海也太震撼了！要做灿若星辰的浙大人！</li><li>心血来潮去了西湖，这应该是我今年最肆意洒脱的一次，啃烧饼、看西湖、逛苏堤、看老年人舞蹈团表演，人与人之间的🔗好温暖！</li><li>和佳宁学姐还有孟子杰一起吃了烧烤，啥时候我也把我家康康带上呐？</li><li>看了校史大戏《求是魂》，当时不知道还要抢票就直接去了，被社团工作人员偷偷放进去了</li></ul><h2 id="10月"><a href="#10月" class="headerlink" title="10月"></a>10月</h2><ul><li>国庆去西安找康康了，打卡永兴坊！一起冒着雨在生意火爆的铁锅炖门口等餐、一起吃了超级赞的自助、一起看了电影🎞️《万里归途》···</li><li>发现了学校的向日葵🌻，一位老师热心地帮我拍了好多张站在向日葵花海中的照片！</li><li>跨专业听课好难，哭了😭</li><li>在操场跑完两公里，紧接着点了一份鸭血粉丝汤，罪恶！</li><li>看何婷师姐切小鼠脑片，不知道以后我会不会做生物实验呢？</li><li>学校的桂花开了，校园里香香的，阳光照下来时，小小的花亮亮的</li><li>收到了康康送的丑萌的“羊了个羊”蛋糕，不过超级好吃！</li></ul><h2 id="11月"><a href="#11月" class="headerlink" title="11月"></a>11月</h2><ul><li>魔鬼考试周，为什么浙大的一学期只有两个月，┭┮﹏┭┮</li><li>打卡西溪国家湿地公园，小孩子比较多，没逛太久就回去了</li><li>给爸爸订了一个兔子🐇蛋糕，太可爱了，哈哈哈，不过以后还是顺着大人的心意多来点实在的水果吧！</li><li>下课后幸运地看到了完整的日落🌇，各个阶段都绝美！</li><li>排练校歌，嗓子经不起折腾，唱一会就会哑，谁懂？！</li><li>当英语助教了，虽然只是一个1学分的小课，但还是想尽力和英语有多一点的联系</li><li>强迫妈妈听我用平板弹生日快乐歌，哈哈哈</li><li>听了陈嘉映和孙周兴两位老师关于“哲学与大学”的讲座，结束后堪称大型粉丝见面会</li></ul><h2 id="12月"><a href="#12月" class="headerlink" title="12月"></a>12月</h2><ul><li>紫金港因疫情封校一周，每顿饭送到门口也太幸福了！</li><li>杭州下雪了🌨，不过我们还在封控，只能站在阳台看雪。舍友是南方人，确实很兴奋~</li><li>行程卡下线了，不查核酸了，新冠改名了···魔幻的2022！</li><li>师兄博士答辩完请我们吃饭！每道菜都很好吃！</li><li>我回家了，我阳🐏了，我阳康了。嗓子疼真要命，还好我们家经常熬冰糖梨水~</li></ul><h1 id="2022年到处拍拍拍"><a href="#2022年到处拍拍拍" class="headerlink" title="2022年到处拍拍拍"></a>2022年到处拍拍拍</h1><h2 id="天空"><a href="#天空" class="headerlink" title="天空"></a>天空</h2><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/2022/sky%20(1).jpg"><br><img src="https://img.cwxhmk.top/2022/sky%20(2).jpg"><br><img src="https://img.cwxhmk.top/2022/sky%20(3).jpg"><br><img src="https://img.cwxhmk.top/2022/sky%20(4).jpg"><br><img src="https://img.cwxhmk.top/2022/sky%20(6).jpg"><br><img src="https://img.cwxhmk.top/2022/sky%20(7).jpg"><br><img src="https://img.cwxhmk.top/2022/sky%20(8).jpg"><br><img src="https://img.cwxhmk.top/2022/sky%20(9).jpg"><br><img src="https://img.cwxhmk.top/2022/sky%20(11).jpg"></p>          </div><h2 id="美食"><a href="#美食" class="headerlink" title="美食"></a>美食</h2><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(1).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(2).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(3).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(4).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(5).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(6).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(7).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(8).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(9).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(10).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(11).jpg"><br><img src="https://img.cwxhmk.top/2022/%E7%BE%8E%E9%A3%9F%20(12).jpg"></p>          </div><h2 id="臭美"><a href="#臭美" class="headerlink" title="臭美"></a>臭美</h2><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/2022/%E8%87%AD%E7%BE%8E%20(1).jpg"><br><img src="https://img.cwxhmk.top/2022/%E8%87%AD%E7%BE%8E%20(2).jpg"><br><img src="https://img.cwxhmk.top/2022/%E8%87%AD%E7%BE%8E%20(3).jpg"><br><img src="https://img.cwxhmk.top/2022/%E8%87%AD%E7%BE%8E%20(4).jpg"><br><img src="https://img.cwxhmk.top/2022/%E8%87%AD%E7%BE%8E%20(5).jpg"><br><img src="https://img.cwxhmk.top/2022/%E8%87%AD%E7%BE%8E%20(7).jpg"></p>          </div><h2 id="和朋友"><a href="#和朋友" class="headerlink" title="和朋友"></a>和朋友</h2><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/2022/%E6%9C%8B%E5%8F%8B%20(1).jpg"><br><img src="https://img.cwxhmk.top/2022/%E6%9C%8B%E5%8F%8B%20(2).jpg"><br><img src="https://img.cwxhmk.top/2022/%E6%9C%8B%E5%8F%8B%20(3).jpg"><br><img src="https://img.cwxhmk.top/2022/%E6%9C%8B%E5%8F%8B%20(4).jpg"><br><img src="https://img.cwxhmk.top/2022/%E6%9C%8B%E5%8F%8B%20(6).jpg"><br><img src="https://img.cwxhmk.top/2022/%E6%9C%8B%E5%8F%8B%20(7).jpg"><br><img src="https://img.cwxhmk.top/2022/%E6%9C%8B%E5%8F%8B%20(8).jpg"><br><img src="https://img.cwxhmk.top/2022/1.jpg"><br><img src="https://img.cwxhmk.top/2022/2.jpg"></p>          </div><h2 id="和康康"><a href="#和康康" class="headerlink" title="和康康"></a>和康康</h2><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/2022/%E5%92%8C%E5%BA%B7%E5%BA%B7%20(1).jpg"><br><img src="https://img.cwxhmk.top/2022/%E5%92%8C%E5%BA%B7%E5%BA%B7%20(2).jpg"><br><img src="https://img.cwxhmk.top/2022/%E5%92%8C%E5%BA%B7%E5%BA%B7%20(3).jpg"><br><img src="https://img.cwxhmk.top/2022/%E5%92%8C%E5%BA%B7%E5%BA%B7%20(5).jpg"></p>          </div><h2 id="小确幸"><a href="#小确幸" class="headerlink" title="小确幸"></a>小确幸</h2><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/2022/lucky%20(1).jpg"><br><img src="https://img.cwxhmk.top/2022/lucky%20(2).jpg"><br><img src="https://img.cwxhmk.top/2022/lucky%20(3).jpg"><br><img src="https://img.cwxhmk.top/2022/lucky%20(4).jpg"><br><img src="https://img.cwxhmk.top/2022/lucky%20(5).jpg"><br><img src="https://img.cwxhmk.top/2022/lucky%20(6).jpg"><br><img src="https://img.cwxhmk.top/2022/lucky%20(7).jpg"></p>          </div><h1 id="关于2022，我想说"><a href="#关于2022，我想说" class="headerlink" title="关于2022，我想说"></a>关于2022，我想说</h1><p>记得年初时我买了一个手账本，附带的卡片上说我今年的主题词是“繁花”，我心想，2022一定会是极好的一年，事实证明的确如此。回顾这一年，上半年是告别，下半年是新生。大学毕业于我而言，一半是逃离，一半是不舍。无论如何，我在太原理工大学的生活画上了句号。我的所谓毕业旅行很短，也没有鼓足勇气和康康去拍写真，在家也没有待很久，就匆匆收拾行囊赶赴了下一站——杭州。新学校很美，学校很包容、很智能、很自由，我在学习之余增加了许多生活中的新奇体验，变得更加独立和勇敢。不过谈到科研，说实话我还没有完全适应跨专业的生活，我花了很长时间适应新身份——神经生物学专业的学生，熟悉新的领域，摸索如何将计算机领域的知识用在生物方面，初学硬件知识···但我现在还是很难平衡好课程和实验室任务，面对许多任务会丧失行动力，对自己的定位和认知还有些模糊，不过也逐渐习惯了和老板的相处之道。小陈同学，要愈挫愈勇才行，你的福气在后头！</p><h1 id="你好，2023"><a href="#你好，2023" class="headerlink" title="你好，2023"></a>你好，2023</h1><p><strong>主题</strong>：告别拖延<br><strong>目标</strong>：10部电影➕10本书➕定期复盘</p>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 年度总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>英语结课感想</title>
      <link href="/2022/12/27/English-class/"/>
      <url>/2022/12/27/English-class/</url>
      
        <content type="html"><![CDATA[<p>今天研究生英语结课了，明天把第五组的推文发出来，我助教的工作就完全结束了，竟然有些舍不得。虽然选课时因为六级成绩过期导致无法免修英语，心里有些不甘，但对英语本身我是不排斥的，我喜欢通过英语这个媒介加强与老师和同学们的交流。一直以来口语都是我的心病，我很想得到别人的认可，却又始终不敢开口讲英语，于是<code>My spoken English is poor</code>这句话就常常挂在嘴边，时间久了真就觉得自己口语不行。</p><p>在这八周的英语课上，无论是线上还是线下，课堂互动总是少不了的。最开始上课时小组讨论时不好意思开口讲英语，老师问问题也不敢大声回答，我多少有些不习惯这种形式的英语课堂，我习惯在传统课堂上当一个认真听课的好学生，在需要<mark class="hl-label green">英语大量进口和出口</mark> 的课堂上我不确定能否表现好。后来我才意识到，最初的想法太天真了，回答个问题有啥的？难的在后头！上台配音、一起唱歌、根据话题极限写稿，英语课堂永远花样形式多变，不知不觉中和小组同学的关系就近了，也更能融入课堂氛围了。</p><p>我平时不是一点英语都不看的那种，TED演讲、美剧、电影都会看，只不过会看字幕，英语输入的量也不是很大。还记得老师第一次课问我们看过多少个TED演讲，超过50个的举手🙋‍，我当时一直在脑子里数看过的演讲个数，我知道我看过不少，但脑子里没有确切的数字，也就没敢举手。说实话我自认为我的英语发音还可以，所以课堂上或者随堂作业有稿子的时候，我都很放松，感觉处于自己的舒适区中，甚至狂妄地认为这个课对我的英语提升不会有太大帮助。</p><p>但是我想错了，老师拥有一套完整的方法论。从引入<code>how to speak English in public</code>这一主题，到<code>passion</code>、<code>pronunciation</code>、轻重缓急之区分度、<code>sentence</code>、<code>structure of a paragraph</code>、<code>acting</code>，循序渐进，最终带领我们呈现一个完整的英语演讲，我总能学到新的东西。每周一晚上大家一起往群里发随堂作业时，我偶尔会心血来潮把每个人的都点开看一遍，总有比我讲的好的同学，每次都会有新的体验和收获。</p><p>虽然我最后考核时的表现并不完美，一开始有点紧张卡词，表情可能也没有很自然，肢体语言不知道是否清楚恰当，不管怎样，我还是尽我所能顺利完成了考试，给冬学期的英语课程画上了完整的句号。</p><p>老师说，<code>Hope you&#39;ll keep climbing</code>。我相信，英语会在未来的路上一直陪伴着我！</p>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 课程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>本地文件上传到Github</title>
      <link href="/2022/11/12/upload-doc2github/"/>
      <url>/2022/11/12/upload-doc2github/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>前提：已安装Github Desktop</p></div><ol><li>通过Github Desktop新建仓库(Create new repository)，在本地会新建一个与仓库同名的文件夹</li><li>将带上传的文件代码放入新建的本地文件夹</li><li>通过Github Desktop上传到Github远程仓库</li></ol><div class="note success flat"><p>PS：也可以直接在Github创建仓库，然后克隆仓库，后续步骤同上2-3～</p></div>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>模型加工方法汇总</title>
      <link href="/2022/09/21/solidworks-model-summary/"/>
      <url>/2022/09/21/solidworks-model-summary/</url>
      
        <content type="html"><![CDATA[<div class="note blue no-icon flat"><p><strong>3D打印</strong></p><ol><li>文件格式：STL</li><li>加工尺寸：厚度和孔径最低0.5mm</li><li>加工工艺：逐层打印</li><li>注意⚠️<ul><li>.sldprt文件转为.stl文件之后，一般需要通过magics软件扫描并修复问题</li><li>一般只需向加工方提供.stl文件</li><li>3D打印出的螺纹误差较大</li><li>孔的尺寸过小会堵住，一般需要1mm以上</li></ul></li><li>加工方： 未来工场</li></ol></div><div class="note pink no-icon flat"><p><strong>铝合金加工</strong></p><ol><li>文件格式：STEP</li><li>加工精度：±0.1mm或±0.05mm</li><li>加工工艺：轧制、挤压、拉伸和锻造等</li><li>注意⚠️<ul><li>最好提前向加工方说明零件用途及加工精度，以免出现较大误差导致返工</li><li>需向加工方提供.step文件和工程图纸</li><li>铝合金加工精度较高，不可随意修改尺寸</li><li>最终目的：加工出来的零件能用！🥲</li></ul></li><li>加工方： inper（加工慢但质量高）或速加网（加工教快但略粗糙）</li></ol></div><div class="note orange no-icon flat"><p><strong>有机玻璃（亚克力板）加工</strong></p><ol><li>文件格式：pdf</li><li>加工工艺：切割（误差大概±1mm）</li><li>注意⚠️<ul><li>一般只需向加工方提供工程图纸</li></ul></li><li>加工方： 淘宝克洛蒙旗舰店</li></ol></div>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SolidWorks </tag>
            
            <tag> 公差 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo迁移至新电脑</title>
      <link href="/2022/09/20/hexo-move/"/>
      <url>/2022/09/20/hexo-move/</url>
      
        <content type="html"><![CDATA[<ol><li>下载<a href="https://desktop.github.com/">GitHub Desktop</a>并登陆GitHub</li><li>将博客所在GitHub仓库clone至本地</li><li>下载并安装<a href="https://sourceforge.net/projects/git-osx-installer/">Git</a></li><li>下载并安装<a href="https://nodejs.org/en/">Node.js</a>稳定版</li><li>在Github&#x2F;blog文件目录下安装hexo及相关插件<div class="note info flat"><p>需要以管理员权限进入终端，不然运行下面的命令会报错哦～🫣</p></div><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br><span class="line">npm install</span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></li><li>测试<div class="note info flat"><p>测试能否通过github desktop正常推送博客！推送成功就说明迁移成功✅啦～</p></div><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo s # 测试本地预览</span><br><span class="line">hexo new &quot;test&quot; # 测试发布新文章</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>初来浙里，我曾经的那些疑惑</title>
      <link href="/2022/09/15/zjuer-questions/"/>
      <url>/2022/09/15/zjuer-questions/</url>
      
        <content type="html"><![CDATA[<details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">1.暑假可以搬进学校宿舍吗？</summary><div class="toggle-content"><p>其实是可以申请的，不过我们组没有科研助理，很多流程和手续都不太清楚，所以暑假期间我还是老老实实住在老师给租的房子里了。<br><a href="http://www.cmm.zju.edu.cn/2023/0317/c38820a2730227/page.htm">医学院提前来校学生申请入驻浙大审批流程（更新）</a></p></div></details><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">2.怎么知道班内同学和辅导员？</summary><div class="toggle-content"><p>临近开学的时候，医学中心拉了个博士班的群，稀里糊涂就和同学们在一个群里了。至于辅导员的话，最开始是辅导员在钉钉上提醒我去做核酸，我才知道辅导员是谁的，后面也主要是辅导员在群里和我们下发通知。</p></div></details><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">3.工资怎么发放？</summary><div class="toggle-content"><p>工资由两部分组成，学校发一部分（比例大），导师发一部分（比例小），良渚实验室会有￥1000路费补贴。</p></div></details><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">4.紫金港校区（申花路）是哪个门？</summary><div class="toggle-content"><p>东2门~</p></div></details><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">5.开学后可以办校园卡吗？</summary><div class="toggle-content"><p>可以的，新生入学那天，电信和移动都会在外面搭小帐篷，两者的套餐类似，每个月花费￥29，流量超多，通话时长超多，每个月还可以从给定app（爱奇艺、优酷、哔哩哔哩等）中任选一个充会员，真香！</p></div></details><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">6.宿舍有空调、吹风机和洗衣机吗？</summary><div class="toggle-content"><p>宿舍有空调，需要自行租赁（￥450一年）；一楼有公共吹风机，宿舍内使用吹风机也不会出现跳闸断电的情况；一楼有公共洗衣机，宿舍内也可以申请安装洗衣机。</p></div></details><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">7.体检是在什么时候？</summary><div class="toggle-content"><p>入学后第二天就可以体检了，需要提前预约。体检的整个过程也很快，十几分钟就可以测完。😭我最后悔的一件事情就是，先抽了血，又去测其他项目，结果中途没止住血，当天又提了重物，导致胳膊上很严重的淤血···</p></div></details><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">8.怎么选课？</summary><div class="toggle-content"><p>研究生迎新网站有选课的安排通知，按时间点来就可以。不过要注意，第一阶段是初选阶段，选课不分先后；初选结束后是初选确认阶段，可以得知自己有没有选上课，选上的课显示“正在修读”，没选上的课是“未选”；下一个阶段是补（退）选阶段，这个时候就是拼网速和手速了，课程有容量的话一般可以选上，不然就只能候补了；选课结果公布以后，课程才算最终确定哦~</p></div></details><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">9.怎么找到上课的地点？</summary><div class="toggle-content"><p>来到宿舍会领到一张学校的手绘地图（我太爱了），趁着刚开学比较清闲，多在学校逛一逛、走一走，对照着地图认一认建筑物，上课的时候就不怕找不到路啦~😎上课地点主要是东教学楼、西教学楼和研究生楼，实验课的话可能会安排在医学院。</p></div></details><details class="toggle" style="border: 1px solid pink"><summary class="toggle-button" style="background-color: pink;">10.学校食堂怎么样？</summary><div class="toggle-content"><p>学校的食堂超级多，有银泉餐厅、东区食堂、澄月餐厅、玉湖餐厅、麦香餐厅、留食餐厅···我比较喜欢东区食堂，菜品好吃不贵，种类齐全！😁</p></div></details>]]></content>
      
      
      <categories>
          
          <category> 生活随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 浙江大学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用又拍云提供CDN加速服务</title>
      <link href="/2022/09/06/upyun/"/>
      <url>/2022/09/06/upyun/</url>
      
        <content type="html"><![CDATA[<h1 id="加入又拍云联盟"><a href="#加入又拍云联盟" class="headerlink" title="加入又拍云联盟"></a>加入又拍云联盟</h1><div class="note success flat"><p>加入<a href="https://www.upyun.com/league">又拍云联盟</a>，免费获取每月10GB存储空间+15GB流量！！！</p></div><p>注册步骤如下图所示：<br><img src="https://img.cwxhmk.top/post/%E5%8F%88%E6%8B%8D%E4%BA%91%E8%81%94%E7%9B%9F-%E6%AD%A5%E9%AA%A4.JPEG" alt="步骤"> </p><details class="toggle" ><summary class="toggle-button" style="">页脚添加又拍云徽标</summary><div class="toggle-content"><ol><li>blog根目录安装插件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-footer-beautify --save</span><br></pre></td></tr></table></figure></li><li>在主题配置文件<code>_config.butterfly.yml</code>中添加<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># footer_beautify</span></span><br><span class="line"><span class="comment"># 页脚计时器：[Native JS Timer](https://akilar.top/posts/b941af/)</span></span><br><span class="line"><span class="comment"># 页脚徽标：[Add Github Badge](https://akilar.top/posts/e87ad7f8/)</span></span><br><span class="line"><span class="attr">footer_beautify:</span></span><br><span class="line">  <span class="attr">enable:</span></span><br><span class="line">    <span class="attr">timer:</span> <span class="literal">false</span> <span class="comment"># 计时器开关</span></span><br><span class="line">    <span class="attr">bdage:</span> <span class="literal">true</span> <span class="comment"># 徽标开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span> <span class="comment"># 应用页面</span></span><br><span class="line">  <span class="attr">exclude:</span> <span class="comment">#屏蔽页面</span></span><br><span class="line">    <span class="comment"># - /posts/</span></span><br><span class="line">    <span class="comment"># - /about/</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># 挂载容器类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">footer-wrap</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="comment"># 计时器部分配置项</span></span><br><span class="line">  <span class="attr">runtime_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.js</span></span><br><span class="line">  <span class="attr">runtime_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css</span></span><br><span class="line">  <span class="comment"># 徽标部分配置项</span></span><br><span class="line">  <span class="attr">swiperpara:</span> <span class="number">3</span> <span class="comment">#若非0，则开启轮播功能，每行徽标个数</span></span><br><span class="line">  <span class="attr">bdageitem:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">link:</span> <span class="string">https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral</span></span><br><span class="line">      <span class="attr">shields:</span> <span class="string">https://img.shields.io/badge/CDN-%E5%8F%88%E6%8B%8D%E4%BA%91-00b6ff?style=flat&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAABs1JREFUSInllv2PVFcZxz/n3LfZmdmd3ZndZWGhhV0qYLaFEgzQpog12tZYbVRCSa00mLap6Q+aNERp5QcVlRhi0GjaGElromI08aU1tMRXWmspRaEVbIDtdimwy77M7uy83Xvn3nP84c7b7oD/QE8yyT13znO/z/f7nOcF3m9L1B4OnNYYEoSG165kGZkukLLjdEmXiew4yum7+4qK31u2rduLFXOgEEoQCrQs9RjepaW2f35Nu/9QqRh4Fi4jrkHCMmhTitlCBcOIoP768CoAzGt5owFLQBKfad/Yflau+Mo4qY0IE8qAUbXUgKT9ctFZVJAzqzcivLN+/JGY0H6HKD0riKGvw7gFWAFtUmMTyFPF5C+Gded2LBmBaB2BAigRyeMJ0jGPgxtiyX+MtW18/ZL1DLEMK/TER9eb+Z2GQGU1CK0b8gKy9uCYYJmQcUCgUm+U0qeGw/R2pIwAdbPvAiE0aAGux0MDc7eJAJ57V7+GZYAQjLDo8yd0z6lAqQ5bBbh+iF8JWxmP5XwSJrhCyz9NJU7mdHwwknOBWEKAAq0EuIrPrKp8d3lb+M/HT/qvlsN2pKNRSoDUXAxSN+eKlWMPD7jrFi3pZc4NeHUh4+zcNMW5q/z47dLhi4X4IHYt2hFDBBFDpUmYJXoNb+y23tzPHlgRfu2F8bZ9s4W2zdgSpap2OopbzsysPUHX85YIcdU1YnxLX5pT0+59w+X4NqwmpgIIgUCxNF4+vsaY2bsknjtq+yYTnsGhMx33H8127SFp03KTBBAT/H3U+qTIZe9ambFfagHOl0OOjJs/wjCZdwtCARI2d899Z0iP7Rkv2J0ngu49xUCvu1R2+sJS6g4MAyF11deasY5+CjBs3jE6f3KrMXlDC/Cfr0xuuegtWYIpmjwXUA7YcbP69tb2ypPfO5naPyJ7d4fKioLUDihdVxZEpI4ApGiEyoKLM8aydyx5J/CXeTE+m5PbkFZV4qpBoPlAJnh7R7rw5G8vm9+/4PfvDg0rSiMdgYraeQ0xGVZu78o9tSUx9ViK0pUGc0CbTNtdu1oYG7Geu+vFAaLbqz0+3B1sf2WKnhcvJ79MvCn21JiKiGIAt6amn9scK+4brpiskOHMKRU/jCSS2xG8ddVbVcOrM54KrBvqoERyO4YqLTaKb76ct7+JtufHfuEyYKIkeoKKpN12ySs1QF28qkJmrL8FuBwqv7HTEELC4b/Fks/EjPgcDq05TeO8EJrhSten35KLDjpmhfd8/QBNYY6clp0twC1LAmGQLJdyCF08gub/MtYCECZni+JBTyYwrKS7ML2UbrxplEwpHeoJHkk9IPO/z3QluKen/GC/MXuM8PrIQkc3+sY298hAwsIQbSvnAWuwpSq3AGesyhhh08EwZKBdHi+EDjEkyxLBm9dtNYjqXx5DTnHvsCeXFCoi1fh6VPEsEYy3ACf1zN9qlRE0whAcdzM/GCk5Hz+W1dv+U0jubFy+aqdpFsCD9en8r4ba9fDLU6mfI8wo7Zqc65Ccru3q6dQtC79EVb6AUc1lQzJakP2jOvUSZrqKUgu0QMvqNgBkyOpk7ndfXKruP+11Pf5uwdgqHYWqHwIIGTTLh88tBN7a3/3i+VF/ZtyzujAFut57a0d0A1sDpdzoUkfMdCTNs4Pm3MG1nfL1Fy7bjxwtxn6IXfOzauNDZ6w8u67Pf/7IQuDB3hSfCMtPHDoX/hTDaJKxXgzR1ca/PjnzxOL47IGgXOYG2+U9f/Gyw1Op31yYsz6LKcEEpZryyPe5d1B+dWnf4rrwdeATo+P0yfBQr53cOVHp2oIjWpo/LgwlZp/etdo78MeJ9DeO5cUmM+fflNcdy9E2ONGkoWvZIQSUFGt63ZNb+hPPzPr1S9KUTlYndizDl1Zan+qOlXNUqobVD2gPMubcyP4PlR57Ix979MhI+9fLRsfH8qJ7OYYNhkZo1dRfNATQ3ebmdq2073KFQTmgFfjG7jjprjgrMsncPb2FDXEKkwRV8BCEGbD7g2LNmdnYwLPn257Gro6kNMaixlQlwJckVXbyvszsBseJTU+VqA4JC4DdisavwNUy2Ia4sCk5OdRvzLxCBXAVj64NdvTGtbf337ETaBvMa3V9EQ2BFbgpkf/XnbHpIUuHF2YrYMqGgPNi3OxJIZQgjYmNidIdYwHfyjpZ3ZGtHN6fXXbOVfE0MebncHXMAUiL4uRHlpQP3pJW+04OC3KhST+tw8k152oJeEpQNGxWx0tP+WGeK0Xbcb3SWCYpTS80ul0lECi0EF6n8LNJOzjThvuHobj/603dTnFcORQDQcf1y937bP0Pc6b8FW3Czt0AAAAASUVORK5CYII=she</span></span><br><span class="line">      <span class="attr">message:</span> <span class="string">本网站由又拍云提供CDN加速/云存储服务</span></span><br><span class="line">  <span class="attr">swiper_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css</span></span><br><span class="line">  <span class="attr">swiper_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js</span></span><br><span class="line">  <span class="attr">swiperbdage_init_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-footer-beautify/lib/swiperbdage_init.min.js</span></span><br></pre></td></tr></table></figure></li><li>效果预览可见本博客页脚处</li></ol></div></details><div class="note success flat"><p>填写申请表后，等待审核（会有工作人员打电话询问网站的用途，如实回答即可），审核较快，成功加入后即可获得67元代金券。拿到代金券就可以开心地去创建CDN服务啦！😎</p></div><img src="https://img.cwxhmk.top/post/%E6%88%90%E5%8A%9F%E5%8A%A0%E5%85%A5%E8%81%94%E7%9B%9F.JPEG" width="80%" height="80%" /> <h1 id="创建CDN服务"><a href="#创建CDN服务" class="headerlink" title="创建CDN服务"></a>创建CDN服务</h1><p><img src="https://img.cwxhmk.top/post/%E5%88%9B%E5%BB%BACDN%E6%9C%8D%E5%8A%A1.PNG" alt="创建服务"></p><div class="note success flat"><p>创建服务后，点击配置，绑定域名。</p></div><h1 id="添加并解析域名"><a href="#添加并解析域名" class="headerlink" title="添加并解析域名"></a>添加并解析域名</h1><p><img src="https://img.cwxhmk.top/post/%E7%BB%91%E5%AE%9A%E5%9F%9F%E5%90%8D.PNG" alt="绑定域名"></p><div class="note warning flat"><p>以阿里云域名服务商为例，解析CNAME，复制的内容填入“记录值”。</p></div><img src="https://img.cwxhmk.top/post/CNAME%E8%A7%A3%E6%9E%90.PNG" width="80%" height="80%" /> <h1 id="申请SSL证书"><a href="#申请SSL证书" class="headerlink" title="申请SSL证书"></a>申请SSL证书</h1><div class="note success flat"><p>点击<a href="https://console.upyun.com/toolbox/ssl/">链接</a>申请免费的SSL证书，哪里免费点哪里~审核成功后，回到CDN控制台，点击HTTPS配置。</p></div><p><img src="https://img.cwxhmk.top/post/%E7%94%B3%E8%B4%AD%E8%AF%81%E4%B9%A6.PNG" alt="第一步"><br><img src="https://img.cwxhmk.top/post/%E7%94%B3%E8%B4%AD%E8%AF%81%E4%B9%A62.PNG" alt="第二步"></p><h1 id="配置HTTPS"><a href="#配置HTTPS" class="headerlink" title="配置HTTPS"></a>配置HTTPS</h1><div class="note warning flat"><p>不配置HTTPS的话，网站和存储在又拍云的图片都会无法访问。配置好后耐心等待一段时间，可以通过ping来测试是否已经成功创建CDN加速。</p></div><p><img src="https://img.cwxhmk.top/post/%E9%85%8D%E7%BD%AEHTTPS.PNG" alt="HTTPS"></p><h1 id="测试服务"><a href="#测试服务" class="headerlink" title="测试服务"></a>测试服务</h1><div class="note success flat"><p>未加速时，ping网站网址时指向github.io；加速后，指向又拍云的ip。出现像下图类似的结果，就说明成功啦~</p></div><p><img src="https://img.cwxhmk.top/post/ping.jpg" alt="测试"></p><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ul><li><a href="https://akilar.top/posts/e87ad7f8/">Add Github Badge</a></li><li><a href="https://zhuanlan.zhihu.com/p/139082007">我终于玩懂了又拍云CDN</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 又拍云 </tag>
            
            <tag> CDN加速 </tag>
            
            <tag> 网站 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HDDM的安装方法</title>
      <link href="/2022/09/05/install-hddm/"/>
      <url>/2022/09/05/install-hddm/</url>
      
        <content type="html"><![CDATA[<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>从<a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/">Python Extension Packages</a> 下载所需的Python包和相关依赖。</p><div class="note warning simple"><ol><li>注意Python版本和操作系统位宽（一般是64位）</li><li>安装顺序为numpy-pymc-kabuki-hddm，务必按该顺序安装。</li><li>kabuki包可通过<code>pip install git+git://github.com:hddm-devs/kabuki.git</code>安装，若失败请看<a href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">常见问题</a></li></ol></div><h1 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">conda create -n hddm python=<span class="number">3.8</span> <span class="comment"># 在anaconda中新建环境</span></span><br><span class="line">conda activate hddm <span class="comment"># 激活环境</span></span><br><span class="line">pip install --user ipykernel <span class="comment"># 安装ipykernel</span></span><br><span class="line">python -m ipykernel install --user --name=xxx <span class="comment"># 将环境加入jupyter</span></span><br><span class="line">pip install numpy-<span class="number">1.22</span><span class="number">.4</span>+mkl-cp38-cp38-win_amd64.whl <span class="comment">#安装HDDM依赖的3个Python包</span></span><br><span class="line">pip install pymc-<span class="number">2.3</span><span class="number">.8</span>-cp38-cp38-win_amd64.whl</span><br><span class="line">pip install kabuki-<span class="number">0.6</span><span class="number">.5</span>.tar.gz</span><br><span class="line">pip install HDDM-<span class="number">0.8</span><span class="number">.0</span>-cp38-cp38-win_amd64.whl</span><br></pre></td></tr></table></figure><div class="note warning simple"><p>Python包安装成功后，重新打开prompt(cmd)命令窗口</p></div><h1 id="测试安装是否成功"><a href="#测试安装是否成功" class="headerlink" title="测试安装是否成功"></a>测试安装是否成功</h1><div class="note success simple"><ol><li>若可以成功打印HDDM版本号，则安装成功</li><li>使用过程中，不要在hddm前导入matplotlib等包，即先<code>import hddm</code>,在<code>import</code>其他包</li></ol></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hddm</span><br><span class="line"><span class="built_in">print</span>(hddm.__version__)</span><br></pre></td></tr></table></figure><p><img src="https://img.cwxhmk.top/post/hddm_test.PNG" alt="测试HDDM"></p><h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><h2 id="pip-install-git-https-XXX-安装失败"><a href="#pip-install-git-https-XXX-安装失败" class="headerlink" title="pip install git+https:XXX 安装失败"></a>pip install git+https:XXX 安装失败</h2><ol><li>先通过github下载好原文件（这时候文件夹里往往有一个setup.py文件，但是有些时候并不能简单的<code>python setup.py</code>）</li><li>在下载的文件夹下执行 ：<code>python setup.py sdist</code></li><li>打开dist文件夹便可以看到一个打包好的需要安装的项目xxx.tar.gz</li><li><code>pip install xxx.tar.gz</code> ，到此安装完成</li></ol>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HDDM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo标签外挂</title>
      <link href="/2022/09/04/hexo-tag-plugin/"/>
      <url>/2022/09/04/hexo-tag-plugin/</url>
      
        <content type="html"><![CDATA[<h1 id="Note-Bootstrap-Callout"><a href="#Note-Bootstrap-Callout" class="headerlink" title="Note(Bootstrap Callout)"></a>Note(Bootstrap Callout)</h1><h2 id="用法1-语法"><a href="#用法1-语法" class="headerlink" title="用法1 语法"></a>用法1 语法</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">参数</th><th align="left">解释</th></tr></thead><tbody><tr><td align="center">class</td><td align="left">【可选】标识，不同的标识有不同的配色(default &#x2F; primary &#x2F; success &#x2F; info &#x2F; warning &#x2F; danger)</td></tr><tr><td align="center">no-icon</td><td align="left">【可选】不显示 icon</td></tr><tr><td align="center">style</td><td align="left">【可选】可以覆盖配置中的 style(simple&#x2F;modern&#x2F;flat&#x2F;disabled)</td></tr></tbody></table><div class="tabs" id="test0"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test0-1">simple</button></li><li class="tab"><button type="button" data-href="#test0-2">modern</button></li><li class="tab"><button type="button" data-href="#test0-3">flat</button></li><li class="tab"><button type="button" data-href="#test0-4">disabled</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test0-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;</span><br><span class="line">默认 提示块标志</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;</span><br><span class="line">default 提示块标志</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;</span><br><span class="line">primary 提示块标志</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;</span><br><span class="line">success 提示块标志</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;</span><br><span class="line">info 提示块标志</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;</span><br><span class="line">warning 提示块标志</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;</span><br><span class="line">danger 提示块标志</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note simple"><p>默认 提示块标签</p></div><div class="note default simple"><p>default 提示块标签</p></div><div class="note primary simple"><p>primary 提示块标签</p></div><div class="note success simple"><p>success 提示块标签</p></div><div class="note info simple"><p>info 提示块标签</p></div><div class="note warning simple"><p>warning 提示块标签</p></div><div class="note danger simple"><p>danger 提示块标签</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test0-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="note modern"><p>默认 提示块标签</p></div><div class="note default modern"><p>default 提示块标签</p></div><div class="note primary modern"><p>primary 提示块标签</p></div><div class="note success modern"><p>success 提示块标签</p></div><div class="note info modern"><p>info 提示块标签</p></div><div class="note warning modern"><p>warning 提示块标签</p></div><div class="note danger modern"><p>danger 提示块标签</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test0-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note flat"><p>默认 提示块标签</p></div><div class="note default flat"><p>default 提示块标签</p></div><div class="note primary flat"><p>primary 提示块标签</p></div><div class="note success flat"><p>success 提示块标签</p></div><div class="note info flat"><p>info 提示块标签</p></div><div class="note warning flat"><p>warning 提示块标签</p></div><div class="note danger flat"><p>danger 提示块标签</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test0-4"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;</span><br><span class="line">warning 提示块标籤</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default disabled"><p>default 提示块标签</p></div><div class="note primary disabled"><p>primary 提示块标签</p></div><div class="note success disabled"><p>success 提示块标签</p></div><div class="note info disabled"><p>info 提示块标签</p></div><div class="note warning disabled"><p>warning 提示块标签</p></div><div class="note danger disabled"><p>danger 提示块标签</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="用法2-语法"><a href="#用法2-语法" class="headerlink" title="用法2 语法"></a>用法2 语法</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [color] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">参数</th><th align="left">解释</th></tr></thead><tbody><tr><td align="center">color</td><td align="left">【可选】颜色(default &#x2F; blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green)</td></tr><tr><td align="center">icon</td><td align="left">【可选】可配置自定义 icon(只支持 fontawesome 图标, 也可以配置 no-icon )</td></tr><tr><td align="center">style</td><td align="left">【可选】可以覆盖配置中的 style(simple&#x2F;modern&#x2F;flat&#x2F;disabled)</td></tr></tbody></table><div class="tabs" id="test7"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test7-1">代码示例</button></li><li class="tab"><button type="button" data-href="#test7-2">预览</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test7-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;</span><br><span class="line">测试1</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue no-icon %&#125;</span><br><span class="line">测试2</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink no-icon %&#125;</span><br><span class="line">测试3</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red no-icon %&#125;</span><br><span class="line">测试4</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange no-icon %&#125;</span><br><span class="line">测试5</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple no-icon %&#125;</span><br><span class="line">测试6</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green no-icon %&#125;</span><br><span class="line">测试7</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test7-2"><div class="note no-icon flat"><p>测试1</p></div><div class="note blue no-icon flat"><p>测试2</p></div><div class="note pink no-icon flat"><p>测试3</p></div><div class="note red no-icon flat"><p>测试4</p></div><div class="note orange no-icon flat"><p>测试5</p></div><div class="note purple no-icon flat"><p>测试6</p></div><div class="note green no-icon flat"><p>测试7</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="tabs分栏"><a href="#tabs分栏" class="headerlink" title="tabs分栏"></a>tabs分栏</h1><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br><span class="line"></span><br><span class="line">Unique name   : Unique name of tabs block tag without comma.</span><br><span class="line"><span class="code">                Will be used in #id&#x27;s as prefix for each tab with their index numbers.</span></span><br><span class="line"><span class="code">                If there are whitespaces in name, for generate #id all whitespaces will replaced by dashes.</span></span><br><span class="line"><span class="code">                Only for current url of post/page must be unique!</span></span><br><span class="line"><span class="code">[index]       : Index number of active tab.</span></span><br><span class="line"><span class="code">                If not specified, first tab (1) will be selected.</span></span><br><span class="line"><span class="code">                If index is -1, no tab will be selected. It&#x27;s will be something like spoiler.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line"><span class="code">[Tab caption] : Caption of current tab.</span></span><br><span class="line"><span class="code">                If not caption specified, unique name with tab index suffix will be used as caption of tab.</span></span><br><span class="line"><span class="code">                If not caption specified, but specified icon, caption will empty.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line"><span class="code">[@icon]       : FontAwesome icon name (full-name, look like &#x27;fas fa-font&#x27;)</span></span><br><span class="line"><span class="code">                Can be specified with or without space; e.g. &#x27;Tab caption @icon&#x27; similar to &#x27;Tab caption@icon&#x27;.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br></pre></td></tr></table></figure><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1, 2 %&#125;</span><br><span class="line">&lt;!-- tab Tab1 --&gt;</span><br><span class="line"><span class="strong">**tab名**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fas fa-bell --&gt;</span><br><span class="line"><span class="strong">**仅tab图标**</span></span><br><span class="line"></span><br><span class="line">因为tabs标签头设置了默认展示栏位2，所以优先展示这一栏</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab Tab3@fas fa-snowflake --&gt;</span><br><span class="line"><span class="strong">**tab名+图标**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><h2 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h2><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test1-1">Tab1</button></li><li class="tab active"><button type="button" data-href="#test1-2"><i class="fas fa-bell" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test1-3"><i class="fas fa-book"></i>Tab3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test1-1"><p><strong>tab名</strong><br>啦啦啦~</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="test1-2"><p><strong>仅tab图标</strong></p><p>因为tabs标签头设置了默认展示栏位2，所以优先展示这一栏</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-3"><p><strong>tab名+图标</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="label"><a href="#label" class="headerlink" title="label"></a>label</h1><h2 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h2><table><thead><tr><th align="center">参数</th><th align="center">解释</th></tr></thead><tbody><tr><td align="center">text</td><td align="center">文字</td></tr><tr><td align="center">color</td><td align="center">【可选】背景颜色，默认为 <code>default</code> default&#x2F;blue&#x2F;pink&#x2F;red&#x2F;purple&#x2F;orange&#x2F;green</td></tr></tbody></table><h2 id="代码及预览"><a href="#代码及预览" class="headerlink" title="代码及预览"></a>代码及预览</h2><div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test2-1">代码示例</button></li><li class="tab"><button type="button" data-href="#test2-2">预览</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test2-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">舜发于&#123;% label 畎亩之中 %&#125;，傅说举于版筑之中，胶鬲举于鱼盐之中，管夷吾举于士，孙叔敖举于海，百里奚举于市。故天将降大任于是人也，必先&#123;% label 苦其心志 pink %&#125;，&#123;% label 劳其筋骨 green %&#125;，饿其体肤，空乏其身行拂乱其所为，所以&#123;% label 动心忍性 orange %&#125;，曾益其所不能。</span><br><span class="line">人恒过，然后能改；困于心，衡于虑，而后作；征于色，发于声，而后喻。入则无法家拂士，出则无敌国外患者，国恒亡。然后知&#123;% label 生于忧患 red %&#125;而&#123;% label 死于安乐 purple %&#125;也。</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p>舜发于<mark class="hl-label default">畎亩之中</mark> ，傅说举于版筑之中，胶鬲举于鱼盐之中，管夷吾举于士，孙叔敖举于海，百里奚举于市。故天将降大任于是人也，必先<mark class="hl-label pink">苦其心志</mark> ，<mark class="hl-label green">劳其筋骨</mark> ，饿其体肤，空乏其身行拂乱其所为，所以<mark class="hl-label orange">动心忍性</mark> ，曾益其所不能。人恒过，然后能改；困于心，衡于虑，而后作；征于色，发于声，而后喻。入则无法家拂士，出则无敌国外患者，国恒亡。然后知<mark class="hl-label red">生于忧患</mark> 而<mark class="hl-label purple">死于安乐</mark> 也。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="tag-hide"><a href="#tag-hide" class="headerlink" title="tag-hide"></a>tag-hide</h1><div class="tabs" id="test3"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test3-1">语法</button></li><li class="tab"><button type="button" data-href="#test3-2">inline</button></li><li class="tab"><button type="button" data-href="#test3-3">block</button></li><li class="tab"><button type="button" data-href="#test3-4">toggle代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test3-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideInline content,display,bg,color %&#125; # inline</span><br><span class="line">&#123;% hideBlock display,bg,color %&#125; # block</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br><span class="line">&#123;% hideToggle display,bg,color %&#125; # toggle</span><br><span class="line">content</span><br><span class="line">&#123;% endhideToggle %&#125;</span><br><span class="line"><span class="section"># content: 文本内容</span></span><br><span class="line"><span class="section"># display: 按钮显示的文字(可选)</span></span><br><span class="line"><span class="section"># bg: 按钮的背景颜色(可选)</span></span><br><span class="line"><span class="section"># color: 按钮文字的颜色(可选)</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1+1=?&#123;% hideInline 2,查看答案,#FF7242,#fff %&#125;</span><br><span class="line">谁最可爱？&#123;% hideInline 当然是你啦~&#125;</span><br></pre></td></tr></table></figure><p>1+1&#x3D;?<span class="hide-inline"><button type="button" class="hide-button" style="background-color: #FF7242;color: #fff">查看答案<br>  </button><span class="hide-content">2</span></span><br>谁最可爱？<span class="hide-inline"><button type="button" class="hide-button" style="">Click<br>  </button><span class="hide-content">当然是你啦~</span></span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">考考你，《七步诗》的作者是</span><br><span class="line">&#123;% hideBlock 查看答案 %&#125;</span><br><span class="line">曹植</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><p>考考你，《七步诗》的作者是</p><div class="hide-block"><button type="button" class="hide-button" style="">查看答案    </button><div class="hide-content"><p>曹植</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-4"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideToggle 和HMK在一起的幸福时刻 %&#125;</span><br><span class="line"><span class="bullet">1.</span> 牵手、拥抱、kiss~</span><br><span class="line"><span class="bullet">2.</span> 国庆假期突然出现在我家楼下，还骗我下楼取快递</span><br><span class="line"><span class="bullet">3.</span> 从身后拿出一朵玫瑰花送给我</span><br><span class="line"><span class="bullet">4.</span> 一起在西安城墙骑双人车</span><br><span class="line"><span class="bullet">5.</span> 一起吃李想大虾！！！</span><br><span class="line"><span class="bullet">6.</span> 带我回家</span><br><span class="line">&#123;% endhideToggle %&#125;</span><br></pre></td></tr></table></figure><details class="toggle" ><summary class="toggle-button" style="">和HMK在一起的幸福时刻</summary><div class="toggle-content"><ol><li>牵手、拥抱、kiss~</li><li>国庆假期突然出现在我家楼下，还骗我下楼取快递</li><li>从身后拿出一朵玫瑰花送给我</li><li>一起在西安城墙骑双人车</li><li>一起吃李想大虾！！！</li><li>带我回家</li></ol></div></details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="Gallery相册"><a href="#Gallery相册" class="headerlink" title="Gallery相册"></a>Gallery相册</h1><h2 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown 图片格式</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><h2 id="代码示例-1"><a href="#代码示例-1" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://img.cwxhmk.top/gallary/1.jpg</span>)</span><br><span class="line">![](<span class="link">https://img.cwxhmk.top/gallary/2.jpg</span>)</span><br><span class="line">![](<span class="link">https://img.cwxhmk.top/gallary/3.jpg</span>)</span><br><span class="line">![](<span class="link">https://img.cwxhmk.top/gallary/4.jpg</span>)</span><br><span class="line">![](<span class="link">https://img.cwxhmk.top/gallary/6.jpg</span>)</span><br><span class="line">![](<span class="link">https://img.cwxhmk.top/gallary/5.jpg</span>)</span><br><span class="line">![](<span class="link">https://img.cwxhmk.top/gallary/7.jpg</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><h2 id="预览-1"><a href="#预览-1" class="headerlink" title="预览"></a>预览</h2><div class="fj-gallery"><p><img src="https://img.cwxhmk.top/gallary/1.jpg"><br><img src="https://img.cwxhmk.top/gallary/2.jpg"><br><img src="https://img.cwxhmk.top/gallary/3.jpg"><br><img src="https://img.cwxhmk.top/gallary/4.jpg"><br><img src="https://img.cwxhmk.top/gallary/6.jpg"><br><img src="https://img.cwxhmk.top/gallary/5.jpg"><br><img src="https://img.cwxhmk.top/gallary/7.jpg"></p>          </div><h1 id="timeline"><a href="#timeline" class="headerlink" title="timeline"></a>timeline</h1><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">代码示例</button></li><li class="tab"><button type="button" data-href="#test4-2">预览</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2018,orange %&#125;</span><br><span class="line">&lt;!-- timeline 07-21 --&gt;</span><br><span class="line">我和康康在一起~</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><div class="timeline orange"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2018</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>07-21</p></div></div><div class='timeline-item-content'><p>我和康康在一起~</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="flink"><a href="#flink" class="headerlink" title="flink"></a>flink</h1><div class="tabs" id="test5"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test5-1">代码示例</button></li><li class="tab"><button type="button" data-href="#test5-2">预览</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test5-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% flink %&#125;</span><br><span class="line"><span class="bullet">-</span> class<span class="emphasis">_name: 友情链接</span></span><br><span class="line"><span class="emphasis">  class_</span>desc: 那些人，那些事</span><br><span class="line">  link<span class="emphasis">_list:</span></span><br><span class="line"><span class="emphasis">    - name: JerryC</span></span><br><span class="line"><span class="emphasis">      link: https://jerryc.me/</span></span><br><span class="line"><span class="emphasis">      avatar: https://jerryc.me/img/avatar.png</span></span><br><span class="line"><span class="emphasis">      descr: 今日事,今日毕</span></span><br><span class="line"><span class="emphasis">    - name: Hexo</span></span><br><span class="line"><span class="emphasis">      link: https://hexo.io/zh-tw/</span></span><br><span class="line"><span class="emphasis">      avatar: https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg</span></span><br><span class="line"><span class="emphasis">      descr: 快速、简单且强大的网誌框架</span></span><br><span class="line"><span class="emphasis">&#123;% endflink %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test5-2"><div class="flink"><div class="flink-name">友情链接</div><div class="flink-desc">那些人，那些事</div> <div class="flink-list">          <div class="flink-list-item">            <a href="https://jerryc.me/" title="JerryC" target="_blank">              <div class="flink-item-icon">                <img class="no-lightbox" src="https://jerryc.me/img/avatar.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="JerryC" />              </div>              <div class="flink-item-name">JerryC</div>               <div class="flink-item-desc" title="今日事,今日毕">今日事,今日毕</div>            </a>          </div>          <div class="flink-list-item">            <a href="https://hexo.io/zh-tw/" title="Hexo" target="_blank">              <div class="flink-item-icon">                <img class="no-lightbox" src="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Hexo" />              </div>              <div class="flink-item-name">Hexo</div>               <div class="flink-item-desc" title="快速、简单且强大的网页框架">快速、简单且强大的网页框架</div>            </a>          </div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="hexo-pdf"><a href="#hexo-pdf" class="headerlink" title="hexo-pdf"></a>hexo-pdf</h1><h2 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% pdf https://img.cwxhmk.top/pdf/mice<span class="emphasis">_brain_</span>atlas<span class="emphasis">_v4.pdf %&#125;</span></span><br></pre></td></tr></table></figure><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li>Butterfly官方文档：<a href="https://butterfly.js.org/posts/4aa8abbe/#Note-Bootstrap-Callout">Butterfly 安装文档(三) 主题配置-1 标签外挂</a></li><li>MaraPython：<a href="https://alowree.gitee.io/posts/1069065524/">Hexo Butterfly 的标签外挂（二）</a></li><li>Markdown公式使用文档：<a href="https://www.jianshu.com/p/383e8149136c">Markdown数学公式语法</a></li><li>页面插入pdf：<a href="https://github.com/superalsrk/hexo-pdf">hexo-pdf</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> 标签外挂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows常用快捷键汇总</title>
      <link href="/2022/09/04/keyboard-shortcuts/"/>
      <url>/2022/09/04/keyboard-shortcuts/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+S 保存</span><br><span class="line">Ctrl+C 复制</span><br><span class="line">Ctrl+V 粘贴</span><br><span class="line">Ctrl+F5 刷新缓存 # 代码上传到github后页面没有变化时，可以试着刷新浏览器缓存</span><br><span class="line">Win+: 表情符号 😊</span><br><span class="line">Win+Shift+S 截图</span><br><span class="line">Ctrl+Shift+N 新建文件夹</span><br><span class="line">Ctrl+Shift+Esc 打开任务管理器 </span><br><span class="line">Ctrl+Shift+S 在浏览器内捕获区域</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>无法获得下列许可SOLIDWORKS Standard</title>
      <link href="/2022/09/04/solidworks-register-problem/"/>
      <url>/2022/09/04/solidworks-register-problem/</url>
      
        <content type="html"><![CDATA[<p>前几天突然打不开solidworks，说无法获得许可，无法链接到服务器···（见下图）百度了一番终于找到了解决方案。</p><img src="https://img.cwxhmk.top/post/%E6%97%A0%E6%B3%95%E8%8E%B7%E5%BE%97%E8%AE%B8%E5%8F%AF.png" width="50%" height="50%" /> <div class="note success simple"><p>打开任务管理器，在服务里找到SolidWorks Flexnet Server，开启服务，如下图所示（注意：该方法并非一劳永逸，下次再遇到时，同样的操作即可）</p></div><p><img src="https://img.cwxhmk.top/post/%E5%BC%80%E5%90%AF%E6%9C%8D%E5%8A%A1.png" alt="开启服务"> </p><hr><p>每次打开solidworks都要去任务管理器中开启服务，太麻烦了，今天终于找到解决方法了！</p><div class="note success simple"><p>打开任务管理器，选择服务，任意选中一个服务然后右键，选择打开服务，找到SolidWorks Flexnet Server，右键属性，在常规中将启动类型改为自动，在恢复中将失败后设为重新启动服务，在此时间之后重置失败计数0天，在此时间之后重新启动服务0分钟。SolidWorks Licensing Service的启动类型也设为自动。</p></div><p>经测试，SolidWorks可以正常运行，而不需要手动开启服务了。</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://zhuanlan.zhihu.com/p/627484557">根除SolidWorks Flexnet Server自动变为手动，无法正常打开的问题</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SolidWorks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Anaconda中创建新环境</title>
      <link href="/2022/09/01/anaconda-new-env/"/>
      <url>/2022/09/01/anaconda-new-env/</url>
      
        <content type="html"><![CDATA[<h1 id="conda常用命令"><a href="#conda常用命令" class="headerlink" title="conda常用命令"></a>conda常用命令</h1><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda info --envs # 查看anaconda中所有环境</span><br><span class="line">conda list # 查看当前环境下有哪些包</span><br></pre></td></tr></table></figure><h1 id="添加新环境"><a href="#添加新环境" class="headerlink" title="添加新环境"></a>添加新环境</h1><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">conda create -n xxx # 创建新的环境，不指定python版本；xxx为环境名</span><br><span class="line">conda create -n xxx python=<span class="number">3</span>.<span class="number">8</span> # 可指定python版本</span><br><span class="line">conda activate xxx # 激活xxx环境</span><br><span class="line">conda deactivate # 退出xxx环境，返回base</span><br><span class="line">conda uninstall -n xxx --all # 删除环境</span><br><span class="line">conda install ipykernel # 添加进jupyter notebook环境 vscode中可以识别就可以</span><br></pre></td></tr></table></figure><h1 id="忽略warning信息"><a href="#忽略warning信息" class="headerlink" title="忽略warning信息"></a>忽略warning信息</h1><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import warnings</span><br><span class="line">warnings.filterwarnings(&quot;ignore&quot;)</span><br></pre></td></tr></table></figure><h1 id="将新环境添加进Jupyter-Notebook"><a href="#将新环境添加进Jupyter-Notebook" class="headerlink" title="将新环境添加进Jupyter Notebook"></a>将新环境添加进Jupyter Notebook</h1><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jupyter kernelspec list # 查看安装了哪些虚拟环境kernel</span><br><span class="line">pip install --user ipykernel # 安装ipykernel</span><br><span class="line">python -m ipykernel install --user --name=xxx # 将环境加入jupyter</span><br><span class="line">jupyter kernelspec uninstall xxx # 删除指定的kernel</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Anaconda </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solidworks 自动识别特征</title>
      <link href="/2022/08/30/solidworks-featureworks/"/>
      <url>/2022/08/30/solidworks-featureworks/</url>
      
        <content type="html"><![CDATA[<div class="note green icon-padding flat"><i class="note-icon fas fa-fan"></i><p>最近需要编辑一个.stp的文件，下意识的反应是应该和.stl文件差不多，属于不可编辑的那种文件格式。从师姐那里得知inventor可以编辑.stp文件，但平时已经习惯了用solidworks，不想再学新的建模软件了，这时碰巧在b站看到了solidworks可以自动识别.stp文件的特征！激动！😎</p></div><ol><li>导入.stp文件<br><img src="https://img.cwxhmk.top/post/%E8%AF%86%E5%88%AB%E5%89%8D.jpg" alt="essay"></li><li>断开链接（确认）<img src="https://img.cwxhmk.top/post/%E6%96%AD%E5%BC%80%E9%93%BE%E6%8E%A5.jpg" width="50%" height="50%" /></li></ol><!-- ![essay](/img/essay_img/断开链接.jpg) --><ol start="3"><li>插入-FeatureWorks-识别特征（点确认，点√）<img src="https://img.cwxhmk.top/post/%E8%AF%86%E5%88%AB%E7%89%B9%E5%BE%81.jpg" width="50%" height="50%" /><!-- ![essay](/img/essay_img/识别特征.jpg) --></li><li>耐心等待！<img src="https://img.cwxhmk.top/post/%E7%AD%89%E5%BE%85%E8%AF%86%E5%88%AB.jpg" width="50%" height="50%" /><!-- ![essay](/img/essay_img/等待识别.jpg) --></li><li>识别成功啦，愉快的开始编辑吧！👍<br><img src="https://img.cwxhmk.top/post/%E8%AF%86%E5%88%AB%E6%88%90%E5%8A%9F.jpg" alt="essay"></li></ol>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SolidWorks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jupyter Notebook中添加目录</title>
      <link href="/2022/08/21/jupyter-notebook-contents/"/>
      <url>/2022/08/21/jupyter-notebook-contents/</url>
      
        <content type="html"><![CDATA[<h1 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h1><ol><li><p>安装nbextensions</p><blockquote><p>若之前安装过nbextensions遇到问题，需要先执行<mark class="hl-label default">remove</mark> 语句</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># conda remove jupyter_nbextensions_configurator </span></span><br><span class="line">conda install -c conda-forge jupyter_nbextensions_configurator</span><br><span class="line">conda install -c conda-forge jupyter_contrib_nbextensions</span><br><span class="line">jupyter contrib nbextension install --user</span><br><span class="line">jupyter nbextensions_configurator enable --user</span><br></pre></td></tr></table></figure><p>上述过程均完成后，打开jupyter notebook就会发现界面多了Nbextensions选项卡<br><img src="https://img.cwxhmk.top/post/jupyter_extension.png" alt="Nbextensions"></p></li><li><p>勾选Table of Contents(2)复选框<br><img src="https://img.cwxhmk.top/post/toc2.png" alt="toc2"></p></li><li><p>新建或打开已有的ipynb文件，点击新增的目录按钮即可显示目录 😁<br><img src="https://img.cwxhmk.top/post/catalogue.png" alt="catalogue"></p></li></ol><h1 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h1><ol><li>jupyter notebook nbextension常用扩展模块不显示<br>按照安装步骤重新安装，先remove，再install</li><li>jupyter notebook报错：Bad file descriptor(C:\ci\zeromq_1602704446950\work\src\epoll.cpp:100)<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip uninstall pyzmq</span><br><span class="line">pip install pyzmq==<span class="number">19.0</span><span class="number">.2</span></span><br></pre></td></tr></table></figure></li><li>启动Jupyter，cmd窗口出现很多行类似于下述的代码<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Config option `template_path` <span class="keyword">not</span> recognized by `LenvsLatexExporter`</span><br></pre></td></tr></table></figure></li></ol><ul><li>原因是nbconvert6.0.0版本以上的某些参数的名称发生了更改，与原先版本不兼容，需要将版本降低到5.6.1<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install nbconvert==<span class="number">5.6</span><span class="number">.1</span> -i https://pypi.mirrors.ustc.edu.cn/simple</span><br></pre></td></tr></table></figure></li></ul><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ul><li><a href="https://blog.csdn.net/weixin_42521211/article/details/113784404">https://blog.csdn.net/weixin_42521211/article/details/113784404</a></li><li><a href="https://blog.csdn.net/sinat_24899403/article/details/89888505">https://blog.csdn.net/sinat_24899403/article/details/89888505</a></li><li><a href="https://blog.csdn.net/qq_42936703/article/details/125754530">https://blog.csdn.net/qq_42936703/article/details/125754530</a></li><li><a href="https://www.cnblogs.com/sunbr/p/14141452.html">https://www.cnblogs.com/sunbr/p/14141452.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Jupyter Notebook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo基本使用方法</title>
      <link href="/2022/08/20/basic-use-of-hexo/"/>
      <url>/2022/08/20/basic-use-of-hexo/</url>
      
        <content type="html"><![CDATA[<!-- password: aaamessage: 本文已加密，查看请输入密码 --><h1 id="发布文章常用指令"><a href="#发布文章常用指令" class="headerlink" title="发布文章常用指令"></a>发布文章常用指令</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hexo new &quot;xxx&quot; # 发布文章</span><br><span class="line">hexo g # 生成页面</span><br><span class="line">hexo d # 部署发布 </span><br><span class="line">hexo s  # 本地预览 http://localhost:4000/ </span><br><span class="line">hexo clean # 清除缓存 </span><br><span class="line">hexo new page xxx # 新增标签页</span><br></pre></td></tr></table></figure><h1 id="文章Front-matter常用配置"><a href="#文章Front-matter常用配置" class="headerlink" title="文章Front-matter常用配置"></a>文章Front-matter常用配置</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">title: xxx</span><br><span class="line">date: xxx (创建文档时默认生成)</span><br><span class="line">tags: </span><br><span class="line"><span class="bullet">    -</span> xxx (默认有多个)</span><br><span class="line">categories: </span><br><span class="line"><span class="bullet">    -</span> xxx (一级分类)</span><br><span class="line"><span class="bullet">    -</span> xxx (二级分类)</span><br><span class="line">description: xxx</span><br><span class="line">cover: http://img.cwxhmk.top/cover/hexo.png</span><br></pre></td></tr></table></figure><h1 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a>插入图片</h1><div class="note red icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p><code>.gif</code>图片也是支持的哦~</p></div><p>第一种：使用markdown语法 </p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">文字</span>](<span class="link">/img/图片名.jpg</span>) </span><br></pre></td></tr></table></figure><p>第二种：适用于图片较大的情况，可等比例缩小</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/img/图片名.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;图片说明&quot;</span> <span class="attr">width</span>=<span class="string">&quot;50%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;50%&quot;</span> /&gt;</span> </span><br></pre></td></tr></table></figure><h1 id="插入视频"><a href="#插入视频" class="headerlink" title="插入视频"></a>插入视频</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=&quot;视频链接&quot; scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot;  width=&quot;800px&quot; height=&quot;470px&quot;&gt; &lt;/iframe&gt;</span><br></pre></td></tr></table></figure><h1 id="插入公式"><a href="#插入公式" class="headerlink" title="插入公式"></a>插入公式</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入$a$ #行内公式</span><br><span class="line">$$aabb$$ #独立公式并居中</span><br><span class="line">$$a+b=c \tag&#123;1.1&#125;$$ #公式编号</span><br></pre></td></tr></table></figure><h2 id="效果展示"><a href="#效果展示" class="headerlink" title="效果展示"></a>效果展示</h2><p>输入$a$<br>$$aabb$$<br>$$a+b&#x3D;c \tag{1.1}$$</p><h1 id="文章链接"><a href="#文章链接" class="headerlink" title="文章链接"></a>文章链接</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% post<span class="emphasis">_link &#x27;basic-use-of-hexo&#x27; %&#125; #链接到本文/站内其他文章</span></span><br><span class="line"><span class="emphasis">&#123;% post_</span>link &#x27;tag-plugin&#x27; %&#125;</span><br><span class="line">[<span class="string">跳转到插入图片</span>](<span class="link">#插入图片</span>) #链接本文锚点</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% post_path &#x27;tag-plugin&#x27; %&#125;#label&quot;</span>&gt;</span></span>标签外挂<span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span> #链接站外文章锚点</span><br><span class="line">[<span class="string">又拍云</span>](<span class="link">https://www.upyun.com/</span>) #站外链接</span><br></pre></td></tr></table></figure><h1 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h1><a href="/2022/08/20/basic-use-of-hexo/" title="Hexo基本使用方法">Hexo基本使用方法</a><a href="#">Post not found: tag-plugin</a><p><a href="#%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87">跳转到插入图片</a><br><a href="#label">标签外挂-label</a><br><a href="https://www.upyun.com/">又拍云</a></p>]]></content>
      
      
      <categories>
          
          <category> 方法教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
